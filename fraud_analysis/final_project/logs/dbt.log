[0m01:46:56.942551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b289e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b26332c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b26332c20>]}


============================== 01:46:56.953196 | 9ccc9dc4-8a30-4c34-99f0-cacac4b3cceb ==============================
[0m01:46:56.953196 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:46:56.954726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'profiles_dir': '/home/aulia/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:46:56.956850 [info ] [MainThread]: dbt version: 1.6.6
[0m01:46:56.958092 [info ] [MainThread]: python version: 3.10.12
[0m01:46:56.959288 [info ] [MainThread]: python path: /mnt/e/Dataflow_example-main/cab_fare_venv/bin/python3
[0m01:46:56.960354 [info ] [MainThread]: os info: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m01:47:04.579584 [info ] [MainThread]: Using profiles dir at /home/aulia/.dbt
[0m01:47:04.581246 [info ] [MainThread]: Using profiles.yml file at /home/aulia/.dbt/profiles.yml
[0m01:47:04.582847 [info ] [MainThread]: Using dbt_project.yml file at /mnt/e/Dataflow_example-main/final_project/dbt_project.yml
[0m01:47:04.606206 [info ] [MainThread]: adapter type: bigquery
[0m01:47:04.607614 [info ] [MainThread]: adapter version: 1.6.7
[0m01:47:04.634196 [info ] [MainThread]: Configuration:
[0m01:47:04.635785 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:47:04.637215 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:47:04.638751 [info ] [MainThread]: Required dependencies:
[0m01:47:04.640147 [debug] [MainThread]: Executing "git --help"
[0m01:47:04.655093 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:47:04.656470 [debug] [MainThread]: STDERR: "b''"
[0m01:47:04.657542 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:47:04.658600 [info ] [MainThread]: Connection:
[0m01:47:04.660022 [info ] [MainThread]:   method: oauth
[0m01:47:04.661553 [info ] [MainThread]:   database: eternal-channel-400514
[0m01:47:04.662769 [info ] [MainThread]:   execution_project: eternal-channel-400514
[0m01:47:04.664161 [info ] [MainThread]:   schema: final_project
[0m01:47:04.665433 [info ] [MainThread]:   location: US
[0m01:47:04.667163 [info ] [MainThread]:   priority: interactive
[0m01:47:04.668507 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:47:04.670031 [info ] [MainThread]:   impersonate_service_account: None
[0m01:47:04.671528 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:47:04.673257 [info ] [MainThread]:   job_retries: 1
[0m01:47:04.674726 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:47:04.675898 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:47:04.677076 [info ] [MainThread]:   keyfile: None
[0m01:47:04.678224 [info ] [MainThread]:   timeout_seconds: 300
[0m01:47:04.679368 [info ] [MainThread]:   refresh_token: None
[0m01:47:04.680558 [info ] [MainThread]:   client_id: None
[0m01:47:04.681715 [info ] [MainThread]:   token_uri: None
[0m01:47:04.683081 [info ] [MainThread]:   dataproc_region: None
[0m01:47:04.684617 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:47:04.685780 [info ] [MainThread]:   gcs_bucket: None
[0m01:47:04.687224 [info ] [MainThread]:   dataproc_batch: None
[0m01:47:04.688701 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m01:47:04.690669 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:47:04.691846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:05.907603 [debug] [MainThread]: On debug: select 1 as id
[0m01:47:07.501157 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:76a81841-5520-4772-83f5-2852a4af97fd&page=queryresults
[0m01:47:08.475060 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:47:08.478182 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:47:08.481310 [debug] [MainThread]: Command `dbt debug` succeeded at 01:47:08.481021 after 11.55 seconds
[0m01:47:08.483419 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:47:08.485354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b289e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b0ee95de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b0ee89c90>]}
[0m01:47:08.486936 [debug] [MainThread]: Flushing usage events
[0m02:34:05.188042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af0b6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61aca06c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61aca06bf0>]}


============================== 02:34:05.196508 | 1d151605-5f55-4c5f-9dcd-5e824336132c ==============================
[0m02:34:05.196508 [info ] [MainThread]: Running with dbt=1.6.6
[0m02:34:05.197883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/aulia/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --config-dir', 'send_anonymous_usage_stats': 'True'}
[0m02:34:05.199859 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/aulia/.dbt
[0m02:34:05.203622 [debug] [MainThread]: Command `dbt debug` succeeded at 02:34:05.203397 after 0.03 seconds
[0m02:34:05.204708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61af0b6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61aca06c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61aca06d70>]}
[0m02:34:05.205917 [debug] [MainThread]: Flushing usage events
[0m03:02:42.651975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67403e2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673dd329b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673dd32860>]}


============================== 03:02:42.665099 | b602774a-1fd1-46f9-a446-79c80cf352be ==============================
[0m03:02:42.665099 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:02:42.667143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +add_columns', 'send_anonymous_usage_stats': 'True'}
[0m03:02:55.697148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b602774a-1fd1-46f9-a446-79c80cf352be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673dd32950>]}
[0m03:02:55.721957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b602774a-1fd1-46f9-a446-79c80cf352be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6726833490>]}
[0m03:02:55.739247 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:02:55.794515 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:02:55.809112 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:02:55.810934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b602774a-1fd1-46f9-a446-79c80cf352be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f672684a590>]}
[0m03:03:00.489569 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.final_project.add_columns' (models/stg/add_columns.sql) depends on a source named 'final_project.all_data' which was not found
[0m03:03:00.492469 [debug] [MainThread]: Command `dbt run` failed at 03:03:00.492043 after 17.86 seconds
[0m03:03:00.495710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67403e2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67265ff130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6726615690>]}
[0m03:03:00.497929 [debug] [MainThread]: Flushing usage events
[0m03:04:20.914687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5418debf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53f2269e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53f226980>]}


============================== 03:04:20.923433 | 0ba9b5f4-e615-4ad0-bee8-35b36b1c8582 ==============================
[0m03:04:20.923433 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:04:20.924936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +add_columns', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:04:29.809298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53f2269b0>]}
[0m03:04:29.831905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d0f4c0>]}
[0m03:04:29.844394 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:04:29.886593 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:04:29.901786 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:04:29.903796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d2a620>]}
[0m03:04:32.883851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52716feb0>]}
[0m03:04:32.941935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d2a5c0>]}
[0m03:04:32.943432 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:04:32.945324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d2ace0>]}
[0m03:04:32.949452 [info ] [MainThread]: 
[0m03:04:32.951764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:04:32.954515 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:04:32.956315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:35.955949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:04:35.958055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:36.987068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d2ae00>]}
[0m03:04:36.988790 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:04:36.990387 [info ] [MainThread]: 
[0m03:04:36.996677 [debug] [Thread-1 (]: Began running node model.final_project.add_columns
[0m03:04:36.998185 [info ] [Thread-1 (]: 1 of 1 START sql view model final_project.add_columns .......................... [RUN]
[0m03:04:37.000479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.add_columns)
[0m03:04:37.001959 [debug] [Thread-1 (]: Began compiling node model.final_project.add_columns
[0m03:04:37.012951 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.add_columns"
[0m03:04:37.036848 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (compile): 03:04:37.002939 => 03:04:37.036236
[0m03:04:37.038533 [debug] [Thread-1 (]: Began executing node model.final_project.add_columns
[0m03:04:37.072616 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.add_columns"
[0m03:04:37.093912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:37.095721 [debug] [Thread-1 (]: On model.final_project.add_columns: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.add_columns"} */


  create or replace view `eternal-channel-400514`.`final_project`.`add_columns`
  OPTIONS()
  as 

ALTER TABLE `eternal-channel-400514`.`final_project`.`all_data1`
ADD COLUMN isValid STRING,
ADD COLUMN newbalanceOrig_valid FLOAT64,
ADD COLUMN newbalanceDest_valid FLOAT64;;


[0m03:04:37.948579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:00f84328-20f4-4ac3-955f-23f321150ea0&page=queryresults
[0m03:04:37.959732 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword ALTER at [8:1]')
[0m03:04:38.751707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7824abbb-fa7d-4313-816b-2e27c2d32801&page=queryresults
[0m03:04:38.756237 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7824abbb-fa7d-4313-816b-2e27c2d32801&page=queryresults
[0m03:04:38.758879 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (execute): 03:04:37.039762 => 03:04:38.758321
[0m03:04:38.960886 [debug] [Thread-1 (]: Database Error in model add_columns (models/stg/add_columns.sql)
  Syntax error: Unexpected keyword ALTER at [8:1]
  compiled Code at target/run/final_project/models/stg/add_columns.sql
[0m03:04:38.962534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba9b5f4-e615-4ad0-bee8-35b36b1c8582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527068670>]}
[0m03:04:38.964207 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model final_project.add_columns ................. [[31mERROR[0m in 1.96s]
[0m03:04:38.965997 [debug] [Thread-1 (]: Finished running node model.final_project.add_columns
[0m03:04:38.969400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:38.971000 [debug] [MainThread]: Connection 'model.final_project.add_columns' was properly closed.
[0m03:04:38.972524 [info ] [MainThread]: 
[0m03:04:38.974164 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m03:04:38.976039 [debug] [MainThread]: Command end result
[0m03:04:39.007614 [info ] [MainThread]: 
[0m03:04:39.009705 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:04:39.011245 [info ] [MainThread]: 
[0m03:04:39.013125 [error] [MainThread]:   Database Error in model add_columns (models/stg/add_columns.sql)
  Syntax error: Unexpected keyword ALTER at [8:1]
  compiled Code at target/run/final_project/models/stg/add_columns.sql
[0m03:04:39.015893 [info ] [MainThread]: 
[0m03:04:39.017625 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:04:39.019403 [debug] [MainThread]: Command `dbt run` failed at 03:04:39.019213 after 18.12 seconds
[0m03:04:39.020764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5418debf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527d0f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527077f70>]}
[0m03:04:39.022106 [debug] [MainThread]: Flushing usage events
[0m03:09:26.297652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d905b6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8df06980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8df06920>]}


============================== 03:09:26.307897 | 9f141898-8572-4232-a7b9-04d096f2cf27 ==============================
[0m03:09:26.307897 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:09:26.309605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select +add_columns', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:09:37.003581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8df06950>]}
[0m03:09:37.025427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8faad390>]}
[0m03:09:37.035981 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:09:37.074746 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:09:39.469058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:09:39.470501 [debug] [MainThread]: Partial parsing: updated file: final_project://models/stg/add_columns.sql
[0m03:09:39.527789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75e51570>]}
[0m03:09:39.564747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d767998d0>]}
[0m03:09:39.566607 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:09:39.568582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d76799930>]}
[0m03:09:39.573985 [info ] [MainThread]: 
[0m03:09:39.576383 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:09:39.578421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:09:39.579574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:41.621644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:09:41.624152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:42.450220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d76783a30>]}
[0m03:09:42.452387 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:09:42.456022 [info ] [MainThread]: 
[0m03:09:42.461292 [debug] [Thread-1 (]: Began running node model.final_project.add_columns
[0m03:09:42.463274 [info ] [Thread-1 (]: 1 of 1 START sql view model final_project.add_columns .......................... [RUN]
[0m03:09:42.465726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.add_columns)
[0m03:09:42.467260 [debug] [Thread-1 (]: Began compiling node model.final_project.add_columns
[0m03:09:42.479137 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.add_columns"
[0m03:09:42.492149 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (compile): 03:09:42.468434 => 03:09:42.491307
[0m03:09:42.494166 [debug] [Thread-1 (]: Began executing node model.final_project.add_columns
[0m03:09:42.533547 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.add_columns"
[0m03:09:42.543787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:09:42.545235 [debug] [Thread-1 (]: On model.final_project.add_columns: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.add_columns"} */


  create or replace view `eternal-channel-400514`.`final_project`.`add_columns`
  OPTIONS()
  as 

SELECT
    *,
    '' as isValid, 
    0 as newbalanceOrig_valid, 
    0 as newbalanceDest_valid 
FROM `eternal-channel-400514`.`final_project`.`all_data1`;


[0m03:09:43.589423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:ffd9b323-03ae-46ed-9945-a84e1b35cc08&page=queryresults
[0m03:09:44.407089 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (execute): 03:09:42.495836 => 03:09:44.406742
[0m03:09:44.410470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f141898-8572-4232-a7b9-04d096f2cf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75ee7cd0>]}
[0m03:09:44.413505 [info ] [Thread-1 (]: 1 of 1 OK created sql view model final_project.add_columns ..................... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m03:09:44.426588 [debug] [Thread-1 (]: Finished running node model.final_project.add_columns
[0m03:09:44.431092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:44.433073 [debug] [MainThread]: Connection 'model.final_project.add_columns' was properly closed.
[0m03:09:44.434998 [info ] [MainThread]: 
[0m03:09:44.438412 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m03:09:44.441021 [debug] [MainThread]: Command end result
[0m03:09:44.503033 [info ] [MainThread]: 
[0m03:09:44.519357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:44.525747 [info ] [MainThread]: 
[0m03:09:44.528913 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:44.534724 [debug] [MainThread]: Command `dbt run` succeeded at 03:09:44.534332 after 18.25 seconds
[0m03:09:44.539885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d905b6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8faad390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d75e67460>]}
[0m03:09:44.541648 [debug] [MainThread]: Flushing usage events
[0m03:21:30.820550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b981eeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b95c2ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b95c2e9b0>]}


============================== 03:21:30.828672 | 51e0d769-1b37-487b-8da7-8fc3c5b82e9a ==============================
[0m03:21:30.828672 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:21:30.829935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +fill_isValid', 'send_anonymous_usage_stats': 'True'}
[0m03:21:39.767948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b95c2e9e0>]}
[0m03:21:39.782304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b977aa680>]}
[0m03:21:39.793370 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:21:39.828796 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:21:42.080549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:21:42.082652 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_isValid.sql
[0m03:21:42.085111 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m03:21:42.172657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7db20100>]}
[0m03:21:42.247537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7e4b9090>]}
[0m03:21:42.249482 [info ] [MainThread]: Found 5 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:21:42.251411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7dae1120>]}
[0m03:21:42.258761 [info ] [MainThread]: 
[0m03:21:42.263108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:21:42.266182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:21:42.268275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:44.762379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:21:44.764376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:21:45.638977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7e4b8130>]}
[0m03:21:45.640940 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:21:45.642333 [info ] [MainThread]: 
[0m03:21:45.647568 [debug] [Thread-1 (]: Began running node model.final_project.add_columns
[0m03:21:45.649516 [info ] [Thread-1 (]: 1 of 2 START sql view model final_project.add_columns .......................... [RUN]
[0m03:21:45.654033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.add_columns)
[0m03:21:45.655715 [debug] [Thread-1 (]: Began compiling node model.final_project.add_columns
[0m03:21:45.664800 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.add_columns"
[0m03:21:45.677655 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (compile): 03:21:45.656960 => 03:21:45.677112
[0m03:21:45.679258 [debug] [Thread-1 (]: Began executing node model.final_project.add_columns
[0m03:21:45.713255 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.add_columns"
[0m03:21:45.725850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:21:45.727537 [debug] [Thread-1 (]: On model.final_project.add_columns: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.add_columns"} */


  create or replace view `eternal-channel-400514`.`final_project`.`add_columns`
  OPTIONS()
  as 

SELECT
    *,
    '' as isValid, 
    0 as newbalanceOrig_valid, 
    0 as newbalanceDest_valid 
FROM `eternal-channel-400514`.`final_project`.`all_data1`;


[0m03:21:46.842869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:af723183-7141-4e33-b83f-d3c2d151c57a&page=queryresults
[0m03:21:47.870585 [debug] [Thread-1 (]: Timing info for model.final_project.add_columns (execute): 03:21:45.680494 => 03:21:47.870402
[0m03:21:47.872517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7e6b89d0>]}
[0m03:21:47.874380 [info ] [Thread-1 (]: 1 of 2 OK created sql view model final_project.add_columns ..................... [[32mCREATE VIEW (0 processed)[0m in 2.22s]
[0m03:21:47.875982 [debug] [Thread-1 (]: Finished running node model.final_project.add_columns
[0m03:21:47.878401 [debug] [Thread-3 (]: Began running node model.final_project.fill_isValid
[0m03:21:47.880027 [info ] [Thread-3 (]: 2 of 2 START sql table model final_project.fill_isValid ........................ [RUN]
[0m03:21:47.882086 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fill_isValid'
[0m03:21:47.883530 [debug] [Thread-3 (]: Began compiling node model.final_project.fill_isValid
[0m03:21:47.887976 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fill_isValid"
[0m03:21:47.896484 [debug] [Thread-3 (]: Timing info for model.final_project.fill_isValid (compile): 03:21:47.884793 => 03:21:47.896080
[0m03:21:47.897731 [debug] [Thread-3 (]: Began executing node model.final_project.fill_isValid
[0m03:21:47.928327 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fill_isValid"
[0m03:21:47.936444 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:21:47.938241 [debug] [Thread-3 (]: On model.final_project.fill_isValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_isValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_isValid`
      
    
    

    OPTIONS()
    as (
      

WITH fill_isValid AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

              WHEN type = 'CASH_IN' AND
              

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               ELSE 'False'

           END AS isValid
           
    FROM `eternal-channel-400514`.`final_project`.`add_columns`
)

SELECT *
FROM fill_isValid
    );
  
[0m03:21:49.281984 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:badcb1d1-c3c1-4378-a4bc-a86cea0c7ce3&page=queryresults
[0m03:21:50.102593 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name isValid at [15:1]')
[0m03:21:51.644863 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:936043eb-c307-495d-8ed2-8dac85daffab&page=queryresults
[0m03:21:52.459846 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:936043eb-c307-495d-8ed2-8dac85daffab&page=queryresults
[0m03:21:52.462981 [debug] [Thread-3 (]: Timing info for model.final_project.fill_isValid (execute): 03:21:47.898801 => 03:21:52.462389
[0m03:21:52.537938 [debug] [Thread-3 (]: Database Error in model fill_isValid (models/fill_isValid.sql)
  CREATE TABLE has columns with duplicate name isValid at [15:1]
  compiled Code at target/run/final_project/models/fill_isValid.sql
[0m03:21:52.539904 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e0d769-1b37-487b-8da7-8fc3c5b82e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7d9dfdc0>]}
[0m03:21:52.541997 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model final_project.fill_isValid ............... [[31mERROR[0m in 4.66s]
[0m03:21:52.546220 [debug] [Thread-3 (]: Finished running node model.final_project.fill_isValid
[0m03:21:52.551042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:52.552579 [debug] [MainThread]: Connection 'model.final_project.add_columns' was properly closed.
[0m03:21:52.554070 [debug] [MainThread]: Connection 'model.final_project.fill_isValid' was properly closed.
[0m03:21:52.555282 [info ] [MainThread]: 
[0m03:21:52.556979 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m03:21:52.559075 [debug] [MainThread]: Command end result
[0m03:21:52.588106 [info ] [MainThread]: 
[0m03:21:52.589946 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:21:52.591911 [info ] [MainThread]: 
[0m03:21:52.593472 [error] [MainThread]:   Database Error in model fill_isValid (models/fill_isValid.sql)
  CREATE TABLE has columns with duplicate name isValid at [15:1]
  compiled Code at target/run/final_project/models/fill_isValid.sql
[0m03:21:52.594832 [info ] [MainThread]: 
[0m03:21:52.596148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m03:21:52.597798 [debug] [MainThread]: Command `dbt run` failed at 03:21:52.597593 after 21.79 seconds
[0m03:21:52.598938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b981eeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b977aa680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7e468100>]}
[0m03:21:52.600106 [debug] [MainThread]: Flushing usage events
[0m03:35:49.429904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fb2f2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f8d3ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f8d3e9e0>]}


============================== 03:35:49.438793 | d1313883-b0a9-406a-99df-d2ad8eb622a1 ==============================
[0m03:35:49.438793 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:35:49.440007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:35:58.309142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f8d3ea10>]}
[0m03:35:58.323367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fa87e6b0>]}
[0m03:35:58.334529 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:35:58.362837 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:36:00.333900 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 2 files changed.
[0m03:36:00.335297 [debug] [MainThread]: Partial parsing: added file: final_project://models/source.yml
[0m03:36:00.336374 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/stg/add_columns.sql
[0m03:36:00.337250 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_isValid.sql
[0m03:36:00.338030 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m03:36:00.423551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e0c740d0>]}
[0m03:36:00.471795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e15558a0>]}
[0m03:36:00.473978 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:36:00.476349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e1555900>]}
[0m03:36:00.480431 [info ] [MainThread]: 
[0m03:36:00.482861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:36:00.485406 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:36:00.486777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:02.576242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:36:02.578291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:03.393877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e0b9faf0>]}
[0m03:36:03.396005 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:36:03.397943 [info ] [MainThread]: 
[0m03:36:03.403094 [debug] [Thread-1 (]: Began running node model.final_project.fill_isValid
[0m03:36:03.404219 [debug] [Thread-2 (]: Began running node model.final_project.fill_transactionValid
[0m03:36:03.407657 [debug] [Thread-3 (]: Began running node model.final_project.my_first_dbt_model
[0m03:36:03.409506 [info ] [Thread-1 (]: 1 of 4 START sql table model final_project.fill_isValid ........................ [RUN]
[0m03:36:03.411303 [info ] [Thread-2 (]: 2 of 4 START sql table model final_project.fill_transactionValid ............... [RUN]
[0m03:36:03.413041 [info ] [Thread-3 (]: 3 of 4 START sql table model final_project.my_first_dbt_model .................. [RUN]
[0m03:36:03.416746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_isValid)
[0m03:36:03.419278 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fill_transactionValid'
[0m03:36:03.421508 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.my_first_dbt_model'
[0m03:36:03.423306 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_isValid
[0m03:36:03.425482 [debug] [Thread-2 (]: Began compiling node model.final_project.fill_transactionValid
[0m03:36:03.427346 [debug] [Thread-3 (]: Began compiling node model.final_project.my_first_dbt_model
[0m03:36:03.437478 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_isValid"
[0m03:36:03.441406 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m03:36:03.445384 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.my_first_dbt_model"
[0m03:36:03.451909 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (compile): 03:36:03.428487 => 03:36:03.451197
[0m03:36:03.453858 [debug] [Thread-2 (]: Timing info for model.final_project.fill_transactionValid (compile): 03:36:03.438643 => 03:36:03.453198
[0m03:36:03.458510 [debug] [Thread-2 (]: Began executing node model.final_project.fill_transactionValid
[0m03:36:03.455969 [debug] [Thread-1 (]: Began executing node model.final_project.fill_isValid
[0m03:36:03.483643 [debug] [Thread-3 (]: Timing info for model.final_project.my_first_dbt_model (compile): 03:36:03.442617 => 03:36:03.482960
[0m03:36:03.522082 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m03:36:03.523946 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_isValid"
[0m03:36:03.524786 [debug] [Thread-3 (]: Began executing node model.final_project.my_first_dbt_model
[0m03:36:03.533962 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.my_first_dbt_model"
[0m03:36:03.541708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:03.543068 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:36:03.545919 [debug] [Thread-1 (]: On model.final_project.fill_isValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_isValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_isValid`
      
    
    

    OPTIONS()
    as (
      

WITH isValid_filled AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               ELSE 'False'

           END AS isValid
           
    FROM `eternal-channel-400514`.`final_project`.`all_data1`
)

SELECT *
FROM isValid_filled
    );
  
[0m03:36:03.548444 [debug] [Thread-2 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceOrg - amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceOrg + amount, 1)

               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceDest + amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceDest - amount, 1)
               
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data1`
)

SELECT *
FROM base_data
    );
  
[0m03:36:03.551892 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:36:03.558284 [debug] [Thread-3 (]: On model.final_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.my_first_dbt_model"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m03:36:04.812953 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:03b2c506-0962-43cd-aa55-6ed78ecfe1f0&page=queryresults
[0m03:36:04.920670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:49a1425a-eabc-46df-871e-364c78855d7f&page=queryresults
[0m03:36:04.929465 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:e6fe28ba-89a1-414e-95db-2961c51eed1b&page=queryresults
[0m03:36:05.712259 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: isValid at [18:78]')
[0m03:36:07.087746 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c7c92e45-9b89-4dda-8984-a08220ea8e5d&page=queryresults
[0m03:36:07.706522 [debug] [Thread-3 (]: Timing info for model.final_project.my_first_dbt_model (execute): 03:36:03.529467 => 03:36:07.706216
[0m03:36:07.708554 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e0b9faf0>]}
[0m03:36:07.710546 [info ] [Thread-3 (]: 3 of 4 OK created sql table model final_project.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.29s]
[0m03:36:07.712581 [debug] [Thread-3 (]: Finished running node model.final_project.my_first_dbt_model
[0m03:36:07.715117 [debug] [Thread-3 (]: Began running node model.final_project.my_second_dbt_model
[0m03:36:07.716909 [info ] [Thread-3 (]: 4 of 4 START sql view model final_project.my_second_dbt_model .................. [RUN]
[0m03:36:07.718877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.my_first_dbt_model, now model.final_project.my_second_dbt_model)
[0m03:36:07.720463 [debug] [Thread-3 (]: Began compiling node model.final_project.my_second_dbt_model
[0m03:36:07.725953 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.my_second_dbt_model"
[0m03:36:07.737804 [debug] [Thread-3 (]: Timing info for model.final_project.my_second_dbt_model (compile): 03:36:07.721644 => 03:36:07.737152
[0m03:36:07.739487 [debug] [Thread-3 (]: Began executing node model.final_project.my_second_dbt_model
[0m03:36:07.770192 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.my_second_dbt_model"
[0m03:36:07.789254 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:36:07.791539 [debug] [Thread-3 (]: On model.final_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.my_second_dbt_model"} */


  create or replace view `eternal-channel-400514`.`final_project`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `eternal-channel-400514`.`final_project`.`my_first_dbt_model`
where id = 1;


[0m03:36:07.888765 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c7c92e45-9b89-4dda-8984-a08220ea8e5d&page=queryresults
[0m03:36:07.893782 [debug] [Thread-2 (]: Timing info for model.final_project.fill_transactionValid (execute): 03:36:03.460336 => 03:36:07.891924
[0m03:36:07.990053 [debug] [Thread-2 (]: Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Unrecognized name: isValid at [18:78]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m03:36:07.992186 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e0c76740>]}
[0m03:36:07.995087 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model final_project.fill_transactionValid ...... [[31mERROR[0m in 4.57s]
[0m03:36:07.998080 [debug] [Thread-2 (]: Finished running node model.final_project.fill_transactionValid
[0m03:36:08.827800 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:50f4fa1b-9ed1-4cd2-bb88-c6fa1cfb9dcb&page=queryresults
[0m03:36:09.657691 [debug] [Thread-3 (]: Timing info for model.final_project.my_second_dbt_model (execute): 03:36:07.740918 => 03:36:09.657352
[0m03:36:09.659876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e0b89f00>]}
[0m03:36:09.661601 [info ] [Thread-3 (]: 4 of 4 OK created sql view model final_project.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m03:36:09.663806 [debug] [Thread-3 (]: Finished running node model.final_project.my_second_dbt_model
[0m03:36:12.352795 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (execute): 03:36:03.493526 => 03:36:12.352525
[0m03:36:12.355241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1313883-b0a9-406a-99df-d2ad8eb622a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e1543310>]}
[0m03:36:12.357226 [info ] [Thread-1 (]: 1 of 4 OK created sql table model final_project.fill_isValid ................... [[32mCREATE TABLE (6.4m rows, 597.0 MiB processed)[0m in 8.94s]
[0m03:36:12.358730 [debug] [Thread-1 (]: Finished running node model.final_project.fill_isValid
[0m03:36:12.362043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:12.363353 [debug] [MainThread]: Connection 'model.final_project.fill_isValid' was properly closed.
[0m03:36:12.365625 [debug] [MainThread]: Connection 'model.final_project.fill_transactionValid' was properly closed.
[0m03:36:12.367907 [debug] [MainThread]: Connection 'model.final_project.my_second_dbt_model' was properly closed.
[0m03:36:12.369316 [info ] [MainThread]: 
[0m03:36:12.370677 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 11.89 seconds (11.89s).
[0m03:36:12.372678 [debug] [MainThread]: Command end result
[0m03:36:12.419415 [info ] [MainThread]: 
[0m03:36:12.421001 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:36:12.422645 [info ] [MainThread]: 
[0m03:36:12.424396 [error] [MainThread]:   Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Unrecognized name: isValid at [18:78]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m03:36:12.425783 [info ] [MainThread]: 
[0m03:36:12.427181 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m03:36:12.429135 [debug] [MainThread]: Command `dbt run` failed at 03:36:12.428909 after 23.01 seconds
[0m03:36:12.430503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fb2f2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e01cb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64e01c8ee0>]}
[0m03:36:12.435208 [debug] [MainThread]: Flushing usage events
[0m03:37:26.760371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c5af2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c343aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c343aa40>]}


============================== 03:37:26.779695 | 5fc0aebe-17e7-4de5-bd4b-35f947aefcd7 ==============================
[0m03:37:26.779695 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:37:26.786190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select +fill_transactionValid', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:37:40.219956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c343aa70>]}
[0m03:37:40.246130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abf3f580>]}
[0m03:37:40.261858 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:37:40.312311 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:37:44.499004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:37:44.506063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:37:44.522617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abd500d0>]}
[0m03:37:44.619892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abd15420>]}
[0m03:37:44.626791 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:37:44.629887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abd15540>]}
[0m03:37:44.639192 [info ] [MainThread]: 
[0m03:37:44.645752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:37:44.651441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:37:44.654976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:47.255432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:37:47.257456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:48.056379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abd14820>]}
[0m03:37:48.058666 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:37:48.060150 [info ] [MainThread]: 
[0m03:37:48.064605 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m03:37:48.067003 [info ] [Thread-1 (]: 1 of 1 START sql table model final_project.fill_transactionValid ............... [RUN]
[0m03:37:48.069917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m03:37:48.071618 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m03:37:48.084895 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m03:37:48.094413 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 03:37:48.073113 => 03:37:48.093769
[0m03:37:48.096158 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m03:37:48.139804 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m03:37:48.147915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:37:48.149413 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceOrg - amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceOrg + amount, 1)

               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceDest + amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceDest - amount, 1)
               
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data1`
)

SELECT *
FROM base_data
    );
  
[0m03:37:49.210688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:97cbd06f-24ee-4040-bdf4-676f33070f4a&page=queryresults
[0m03:37:50.013845 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: isValid at [18:78]')
[0m03:37:50.799581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1d755b6f-3c97-4fb8-9560-4fcebb6ee1be&page=queryresults
[0m03:37:51.600678 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1d755b6f-3c97-4fb8-9560-4fcebb6ee1be&page=queryresults
[0m03:37:51.603090 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 03:37:48.097419 => 03:37:51.602629
[0m03:37:51.673714 [debug] [Thread-1 (]: Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Unrecognized name: isValid at [18:78]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m03:37:51.676591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc0aebe-17e7-4de5-bd4b-35f947aefcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abbe01f0>]}
[0m03:37:51.679020 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model final_project.fill_transactionValid ...... [[31mERROR[0m in 3.61s]
[0m03:37:51.683071 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m03:37:51.687291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:37:51.688577 [debug] [MainThread]: Connection 'model.final_project.fill_transactionValid' was properly closed.
[0m03:37:51.690286 [info ] [MainThread]: 
[0m03:37:51.692044 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m03:37:51.694468 [debug] [MainThread]: Command end result
[0m03:37:51.722681 [info ] [MainThread]: 
[0m03:37:51.727242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:37:51.730597 [info ] [MainThread]: 
[0m03:37:51.732174 [error] [MainThread]:   Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Unrecognized name: isValid at [18:78]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m03:37:51.735086 [info ] [MainThread]: 
[0m03:37:51.736728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:37:51.738814 [debug] [MainThread]: Command `dbt run` failed at 03:37:51.738529 after 25.03 seconds
[0m03:37:51.740150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c5af2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c747d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15abbe01c0>]}
[0m03:37:51.741550 [debug] [MainThread]: Flushing usage events
[0m03:38:47.981651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52137e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521112ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521112ea10>]}


============================== 03:38:47.993072 | dc995b27-3c90-4448-a4a0-9760e15e1556 ==============================
[0m03:38:47.993072 [info ] [MainThread]: Running with dbt=1.6.6
[0m03:38:47.995403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +fill_transactionValid', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:38:57.305469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521112ea40>]}
[0m03:38:57.337421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f9bef550>]}
[0m03:38:57.350680 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m03:38:57.403167 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m03:39:00.438310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:39:00.440150 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m03:39:00.563009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f9061120>]}
[0m03:39:00.639651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f99c5480>]}
[0m03:39:00.641729 [info ] [MainThread]: Found 4 models, 4 tests, 1 source, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m03:39:00.643322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f99c54e0>]}
[0m03:39:00.647542 [info ] [MainThread]: 
[0m03:39:00.654645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:39:00.666990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m03:39:00.670888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:03.088792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m03:39:03.090026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:39:03.996496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f99c4af0>]}
[0m03:39:03.998640 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m03:39:04.003385 [info ] [MainThread]: 
[0m03:39:04.026797 [debug] [Thread-1 (]: Began running node model.final_project.fill_isValid
[0m03:39:04.028250 [info ] [Thread-1 (]: 1 of 2 START sql table model final_project.fill_isValid ........................ [RUN]
[0m03:39:04.032130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_isValid)
[0m03:39:04.038017 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_isValid
[0m03:39:04.058852 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_isValid"
[0m03:39:04.075847 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (compile): 03:39:04.040247 => 03:39:04.075426
[0m03:39:04.077544 [debug] [Thread-1 (]: Began executing node model.final_project.fill_isValid
[0m03:39:04.111336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:39:05.458984 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_isValid"
[0m03:39:05.468029 [debug] [Thread-1 (]: On model.final_project.fill_isValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_isValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_isValid`
      
    
    

    OPTIONS()
    as (
      

WITH isValid_filled AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               ELSE 'False'

           END AS isValid
           
    FROM `eternal-channel-400514`.`final_project`.`all_data1`
)

SELECT *
FROM isValid_filled
    );
  
[0m03:39:06.381463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4ab39114-2d2f-4657-8396-96ac486a376f&page=queryresults
[0m03:39:14.244147 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (execute): 03:39:04.078920 => 03:39:14.243890
[0m03:39:14.246059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f99c4af0>]}
[0m03:39:14.247729 [info ] [Thread-1 (]: 1 of 2 OK created sql table model final_project.fill_isValid ................... [[32mCREATE TABLE (6.4m rows, 597.0 MiB processed)[0m in 10.21s]
[0m03:39:14.249634 [debug] [Thread-1 (]: Finished running node model.final_project.fill_isValid
[0m03:39:14.252186 [debug] [Thread-3 (]: Began running node model.final_project.fill_transactionValid
[0m03:39:14.253904 [info ] [Thread-3 (]: 2 of 2 START sql table model final_project.fill_transactionValid ............... [RUN]
[0m03:39:14.256196 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fill_transactionValid'
[0m03:39:14.257721 [debug] [Thread-3 (]: Began compiling node model.final_project.fill_transactionValid
[0m03:39:14.262284 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m03:39:14.270590 [debug] [Thread-3 (]: Timing info for model.final_project.fill_transactionValid (compile): 03:39:14.258790 => 03:39:14.270029
[0m03:39:14.272160 [debug] [Thread-3 (]: Began executing node model.final_project.fill_transactionValid
[0m03:39:14.280512 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m03:39:14.289260 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:39:14.290767 [debug] [Thread-3 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceOrg - amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceOrg + amount, 1)

               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceDest + amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceDest - amount, 1)
               
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`fill_isValid`
)

SELECT *
FROM base_data
    );
  
[0m03:39:15.330583 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:16d68020-7544-41a2-aaae-19160e635980&page=queryresults
[0m03:39:23.596818 [debug] [Thread-3 (]: Timing info for model.final_project.fill_transactionValid (execute): 03:39:14.273191 => 03:39:23.596341
[0m03:39:23.599970 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc995b27-3c90-4448-a4a0-9760e15e1556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f8f63550>]}
[0m03:39:23.602234 [info ] [Thread-3 (]: 2 of 2 OK created sql table model final_project.fill_transactionValid .......... [[32mCREATE TABLE (6.4m rows, 638.3 MiB processed)[0m in 9.34s]
[0m03:39:23.604275 [debug] [Thread-3 (]: Finished running node model.final_project.fill_transactionValid
[0m03:39:23.607682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:39:23.609187 [debug] [MainThread]: Connection 'model.final_project.fill_isValid' was properly closed.
[0m03:39:23.610441 [debug] [MainThread]: Connection 'model.final_project.fill_transactionValid' was properly closed.
[0m03:39:23.611869 [info ] [MainThread]: 
[0m03:39:23.613043 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 22.96 seconds (22.96s).
[0m03:39:23.615607 [debug] [MainThread]: Command end result
[0m03:39:23.643902 [info ] [MainThread]: 
[0m03:39:23.645551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:39:23.647131 [info ] [MainThread]: 
[0m03:39:23.648852 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:39:23.650783 [debug] [MainThread]: Command `dbt run` succeeded at 03:39:23.650537 after 35.69 seconds
[0m03:39:23.652561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52137e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f9bef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f8f60460>]}
[0m03:39:23.653928 [debug] [MainThread]: Flushing usage events
[0m20:51:29.333495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2ddb6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2b706a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2b7069b0>]}


============================== 20:51:29.362701 | bf523e4c-1da9-40fb-b060-4e1cbd7b008e ==============================
[0m20:51:29.362701 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:51:29.364640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:51:49.168973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf523e4c-1da9-40fb-b060-4e1cbd7b008e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2b7069e0>]}
[0m20:51:49.183189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf523e4c-1da9-40fb-b060-4e1cbd7b008e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c141eb490>]}
[0m20:51:49.210196 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:51:49.269461 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:51:52.711142 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 11 files added, 3 files changed.
[0m20:51:52.712434 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_fraud.sql
[0m20:51:52.713326 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_range_fraud_amount.sql
[0m20:51:52.714130 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_amount_refund_fraud.sql
[0m20:51:52.715035 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/trx_victim_before_fraud.sql
[0m20:51:52.715789 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_confirm_fraud.sql
[0m20:51:52.716543 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_refund_fraud.sql
[0m20:51:52.717266 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_received_nonfraud.sql
[0m20:51:52.717983 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_send_nonfraud.sql
[0m20:51:52.718689 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_received_fraud.sql
[0m20:51:52.719493 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/trx_victim_after_fraud.sql
[0m20:51:52.720238 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/suggest_merchant_acc.sql
[0m20:51:52.721035 [debug] [MainThread]: Partial parsing: updated file: final_project://models/schema.yml
[0m20:51:52.721907 [debug] [MainThread]: Partial parsing: updated file: final_project://models/source.yml
[0m20:51:52.722704 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/example/my_first_dbt_model.sql
[0m20:51:52.723418 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_isValid.sql
[0m20:51:52.865662 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.final_project.my_second_dbt_model' (models/example/my_second_dbt_model.sql) depends on a node named 'my_first_dbt_model' which was not found
[0m20:51:52.867985 [debug] [MainThread]: Command `dbt run` failed at 20:51:52.867789 after 23.59 seconds
[0m20:51:52.869474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2ddb6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c138a1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c138a1c90>]}
[0m20:51:52.871106 [debug] [MainThread]: Flushing usage events
[0m20:52:59.772695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa343cdebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34162aaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34162aa40>]}


============================== 20:52:59.788161 | 1eee3877-de9b-401d-a5d3-8fc45057083a ==============================
[0m20:52:59.788161 [info ] [MainThread]: Running with dbt=1.6.6
[0m20:52:59.789804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:53:08.978273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34162aa70>]}
[0m20:53:08.996717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32a0af520>]}
[0m20:53:09.009836 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m20:53:09.047213 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m20:53:11.719231 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 11 files added, 3 files changed.
[0m20:53:11.721086 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_received_nonfraud.sql
[0m20:53:11.722351 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_amount_refund_fraud.sql
[0m20:53:11.723509 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_received_fraud.sql
[0m20:53:11.724954 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/trx_victim_before_fraud.sql
[0m20:53:11.726036 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_confirm_fraud.sql
[0m20:53:11.727004 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_fraud.sql
[0m20:53:11.727908 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_refund_fraud.sql
[0m20:53:11.728795 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/suggest_merchant_acc.sql
[0m20:53:11.729665 [debug] [MainThread]: Partial parsing: added file: final_project://models/monthly_range_fraud_amount.sql
[0m20:53:11.730906 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/perpet_send_nonfraud.sql
[0m20:53:11.731844 [debug] [MainThread]: Partial parsing: added file: final_project://models/optional/trx_victim_after_fraud.sql
[0m20:53:11.732959 [debug] [MainThread]: Partial parsing: updated file: final_project://models/schema.yml
[0m20:53:11.734197 [debug] [MainThread]: Partial parsing: updated file: final_project://models/source.yml
[0m20:53:11.735216 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/example/my_first_dbt_model.sql
[0m20:53:11.736285 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/example/my_second_dbt_model.sql
[0m20:53:11.737360 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_isValid.sql
[0m20:53:11.839217 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/schema.yml'
[0m20:53:11.881921 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.final_project.unique_my_second_dbt_model_id.57a0f8c493' (models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:53:11.884290 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.final_project.not_null_my_second_dbt_model_id.151b76d778' (models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m20:53:11.900858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m20:53:11.909052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32979beb0>]}
[0m20:53:11.969716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329e71cf0>]}
[0m20:53:11.971722 [info ] [MainThread]: Found 13 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m20:53:11.975078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329e71de0>]}
[0m20:53:11.981629 [info ] [MainThread]: 
[0m20:53:11.984370 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:53:11.988618 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m20:53:11.990341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:14.888071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m20:53:14.891139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:15.823176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329e70a90>]}
[0m20:53:15.825620 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:53:15.828332 [info ] [MainThread]: 
[0m20:53:15.836650 [debug] [Thread-1 (]: Began running node model.final_project.fill_isValid
[0m20:53:15.837418 [debug] [Thread-2 (]: Began running node model.final_project.monthly_amount_refund_fraud
[0m20:53:15.838042 [debug] [Thread-3 (]: Began running node model.final_project.monthly_confirm_fraud
[0m20:53:15.839367 [info ] [Thread-1 (]: 1 of 13 START sql table model final_project.fill_isValid ....................... [RUN]
[0m20:53:15.841034 [info ] [Thread-2 (]: 2 of 13 START sql table model final_project.monthly_amount_refund_fraud ........ [RUN]
[0m20:53:15.842710 [info ] [Thread-3 (]: 3 of 13 START sql table model final_project.monthly_confirm_fraud .............. [RUN]
[0m20:53:15.845019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_isValid)
[0m20:53:15.847489 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.monthly_amount_refund_fraud'
[0m20:53:15.850021 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.monthly_confirm_fraud'
[0m20:53:15.851521 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_isValid
[0m20:53:15.853161 [debug] [Thread-2 (]: Began compiling node model.final_project.monthly_amount_refund_fraud
[0m20:53:15.854535 [debug] [Thread-3 (]: Began compiling node model.final_project.monthly_confirm_fraud
[0m20:53:15.864148 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_isValid"
[0m20:53:15.873079 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.monthly_amount_refund_fraud"
[0m20:53:15.876591 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.monthly_confirm_fraud"
[0m20:53:15.885259 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_amount_refund_fraud (compile): 20:53:15.866048 => 20:53:15.884494
[0m20:53:15.888970 [debug] [Thread-2 (]: Began executing node model.final_project.monthly_amount_refund_fraud
[0m20:53:15.890075 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_confirm_fraud (compile): 20:53:15.874097 => 20:53:15.889649
[0m20:53:15.890778 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (compile): 20:53:15.855929 => 20:53:15.890477
[0m20:53:15.914042 [debug] [Thread-3 (]: Began executing node model.final_project.monthly_confirm_fraud
[0m20:53:15.926405 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.monthly_amount_refund_fraud"
[0m20:53:15.927842 [debug] [Thread-1 (]: Began executing node model.final_project.fill_isValid
[0m20:53:15.932710 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.monthly_confirm_fraud"
[0m20:53:15.939134 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_isValid"
[0m20:53:15.945606 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:53:15.948126 [debug] [Thread-2 (]: On model.final_project.monthly_amount_refund_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_amount_refund_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_amount_refund_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, refund, newBalanceOriginSet
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND refund=1
    );
  
[0m20:53:15.949338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:15.950700 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:53:15.955454 [debug] [Thread-1 (]: On model.final_project.fill_isValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_isValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_isValid`
      
    
    

    OPTIONS()
    as (
      

WITH isValid_filled AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               ELSE 'False'

           END AS isValid
           
    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM isValid_filled
    );
  
[0m20:53:15.957890 [debug] [Thread-3 (]: On model.final_project.monthly_confirm_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_confirm_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_confirm_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, confirm
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND confirm=1
    );
  
[0m20:53:17.180276 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:131c0339-2174-4560-bbee-65518c336964&page=queryresults
[0m20:53:17.243003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:749695c9-d8b3-4197-94ba-7412f4ba6fd0&page=queryresults
[0m20:53:17.290532 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:64bfb4d3-6467-4947-9817-42d36d4ecbb6&page=queryresults
[0m20:53:19.924950 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_confirm_fraud (execute): 20:53:15.929120 => 20:53:19.924742
[0m20:53:19.926878 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3296f8b80>]}
[0m20:53:19.928460 [info ] [Thread-3 (]: 3 of 13 OK created sql table model final_project.monthly_confirm_fraud ......... [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 4.08s]
[0m20:53:19.930282 [debug] [Thread-3 (]: Finished running node model.final_project.monthly_confirm_fraud
[0m20:53:19.932437 [debug] [Thread-3 (]: Began running node model.final_project.monthly_fraud
[0m20:53:19.934182 [info ] [Thread-3 (]: 4 of 13 START sql table model final_project.monthly_fraud ...................... [RUN]
[0m20:53:19.936397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_confirm_fraud, now model.final_project.monthly_fraud)
[0m20:53:19.938006 [debug] [Thread-3 (]: Began compiling node model.final_project.monthly_fraud
[0m20:53:19.944000 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.monthly_fraud"
[0m20:53:19.953817 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_fraud (compile): 20:53:19.939135 => 20:53:19.953305
[0m20:53:19.955438 [debug] [Thread-3 (]: Began executing node model.final_project.monthly_fraud
[0m20:53:19.962668 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.monthly_fraud"
[0m20:53:19.973211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:53:19.975140 [debug] [Thread-3 (]: On model.final_project.monthly_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND istrueFraud=1
    );
  
[0m20:53:20.097380 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_amount_refund_fraud (execute): 20:53:15.891990 => 20:53:20.097172
[0m20:53:20.099367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3296f8430>]}
[0m20:53:20.101360 [info ] [Thread-2 (]: 2 of 13 OK created sql table model final_project.monthly_amount_refund_fraud ... [[32mCREATE TABLE (8.2k rows, 417.1 KiB processed)[0m in 4.25s]
[0m20:53:20.103496 [debug] [Thread-2 (]: Finished running node model.final_project.monthly_amount_refund_fraud
[0m20:53:20.105624 [debug] [Thread-2 (]: Began running node model.final_project.monthly_range_fraud_amount
[0m20:53:20.107582 [info ] [Thread-2 (]: 5 of 13 START sql table model final_project.monthly_range_fraud_amount ......... [RUN]
[0m20:53:20.109746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_amount_refund_fraud, now model.final_project.monthly_range_fraud_amount)
[0m20:53:20.111257 [debug] [Thread-2 (]: Began compiling node model.final_project.monthly_range_fraud_amount
[0m20:53:20.117643 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.monthly_range_fraud_amount"
[0m20:53:20.128830 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_range_fraud_amount (compile): 20:53:20.112375 => 20:53:20.128408
[0m20:53:20.131845 [debug] [Thread-2 (]: Began executing node model.final_project.monthly_range_fraud_amount
[0m20:53:20.138833 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.monthly_range_fraud_amount"
[0m20:53:20.149302 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:20.151676 [debug] [Thread-2 (]: On model.final_project.monthly_range_fraud_amount: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_range_fraud_amount"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_range_fraud_amount`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND istrueFraud=1
    );
  
[0m20:53:20.967726 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:da26d772-c2eb-436a-b31a-07e4560f8710&page=queryresults
[0m20:53:21.285342 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:98f26f57-dbff-4fb3-81ee-c36be83c4057&page=queryresults
[0m20:53:23.396059 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_fraud (execute): 20:53:19.956733 => 20:53:23.395864
[0m20:53:23.398393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329654b80>]}
[0m20:53:23.401183 [info ] [Thread-3 (]: 4 of 13 OK created sql table model final_project.monthly_fraud ................. [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 3.46s]
[0m20:53:23.403384 [debug] [Thread-3 (]: Finished running node model.final_project.monthly_fraud
[0m20:53:23.405319 [debug] [Thread-3 (]: Began running node model.final_project.monthly_refund_fraud
[0m20:53:23.407575 [info ] [Thread-3 (]: 6 of 13 START sql table model final_project.monthly_refund_fraud ............... [RUN]
[0m20:53:23.410165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_fraud, now model.final_project.monthly_refund_fraud)
[0m20:53:23.412292 [debug] [Thread-3 (]: Began compiling node model.final_project.monthly_refund_fraud
[0m20:53:23.418782 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.monthly_refund_fraud"
[0m20:53:23.431684 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_refund_fraud (compile): 20:53:23.413787 => 20:53:23.429954
[0m20:53:23.435387 [debug] [Thread-3 (]: Began executing node model.final_project.monthly_refund_fraud
[0m20:53:23.441890 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.monthly_refund_fraud"
[0m20:53:23.462186 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:53:23.464305 [debug] [Thread-3 (]: On model.final_project.monthly_refund_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_refund_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_refund_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, refund
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND refund=1
    );
  
[0m20:53:23.914278 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_range_fraud_amount (execute): 20:53:20.133797 => 20:53:23.913846
[0m20:53:23.917631 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329694040>]}
[0m20:53:23.920310 [info ] [Thread-2 (]: 5 of 13 OK created sql table model final_project.monthly_range_fraud_amount .... [[32mCREATE TABLE (8.2k rows, 481.2 KiB processed)[0m in 3.81s]
[0m20:53:23.922936 [debug] [Thread-2 (]: Finished running node model.final_project.monthly_range_fraud_amount
[0m20:53:24.315366 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (execute): 20:53:15.935611 => 20:53:24.315048
[0m20:53:24.317759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa329e71420>]}
[0m20:53:24.320546 [info ] [Thread-1 (]: 1 of 13 OK created sql table model final_project.fill_isValid .................. [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 8.47s]
[0m20:53:24.323515 [debug] [Thread-1 (]: Finished running node model.final_project.fill_isValid
[0m20:53:24.326518 [debug] [Thread-2 (]: Began running node model.final_project.fill_transactionValid
[0m20:53:24.328553 [info ] [Thread-2 (]: 7 of 13 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m20:53:24.330588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_range_fraud_amount, now model.final_project.fill_transactionValid)
[0m20:53:24.332726 [debug] [Thread-2 (]: Began compiling node model.final_project.fill_transactionValid
[0m20:53:24.337902 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m20:53:24.352029 [debug] [Thread-2 (]: Timing info for model.final_project.fill_transactionValid (compile): 20:53:24.334303 => 20:53:24.351625
[0m20:53:24.353506 [debug] [Thread-2 (]: Began executing node model.final_project.fill_transactionValid
[0m20:53:24.361084 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m20:53:24.372103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:24.373964 [debug] [Thread-2 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceOrg - amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceOrg + amount, 1)

               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceDest + amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceDest - amount, 1)
               
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`fill_isValid`
)

SELECT *
FROM base_data
    );
  
[0m20:53:24.517881 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:0b9eadfa-f8ec-4389-8a33-e2b16b6637ba&page=queryresults
[0m20:53:25.369331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:877ba980-3798-4368-bd4b-381d52da1c99&page=queryresults
[0m20:53:27.137386 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_refund_fraud (execute): 20:53:23.436776 => 20:53:27.136860
[0m20:53:27.141219 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32858e020>]}
[0m20:53:27.144027 [info ] [Thread-3 (]: 6 of 13 OK created sql table model final_project.monthly_refund_fraud .......... [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 3.73s]
[0m20:53:27.146404 [debug] [Thread-3 (]: Finished running node model.final_project.monthly_refund_fraud
[0m20:53:33.173929 [debug] [Thread-2 (]: Timing info for model.final_project.fill_transactionValid (execute): 20:53:24.354747 => 20:53:33.173427
[0m20:53:33.177794 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32858cb80>]}
[0m20:53:33.180890 [info ] [Thread-2 (]: 7 of 13 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 856.7 MiB processed)[0m in 8.85s]
[0m20:53:33.183031 [debug] [Thread-2 (]: Finished running node model.final_project.fill_transactionValid
[0m20:53:33.186592 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_fraud
[0m20:53:33.187345 [debug] [Thread-3 (]: Began running node model.final_project.perpet_received_nonfraud
[0m20:53:33.187909 [debug] [Thread-2 (]: Began running node model.final_project.perpet_send_nonfraud
[0m20:53:33.189185 [info ] [Thread-1 (]: 8 of 13 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m20:53:33.191203 [info ] [Thread-3 (]: 9 of 13 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m20:53:33.193316 [info ] [Thread-2 (]: 10 of 13 START sql table model final_project.perpet_send_nonfraud .............. [RUN]
[0m20:53:33.195702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_isValid, now model.final_project.perpet_received_fraud)
[0m20:53:33.197977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_refund_fraud, now model.final_project.perpet_received_nonfraud)
[0m20:53:33.200864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_send_nonfraud)
[0m20:53:33.202698 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_fraud
[0m20:53:33.204416 [debug] [Thread-3 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m20:53:33.206092 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m20:53:33.212269 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m20:53:33.217321 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m20:53:33.222610 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m20:53:33.234880 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 20:53:33.213678 => 20:53:33.234174
[0m20:53:33.236820 [debug] [Thread-3 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m20:53:33.239267 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 20:53:33.218630 => 20:53:33.238895
[0m20:53:33.238330 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (compile): 20:53:33.207382 => 20:53:33.237680
[0m20:53:33.245700 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m20:53:33.247261 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m20:53:33.248681 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_fraud
[0m20:53:33.254855 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m20:53:33.260323 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m20:53:33.268584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:53:33.270789 [debug] [Thread-3 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
NonFraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 0
)

SELECT 
    nft.nameDest,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    NonFraudulentTransactions nft
WHERE 
    nft.nameDest IN (SELECT nameDest FROM FraudulentTransactions)
GROUP BY 
    nft.nameDest
    );
  
[0m20:53:33.271929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:33.277759 [debug] [Thread-1 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m20:53:33.279870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:33.284577 [debug] [Thread-2 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0;
    );
  
[0m20:53:34.282529 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:88207c91-cf67-4539-887a-71f5d88e2709&page=queryresults
[0m20:53:34.287448 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [31:18]')
[0m20:53:34.431214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f34e9714-602d-45e8-b043-79de1696b610&page=queryresults
[0m20:53:34.447288 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:3ebdcb90-ae10-47cb-aa13-286beba61953&page=queryresults
[0m20:53:35.272134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7dd73855-d1c0-4d26-b4e8-985844f9f069&page=queryresults
[0m20:53:35.275538 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7dd73855-d1c0-4d26-b4e8-985844f9f069&page=queryresults
[0m20:53:35.278323 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 20:53:33.251265 => 20:53:35.277776
[0m20:53:35.536443 [debug] [Thread-2 (]: Database Error in model perpet_send_nonfraud (models/optional/perpet_send_nonfraud.sql)
  Syntax error: Expected ")" but got ";" at [31:18]
  compiled Code at target/run/final_project/models/optional/perpet_send_nonfraud.sql
[0m20:53:35.538438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa328531060>]}
[0m20:53:35.540270 [error] [Thread-2 (]: 10 of 13 ERROR creating sql table model final_project.perpet_send_nonfraud ..... [[31mERROR[0m in 2.34s]
[0m20:53:35.542284 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m20:53:35.544337 [debug] [Thread-2 (]: Began running node model.final_project.suggest_merchant_acc
[0m20:53:35.546321 [info ] [Thread-2 (]: 11 of 13 START sql table model final_project.suggest_merchant_acc .............. [RUN]
[0m20:53:35.548401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.suggest_merchant_acc)
[0m20:53:35.550463 [debug] [Thread-2 (]: Began compiling node model.final_project.suggest_merchant_acc
[0m20:53:35.555089 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.suggest_merchant_acc"
[0m20:53:35.570015 [debug] [Thread-2 (]: Timing info for model.final_project.suggest_merchant_acc (compile): 20:53:35.552031 => 20:53:35.569597
[0m20:53:35.571625 [debug] [Thread-2 (]: Began executing node model.final_project.suggest_merchant_acc
[0m20:53:35.576483 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.suggest_merchant_acc"
[0m20:53:35.590853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:35.592524 [debug] [Thread-2 (]: On model.final_project.suggest_merchant_acc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.suggest_merchant_acc"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`suggest_merchant_acc`
      
    
    

    OPTIONS()
    as (
      

SELECT nameDest, payment_id, payment_datetime, count (*) AS trx
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
WHERE isFraud=0 
GROUP BY nameDest
ORDER BY trx DESC 
LIMIT 100
    );
  
[0m20:53:36.691863 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:979da1f0-dd5f-4b6b-b0fc-9cf86aec4aba&page=queryresults
[0m20:53:37.513713 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column payment_id which is neither grouped nor aggregated at [15:18]')
[0m20:53:37.629066 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (execute): 20:53:33.256381 => 20:53:37.628842
[0m20:53:37.630901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3285b6b00>]}
[0m20:53:37.632345 [info ] [Thread-1 (]: 8 of 13 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 4.44s]
[0m20:53:37.634247 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_fraud
[0m20:53:37.635670 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m20:53:37.636957 [info ] [Thread-1 (]: 12 of 13 START sql table model final_project.trx_victim_after_fraud ............ [RUN]
[0m20:53:37.638776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.trx_victim_after_fraud)
[0m20:53:37.640726 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m20:53:37.646139 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m20:53:37.656710 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 20:53:37.641837 => 20:53:37.656271
[0m20:53:37.658155 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m20:53:37.663140 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m20:53:37.674276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:37.675961 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime;
    );
  
[0m20:53:38.534271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f6aaae1f-6a6b-4688-9a71-6a12ce935bb4&page=queryresults
[0m20:53:38.538260 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [39:23]')
[0m20:53:38.912141 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c501391b-c53a-458d-92c3-6bc8176e4960&page=queryresults
[0m20:53:39.757306 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c501391b-c53a-458d-92c3-6bc8176e4960&page=queryresults
[0m20:53:39.759711 [debug] [Thread-2 (]: Timing info for model.final_project.suggest_merchant_acc (execute): 20:53:35.573136 => 20:53:39.759295
[0m20:53:39.783595 [debug] [Thread-2 (]: Database Error in model suggest_merchant_acc (models/optional/suggest_merchant_acc.sql)
  SELECT list expression references column payment_id which is neither grouped nor aggregated at [15:18]
  compiled Code at target/run/final_project/models/optional/suggest_merchant_acc.sql
[0m20:53:39.784980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3296b9120>]}
[0m20:53:39.786511 [error] [Thread-2 (]: 11 of 13 ERROR creating sql table model final_project.suggest_merchant_acc ..... [[31mERROR[0m in 4.24s]
[0m20:53:39.788084 [debug] [Thread-2 (]: Finished running node model.final_project.suggest_merchant_acc
[0m20:53:39.789331 [debug] [Thread-2 (]: Began running node model.final_project.trx_victim_before_fraud
[0m20:53:39.790571 [info ] [Thread-2 (]: 13 of 13 START sql table model final_project.trx_victim_before_fraud ........... [RUN]
[0m20:53:39.792318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.suggest_merchant_acc, now model.final_project.trx_victim_before_fraud)
[0m20:53:39.793496 [debug] [Thread-2 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m20:53:39.798532 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m20:53:39.809831 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 20:53:39.794493 => 20:53:39.809213
[0m20:53:39.811440 [debug] [Thread-2 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m20:53:39.817009 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m20:53:39.825740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:53:39.827686 [debug] [Thread-2 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime;
    );
  
[0m20:53:39.867388 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 20:53:33.240248 => 20:53:39.867145
[0m20:53:39.869328 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa328576560>]}
[0m20:53:39.870951 [info ] [Thread-3 (]: 9 of 13 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (5.5k rows, 124.3 MiB processed)[0m in 6.67s]
[0m20:53:39.872886 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m20:53:39.968003 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2b53850d-1292-4409-a8c6-397a73b8b309&page=queryresults
[0m20:53:39.971062 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2b53850d-1292-4409-a8c6-397a73b8b309&page=queryresults
[0m20:53:39.973709 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 20:53:37.659568 => 20:53:39.973149
[0m20:53:40.005602 [debug] [Thread-1 (]: Database Error in model trx_victim_after_fraud (models/optional/trx_victim_after_fraud.sql)
  Syntax error: Expected ")" but got ";" at [39:23]
  compiled Code at target/run/final_project/models/optional/trx_victim_after_fraud.sql
[0m20:53:40.007876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3296b9270>]}
[0m20:53:40.010117 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model final_project.trx_victim_after_fraud ... [[31mERROR[0m in 2.37s]
[0m20:53:40.013067 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m20:53:40.640455 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1a0549b3-9cbe-4e99-97a0-7fc21e8644e0&page=queryresults
[0m20:53:40.643190 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [39:23]')
[0m20:53:41.372713 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:abc4f9b6-b918-4f8f-9b5b-9d53615c8bf5&page=queryresults
[0m20:53:41.377986 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:abc4f9b6-b918-4f8f-9b5b-9d53615c8bf5&page=queryresults
[0m20:53:41.381281 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 20:53:39.812707 => 20:53:41.380663
[0m20:53:41.413734 [debug] [Thread-2 (]: Database Error in model trx_victim_before_fraud (models/optional/trx_victim_before_fraud.sql)
  Syntax error: Expected ")" but got ";" at [39:23]
  compiled Code at target/run/final_project/models/optional/trx_victim_before_fraud.sql
[0m20:53:41.415241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eee3877-de9b-401d-a5d3-8fc45057083a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa328576530>]}
[0m20:53:41.416405 [error] [Thread-2 (]: 13 of 13 ERROR creating sql table model final_project.trx_victim_before_fraud .. [[31mERROR[0m in 1.62s]
[0m20:53:41.417689 [debug] [Thread-2 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m20:53:41.420369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:41.421335 [debug] [MainThread]: Connection 'model.final_project.trx_victim_after_fraud' was properly closed.
[0m20:53:41.422601 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m20:53:41.424087 [debug] [MainThread]: Connection 'model.final_project.perpet_received_nonfraud' was properly closed.
[0m20:53:41.425838 [info ] [MainThread]: 
[0m20:53:41.427148 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 29.44 seconds (29.44s).
[0m20:53:41.431918 [debug] [MainThread]: Command end result
[0m20:53:41.466110 [info ] [MainThread]: 
[0m20:53:41.467949 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m20:53:41.469585 [info ] [MainThread]: 
[0m20:53:41.471704 [error] [MainThread]:   Database Error in model perpet_send_nonfraud (models/optional/perpet_send_nonfraud.sql)
  Syntax error: Expected ")" but got ";" at [31:18]
  compiled Code at target/run/final_project/models/optional/perpet_send_nonfraud.sql
[0m20:53:41.473475 [info ] [MainThread]: 
[0m20:53:41.474869 [error] [MainThread]:   Database Error in model suggest_merchant_acc (models/optional/suggest_merchant_acc.sql)
  SELECT list expression references column payment_id which is neither grouped nor aggregated at [15:18]
  compiled Code at target/run/final_project/models/optional/suggest_merchant_acc.sql
[0m20:53:41.476392 [info ] [MainThread]: 
[0m20:53:41.477856 [error] [MainThread]:   Database Error in model trx_victim_after_fraud (models/optional/trx_victim_after_fraud.sql)
  Syntax error: Expected ")" but got ";" at [39:23]
  compiled Code at target/run/final_project/models/optional/trx_victim_after_fraud.sql
[0m20:53:41.479392 [info ] [MainThread]: 
[0m20:53:41.480970 [error] [MainThread]:   Database Error in model trx_victim_before_fraud (models/optional/trx_victim_before_fraud.sql)
  Syntax error: Expected ")" but got ";" at [39:23]
  compiled Code at target/run/final_project/models/optional/trx_victim_before_fraud.sql
[0m20:53:41.482629 [info ] [MainThread]: 
[0m20:53:41.484115 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=4 SKIP=0 TOTAL=13
[0m20:53:41.485971 [debug] [MainThread]: Command `dbt run` failed at 20:53:41.485789 after 41.74 seconds
[0m20:53:41.487585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa343cdebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3297529b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3285a2350>]}
[0m20:53:41.489246 [debug] [MainThread]: Flushing usage events
[0m21:00:17.979471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4c6b6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4a102aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4a102a40>]}


============================== 21:00:17.989815 | 6d2bd78a-59a0-41df-87eb-702f488bd34a ==============================
[0m21:00:17.989815 [info ] [MainThread]: Running with dbt=1.6.6
[0m21:00:17.992618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:00:31.802859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4a102a70>]}
[0m21:00:31.820616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c32b7f520>]}
[0m21:00:31.840672 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m21:00:31.901453 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m21:00:35.374570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:00:35.376164 [debug] [MainThread]: Partial parsing: updated file: final_project://models/optional/trx_victim_after_fraud.sql
[0m21:00:35.377507 [debug] [MainThread]: Partial parsing: updated file: final_project://models/optional/suggest_merchant_acc.sql
[0m21:00:35.378658 [debug] [MainThread]: Partial parsing: updated file: final_project://models/optional/trx_victim_before_fraud.sql
[0m21:00:35.379830 [debug] [MainThread]: Partial parsing: updated file: final_project://models/optional/perpet_send_nonfraud.sql
[0m21:00:35.460715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m21:00:35.469057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321fbeb0>]}
[0m21:00:35.518460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c329bd540>]}
[0m21:00:35.520548 [info ] [MainThread]: Found 13 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m21:00:35.524311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c329bd570>]}
[0m21:00:35.528780 [info ] [MainThread]: 
[0m21:00:35.532778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:35.545953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m21:00:35.547757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:38.193538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m21:00:38.195208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:39.068287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c329bd5a0>]}
[0m21:00:39.070001 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m21:00:39.071656 [info ] [MainThread]: 
[0m21:00:39.076521 [debug] [Thread-1 (]: Began running node model.final_project.fill_isValid
[0m21:00:39.077236 [debug] [Thread-2 (]: Began running node model.final_project.monthly_amount_refund_fraud
[0m21:00:39.077744 [debug] [Thread-3 (]: Began running node model.final_project.monthly_confirm_fraud
[0m21:00:39.079129 [info ] [Thread-1 (]: 1 of 13 START sql table model final_project.fill_isValid ....................... [RUN]
[0m21:00:39.081870 [info ] [Thread-2 (]: 2 of 13 START sql table model final_project.monthly_amount_refund_fraud ........ [RUN]
[0m21:00:39.083887 [info ] [Thread-3 (]: 3 of 13 START sql table model final_project.monthly_confirm_fraud .............. [RUN]
[0m21:00:39.086325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_isValid)
[0m21:00:39.088555 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.monthly_amount_refund_fraud'
[0m21:00:39.093083 [debug] [Thread-2 (]: Began compiling node model.final_project.monthly_amount_refund_fraud
[0m21:00:39.091540 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_isValid
[0m21:00:39.090249 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.monthly_confirm_fraud'
[0m21:00:39.106527 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.monthly_amount_refund_fraud"
[0m21:00:39.115137 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_isValid"
[0m21:00:39.116488 [debug] [Thread-3 (]: Began compiling node model.final_project.monthly_confirm_fraud
[0m21:00:39.128766 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.monthly_confirm_fraud"
[0m21:00:39.135809 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_amount_refund_fraud (compile): 21:00:39.094168 => 21:00:39.135205
[0m21:00:39.138090 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (compile): 21:00:39.107689 => 21:00:39.137552
[0m21:00:39.138904 [debug] [Thread-2 (]: Began executing node model.final_project.monthly_amount_refund_fraud
[0m21:00:39.140835 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_confirm_fraud (compile): 21:00:39.119345 => 21:00:39.140450
[0m21:00:39.141405 [debug] [Thread-1 (]: Began executing node model.final_project.fill_isValid
[0m21:00:39.166020 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:00:39.166704 [debug] [Thread-3 (]: Began executing node model.final_project.monthly_confirm_fraud
[0m21:00:39.180571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:39.171167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:40.423013 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.monthly_amount_refund_fraud"
[0m21:00:40.435785 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_isValid"
[0m21:00:40.438109 [debug] [Thread-2 (]: On model.final_project.monthly_amount_refund_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_amount_refund_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_amount_refund_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, refund, newBalanceOriginSet
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND refund=1
    );
  
[0m21:00:40.444330 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.monthly_confirm_fraud"
[0m21:00:40.447504 [debug] [Thread-1 (]: On model.final_project.fill_isValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_isValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_isValid`
      
    
    

    OPTIONS()
    as (
      

WITH isValid_filled AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'

               ELSE 'False'

           END AS isValid
           
    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM isValid_filled
    );
  
[0m21:00:40.451724 [debug] [Thread-3 (]: On model.final_project.monthly_confirm_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_confirm_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_confirm_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, confirm
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND confirm=1
    );
  
[0m21:00:41.045064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:b6f350ba-ca22-458c-aca7-891d9906c8cc&page=queryresults
[0m21:00:41.133399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:6ba72d9a-4e81-4eb7-81dd-2ee83101c37c&page=queryresults
[0m21:00:41.181322 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:0027ac9d-44bd-4767-866e-d200e3203a8f&page=queryresults
[0m21:00:43.798281 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_amount_refund_fraud (execute): 21:00:39.142536 => 21:00:43.797961
[0m21:00:43.804580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c32956860>]}
[0m21:00:43.808247 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_confirm_fraud (execute): 21:00:39.175529 => 21:00:43.807872
[0m21:00:43.810168 [info ] [Thread-2 (]: 2 of 13 OK created sql table model final_project.monthly_amount_refund_fraud ... [[32mCREATE TABLE (8.2k rows, 417.1 KiB processed)[0m in 4.72s]
[0m21:00:43.813040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c32956680>]}
[0m21:00:43.815536 [debug] [Thread-2 (]: Finished running node model.final_project.monthly_amount_refund_fraud
[0m21:00:43.819763 [debug] [Thread-2 (]: Began running node model.final_project.monthly_fraud
[0m21:00:43.817746 [info ] [Thread-3 (]: 3 of 13 OK created sql table model final_project.monthly_confirm_fraud ......... [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 4.72s]
[0m21:00:43.822995 [info ] [Thread-2 (]: 4 of 13 START sql table model final_project.monthly_fraud ...................... [RUN]
[0m21:00:43.827923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_amount_refund_fraud, now model.final_project.monthly_fraud)
[0m21:00:43.829878 [debug] [Thread-2 (]: Began compiling node model.final_project.monthly_fraud
[0m21:00:43.825716 [debug] [Thread-3 (]: Finished running node model.final_project.monthly_confirm_fraud
[0m21:00:43.842762 [debug] [Thread-3 (]: Began running node model.final_project.monthly_range_fraud_amount
[0m21:00:43.844314 [info ] [Thread-3 (]: 5 of 13 START sql table model final_project.monthly_range_fraud_amount ......... [RUN]
[0m21:00:43.846350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_confirm_fraud, now model.final_project.monthly_range_fraud_amount)
[0m21:00:43.848055 [debug] [Thread-3 (]: Began compiling node model.final_project.monthly_range_fraud_amount
[0m21:00:43.839577 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.monthly_fraud"
[0m21:00:43.859536 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.monthly_range_fraud_amount"
[0m21:00:43.868067 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_fraud (compile): 21:00:43.831125 => 21:00:43.867055
[0m21:00:43.868957 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_range_fraud_amount (compile): 21:00:43.849368 => 21:00:43.868626
[0m21:00:43.870032 [debug] [Thread-2 (]: Began executing node model.final_project.monthly_fraud
[0m21:00:43.871790 [debug] [Thread-3 (]: Began executing node model.final_project.monthly_range_fraud_amount
[0m21:00:43.877611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:43.882802 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:44.817920 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.monthly_fraud"
[0m21:00:44.829339 [debug] [Thread-2 (]: On model.final_project.monthly_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND istrueFraud=1
    );
  
[0m21:00:44.913778 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.monthly_range_fraud_amount"
[0m21:00:44.922968 [debug] [Thread-3 (]: On model.final_project.monthly_range_fraud_amount: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_range_fraud_amount"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_range_fraud_amount`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND istrueFraud=1
    );
  
[0m21:00:45.471476 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:67b989af-82e6-4e82-89f2-58f66d1a9c12&page=queryresults
[0m21:00:45.646941 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f97cbe0e-85b9-4802-8139-79a000511d41&page=queryresults
[0m21:00:48.101986 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_fraud (execute): 21:00:43.873728 => 21:00:48.101556
[0m21:00:48.108155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c3221a440>]}
[0m21:00:48.110856 [info ] [Thread-2 (]: 4 of 13 OK created sql table model final_project.monthly_fraud ................. [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 4.28s]
[0m21:00:48.119862 [debug] [Thread-2 (]: Finished running node model.final_project.monthly_fraud
[0m21:00:48.127675 [debug] [Thread-2 (]: Began running node model.final_project.monthly_refund_fraud
[0m21:00:48.129248 [info ] [Thread-2 (]: 6 of 13 START sql table model final_project.monthly_refund_fraud ............... [RUN]
[0m21:00:48.130986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_fraud, now model.final_project.monthly_refund_fraud)
[0m21:00:48.132149 [debug] [Thread-2 (]: Began compiling node model.final_project.monthly_refund_fraud
[0m21:00:48.137054 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.monthly_refund_fraud"
[0m21:00:48.145794 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_refund_fraud (compile): 21:00:48.133484 => 21:00:48.145174
[0m21:00:48.147491 [debug] [Thread-2 (]: Began executing node model.final_project.monthly_refund_fraud
[0m21:00:48.153000 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:48.568759 [debug] [Thread-3 (]: Timing info for model.final_project.monthly_range_fraud_amount (execute): 21:00:43.879201 => 21:00:48.568504
[0m21:00:48.571700 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c320fa2f0>]}
[0m21:00:48.574102 [info ] [Thread-3 (]: 5 of 13 OK created sql table model final_project.monthly_range_fraud_amount .... [[32mCREATE TABLE (8.2k rows, 481.2 KiB processed)[0m in 4.73s]
[0m21:00:48.576351 [debug] [Thread-3 (]: Finished running node model.final_project.monthly_range_fraud_amount
[0m21:00:49.096409 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.monthly_refund_fraud"
[0m21:00:49.118256 [debug] [Thread-2 (]: On model.final_project.monthly_refund_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.monthly_refund_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`monthly_refund_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, refund
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND refund=1
    );
  
[0m21:00:49.791231 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:551b58d4-aa3d-43da-90e3-3e0f23ed450c&page=queryresults
[0m21:00:50.107401 [debug] [Thread-1 (]: Timing info for model.final_project.fill_isValid (execute): 21:00:39.168211 => 21:00:50.106942
[0m21:00:50.111007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c32955660>]}
[0m21:00:50.113889 [info ] [Thread-1 (]: 1 of 13 OK created sql table model final_project.fill_isValid .................. [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 11.02s]
[0m21:00:50.116519 [debug] [Thread-1 (]: Finished running node model.final_project.fill_isValid
[0m21:00:50.119517 [debug] [Thread-3 (]: Began running node model.final_project.fill_transactionValid
[0m21:00:50.121454 [info ] [Thread-3 (]: 7 of 13 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m21:00:50.123979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_range_fraud_amount, now model.final_project.fill_transactionValid)
[0m21:00:50.125987 [debug] [Thread-3 (]: Began compiling node model.final_project.fill_transactionValid
[0m21:00:50.131470 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m21:00:50.144848 [debug] [Thread-3 (]: Timing info for model.final_project.fill_transactionValid (compile): 21:00:50.127503 => 21:00:50.144458
[0m21:00:50.146616 [debug] [Thread-3 (]: Began executing node model.final_project.fill_transactionValid
[0m21:00:50.149938 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:51.082588 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m21:00:51.097451 [debug] [Thread-3 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceOrg - amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceOrg + amount, 1)

               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND isValid = 'False'
               THEN ROUND(oldbalanceDest + amount, 1)

               WHEN type = 'CASH_IN' AND isValid = 'False'
               THEN ROUND(oldbalanceDest - amount, 1)
               
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`fill_isValid`
)

SELECT *
FROM base_data
    );
  
[0m21:00:51.726247 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c61dcdd0-1d28-404f-adc4-620d17323656&page=queryresults
[0m21:00:52.463818 [debug] [Thread-2 (]: Timing info for model.final_project.monthly_refund_fraud (execute): 21:00:48.148994 => 21:00:52.463601
[0m21:00:52.465782 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321b6a70>]}
[0m21:00:52.467685 [info ] [Thread-2 (]: 6 of 13 OK created sql table model final_project.monthly_refund_fraud .......... [[32mCREATE TABLE (8.2k rows, 352.9 KiB processed)[0m in 4.34s]
[0m21:00:52.469788 [debug] [Thread-2 (]: Finished running node model.final_project.monthly_refund_fraud
[0m21:01:01.147889 [debug] [Thread-3 (]: Timing info for model.final_project.fill_transactionValid (execute): 21:00:50.147989 => 21:01:01.147302
[0m21:01:01.150953 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321b65c0>]}
[0m21:01:01.153036 [info ] [Thread-3 (]: 7 of 13 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 856.7 MiB processed)[0m in 11.03s]
[0m21:01:01.155264 [debug] [Thread-3 (]: Finished running node model.final_project.fill_transactionValid
[0m21:01:01.158677 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_fraud
[0m21:01:01.159448 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_nonfraud
[0m21:01:01.159976 [debug] [Thread-3 (]: Began running node model.final_project.perpet_send_nonfraud
[0m21:01:01.161321 [info ] [Thread-1 (]: 8 of 13 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m21:01:01.163219 [info ] [Thread-2 (]: 9 of 13 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m21:01:01.164936 [info ] [Thread-3 (]: 10 of 13 START sql table model final_project.perpet_send_nonfraud .............. [RUN]
[0m21:01:01.166744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_isValid, now model.final_project.perpet_received_fraud)
[0m21:01:01.168808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.monthly_refund_fraud, now model.final_project.perpet_received_nonfraud)
[0m21:01:01.170946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_send_nonfraud)
[0m21:01:01.172830 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_fraud
[0m21:01:01.174740 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m21:01:01.176413 [debug] [Thread-3 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m21:01:01.181155 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m21:01:01.186287 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m21:01:01.192053 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m21:01:01.201097 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (compile): 21:01:01.177689 => 21:01:01.200393
[0m21:01:01.202804 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 21:01:01.182720 => 21:01:01.202358
[0m21:01:01.204178 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_fraud
[0m21:01:01.206023 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 21:01:01.187926 => 21:01:01.205435
[0m21:01:01.207418 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m21:01:01.211422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:01.213425 [debug] [Thread-3 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m21:01:01.217579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:01.224785 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m21:01:01.241485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:01.243137 [debug] [Thread-3 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m21:01:02.331422 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m21:01:02.334594 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m21:01:02.347508 [debug] [Thread-2 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
NonFraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 0
)

SELECT 
    nft.nameDest,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    NonFraudulentTransactions nft
WHERE 
    nft.nameDest IN (SELECT nameDest FROM FraudulentTransactions)
GROUP BY 
    nft.nameDest
    );
  
[0m21:01:02.351119 [debug] [Thread-1 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m21:01:02.595156 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d6fdb242-cde0-4ffd-a3ee-ac6a21a1610c&page=queryresults
[0m21:01:03.006185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7fb29670-64e0-465f-ba67-98404486e7de&page=queryresults
[0m21:01:03.037829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c5b48042-2656-49eb-8428-1edf7a9978ff&page=queryresults
[0m21:01:06.399311 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 21:01:01.221269 => 21:01:06.399116
[0m21:01:06.401328 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321b3340>]}
[0m21:01:06.403552 [info ] [Thread-3 (]: 10 of 13 OK created sql table model final_project.perpet_send_nonfraud ......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 5.23s]
[0m21:01:06.405458 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m21:01:06.407039 [debug] [Thread-3 (]: Began running node model.final_project.suggest_merchant_acc
[0m21:01:06.409238 [info ] [Thread-3 (]: 11 of 13 START sql table model final_project.suggest_merchant_acc .............. [RUN]
[0m21:01:06.411139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.suggest_merchant_acc)
[0m21:01:06.412587 [debug] [Thread-3 (]: Began compiling node model.final_project.suggest_merchant_acc
[0m21:01:06.419126 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.suggest_merchant_acc"
[0m21:01:06.432220 [debug] [Thread-3 (]: Timing info for model.final_project.suggest_merchant_acc (compile): 21:01:06.413692 => 21:01:06.431570
[0m21:01:06.433936 [debug] [Thread-3 (]: Began executing node model.final_project.suggest_merchant_acc
[0m21:01:06.438841 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.suggest_merchant_acc"
[0m21:01:06.450044 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:01:06.451831 [debug] [Thread-3 (]: On model.final_project.suggest_merchant_acc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.suggest_merchant_acc"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`suggest_merchant_acc`
      
    
    

    OPTIONS()
    as (
      

SELECT nameDest, count (*) AS trx
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
WHERE isFraud=0 
GROUP BY nameDest
ORDER BY trx DESC 
LIMIT 100
    );
  
[0m21:01:06.579954 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (execute): 21:01:01.208574 => 21:01:06.579738
[0m21:01:06.582789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c320d85e0>]}
[0m21:01:06.585102 [info ] [Thread-1 (]: 8 of 13 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 5.42s]
[0m21:01:06.588871 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_fraud
[0m21:01:06.591339 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m21:01:06.593146 [info ] [Thread-1 (]: 12 of 13 START sql table model final_project.trx_victim_after_fraud ............ [RUN]
[0m21:01:06.597046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.trx_victim_after_fraud)
[0m21:01:06.599133 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m21:01:06.610119 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m21:01:06.626118 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 21:01:06.600992 => 21:01:06.625177
[0m21:01:06.628869 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m21:01:06.638595 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m21:01:06.658702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:06.661161 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m21:01:07.489558 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:421c7e39-97b9-4f29-8f38-24707d4107b1&page=queryresults
[0m21:01:07.735649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:3128c6b7-9e38-4f96-b4c7-edc5741b3a43&page=queryresults
[0m21:01:08.674431 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 21:01:01.215043 => 21:01:08.674094
[0m21:01:08.677372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321b7130>]}
[0m21:01:08.679717 [info ] [Thread-2 (]: 9 of 13 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (5.5k rows, 124.3 MiB processed)[0m in 7.51s]
[0m21:01:08.681795 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m21:01:08.683979 [debug] [Thread-2 (]: Began running node model.final_project.trx_victim_before_fraud
[0m21:01:08.686266 [info ] [Thread-2 (]: 13 of 13 START sql table model final_project.trx_victim_before_fraud ........... [RUN]
[0m21:01:08.688426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_before_fraud)
[0m21:01:08.690492 [debug] [Thread-2 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m21:01:08.695140 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m21:01:08.710186 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 21:01:08.692011 => 21:01:08.709594
[0m21:01:08.711884 [debug] [Thread-2 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m21:01:08.717420 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m21:01:08.730710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:01:08.732546 [debug] [Thread-2 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m21:01:09.724105 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:918d8fa3-c368-45e1-9d2a-4f8a562d933d&page=queryresults
[0m21:01:11.017536 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 21:01:06.631005 => 21:01:11.017283
[0m21:01:11.019637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2a7680d0>]}
[0m21:01:11.021665 [info ] [Thread-1 (]: 12 of 13 OK created sql table model final_project.trx_victim_after_fraud ....... [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.42s]
[0m21:01:11.024149 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m21:01:12.158093 [debug] [Thread-3 (]: Timing info for model.final_project.suggest_merchant_acc (execute): 21:01:06.434986 => 21:01:12.157887
[0m21:01:12.160339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2a7258a0>]}
[0m21:01:12.162354 [info ] [Thread-3 (]: 11 of 13 OK created sql table model final_project.suggest_merchant_acc ......... [[32mCREATE TABLE (100.0 rows, 124.3 MiB processed)[0m in 5.75s]
[0m21:01:12.164436 [debug] [Thread-3 (]: Finished running node model.final_project.suggest_merchant_acc
[0m21:01:13.196441 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 21:01:08.713059 => 21:01:13.195955
[0m21:01:13.199147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2bd78a-59a0-41df-87eb-702f488bd34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c321b7010>]}
[0m21:01:13.201336 [info ] [Thread-2 (]: 13 of 13 OK created sql table model final_project.trx_victim_before_fraud ...... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.51s]
[0m21:01:13.203455 [debug] [Thread-2 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m21:01:13.207817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:13.209742 [debug] [MainThread]: Connection 'model.final_project.trx_victim_after_fraud' was properly closed.
[0m21:01:13.211332 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m21:01:13.212915 [debug] [MainThread]: Connection 'model.final_project.suggest_merchant_acc' was properly closed.
[0m21:01:13.214677 [info ] [MainThread]: 
[0m21:01:13.216128 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 37.68 seconds (37.68s).
[0m21:01:13.219452 [debug] [MainThread]: Command end result
[0m21:01:13.256036 [info ] [MainThread]: 
[0m21:01:13.257982 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:13.259768 [info ] [MainThread]: 
[0m21:01:13.261882 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m21:01:13.264032 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:13.263736 after 55.30 seconds
[0m21:01:13.265613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4c6b6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c4e0dd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c329af6d0>]}
[0m21:01:13.267352 [debug] [MainThread]: Flushing usage events
[0m13:16:50.808302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e280f2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25a06950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25a068f0>]}


============================== 13:16:50.862578 | d84861f5-cb3f-4e04-b1e1-cfaefdc66d47 ==============================
[0m13:16:50.862578 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:16:50.871627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:29.036124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e25a06920>]}
[0m13:17:29.078120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e52caf0>]}
[0m13:17:29.120070 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:17:29.215332 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:17:36.330650 [debug] [MainThread]: Partial parsing enabled: 12 files deleted, 9 files added, 1 files changed.
[0m13:17:36.332851 [debug] [MainThread]: Partial parsing: added file: final_project://models/fraud_transaction.sql
[0m13:17:36.334577 [debug] [MainThread]: Partial parsing: added file: final_project://models/fraud_traansaction_ofAll.sql
[0m13:17:36.336125 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/trx_victim_before_fraud.sql
[0m13:17:36.338115 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/amount_categorizing.sql
[0m13:17:36.339975 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/perpet_send_nonfraud.sql
[0m13:17:36.341692 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/suggest_merchant_acc.sql
[0m13:17:36.343255 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/trx_victim_after_fraud.sql
[0m13:17:36.344802 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/perpet_received_fraud.sql
[0m13:17:36.346668 [debug] [MainThread]: Partial parsing: added file: final_project://models/additional/perpet_received_nonfraud.sql
[0m13:17:36.348204 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/trx_victim_after_fraud.sql
[0m13:17:36.349617 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/trx_victim_before_fraud.sql
[0m13:17:36.350912 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/perpet_received_fraud.sql
[0m13:17:36.352158 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/monthly_confirm_fraud.sql
[0m13:17:36.353468 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/monthly_fraud.sql
[0m13:17:36.355014 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/fill_isValid.sql
[0m13:17:36.356774 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/monthly_range_fraud_amount.sql
[0m13:17:36.358321 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/perpet_received_nonfraud.sql
[0m13:17:36.360049 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/suggest_merchant_acc.sql
[0m13:17:36.361571 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/monthly_refund_fraud.sql
[0m13:17:36.363057 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/monthly_amount_refund_fraud.sql
[0m13:17:36.364736 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/optional/perpet_send_nonfraud.sql
[0m13:17:36.367116 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m13:17:36.547572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m13:17:36.571230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0d9d41c0>]}
[0m13:17:36.723544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2ffd30>]}
[0m13:17:36.730489 [info ] [MainThread]: Found 10 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m13:17:36.732620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2ffd90>]}
[0m13:17:36.737857 [info ] [MainThread]: 
[0m13:17:36.741474 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:36.744874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m13:17:36.748515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:40.854205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m13:17:40.856875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:41.836619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2fea10>]}
[0m13:17:41.841149 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:17:41.847522 [info ] [MainThread]: 
[0m13:17:41.857088 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m13:17:41.858541 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m13:17:41.861262 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m13:17:41.864534 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m13:17:41.867808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m13:17:41.871947 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m13:17:41.875029 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m13:17:41.877787 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m13:17:41.902386 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m13:17:41.934041 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m13:17:41.981570 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 13:17:41.879888 => 13:17:41.980682
[0m13:17:41.984576 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m13:17:41.985958 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 13:17:41.902555 => 13:17:41.985341
[0m13:17:42.016596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:42.017579 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m13:17:42.079434 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m13:17:42.103102 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:42.108340 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldbalanceOrg, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1, isTrueFraud=1
    );
  
[0m13:17:43.092208 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m13:17:43.105273 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m13:17:43.126689 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4e99c62b-5bca-4c05-951c-2c7f938a79f3&page=queryresults
[0m13:17:43.129602 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [17:16]')
[0m13:17:43.540893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f343c7cb-929d-4153-9312-c3294f2376ca&page=queryresults
[0m13:17:43.544224 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword CASE at [40:12]')
[0m13:17:43.862613 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:58d23285-b443-4a65-b294-45aa2bf495a7&page=queryresults
[0m13:17:43.866045 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:58d23285-b443-4a65-b294-45aa2bf495a7&page=queryresults
[0m13:17:43.869172 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 13:17:42.022745 => 13:17:43.868787
[0m13:17:44.183382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:8d81bc10-1f39-4dd8-9022-33bc057b4fb8&page=queryresults
[0m13:17:44.191220 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:8d81bc10-1f39-4dd8-9022-33bc057b4fb8&page=queryresults
[0m13:17:44.195425 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 13:17:41.987619 => 13:17:44.194539
[0m13:17:44.304399 [debug] [Thread-1 (]: Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Syntax error: Expected ")" but got keyword CASE at [40:12]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m13:17:44.308146 [debug] [Thread-2 (]: Database Error in model fraud_transaction (models/fraud_transaction.sql)
  Syntax error: Expected ")" but got "," at [17:16]
  compiled Code at target/run/final_project/models/fraud_transaction.sql
[0m13:17:44.310214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2ffd90>]}
[0m13:17:44.312556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84861f5-cb3f-4e04-b1e1-cfaefdc66d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0e2fd180>]}
[0m13:17:44.315016 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model final_project.fill_transactionValid ..... [[31mERROR[0m in 2.44s]
[0m13:17:44.317979 [error] [Thread-2 (]: 2 of 10 ERROR creating sql table model final_project.fraud_transaction ......... [[31mERROR[0m in 2.44s]
[0m13:17:44.320339 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m13:17:44.324386 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m13:17:44.329453 [debug] [Thread-3 (]: Began running node model.final_project.amount_categorizing
[0m13:17:44.330608 [debug] [Thread-1 (]: Began running node model.final_project.fraud_traansaction_ofAll
[0m13:17:44.331828 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m13:17:44.334574 [info ] [Thread-3 (]: 3 of 10 SKIP relation final_project.amount_categorizing ........................ [[33mSKIP[0m]
[0m13:17:44.336561 [info ] [Thread-1 (]: 4 of 10 SKIP relation final_project.fraud_traansaction_ofAll ................... [[33mSKIP[0m]
[0m13:17:44.341953 [info ] [Thread-2 (]: 5 of 10 SKIP relation final_project.perpet_received_fraud ...................... [[33mSKIP[0m]
[0m13:17:44.344586 [debug] [Thread-3 (]: Finished running node model.final_project.amount_categorizing
[0m13:17:44.346639 [debug] [Thread-1 (]: Finished running node model.final_project.fraud_traansaction_ofAll
[0m13:17:44.348891 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m13:17:44.351708 [debug] [Thread-3 (]: Began running node model.final_project.perpet_received_nonfraud
[0m13:17:44.354179 [debug] [Thread-1 (]: Began running node model.final_project.perpet_send_nonfraud
[0m13:17:44.357343 [debug] [Thread-2 (]: Began running node model.final_project.suggest_merchant_acc
[0m13:17:44.359674 [info ] [Thread-3 (]: 6 of 10 SKIP relation final_project.perpet_received_nonfraud ................... [[33mSKIP[0m]
[0m13:17:44.361606 [info ] [Thread-1 (]: 7 of 10 SKIP relation final_project.perpet_send_nonfraud ....................... [[33mSKIP[0m]
[0m13:17:44.363853 [info ] [Thread-2 (]: 8 of 10 SKIP relation final_project.suggest_merchant_acc ....................... [[33mSKIP[0m]
[0m13:17:44.366052 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m13:17:44.367911 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m13:17:44.369912 [debug] [Thread-2 (]: Finished running node model.final_project.suggest_merchant_acc
[0m13:17:44.373061 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_after_fraud
[0m13:17:44.375204 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_before_fraud
[0m13:17:44.379123 [info ] [Thread-3 (]: 9 of 10 SKIP relation final_project.trx_victim_after_fraud ..................... [[33mSKIP[0m]
[0m13:17:44.381216 [info ] [Thread-1 (]: 10 of 10 SKIP relation final_project.trx_victim_before_fraud ................... [[33mSKIP[0m]
[0m13:17:44.383363 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m13:17:44.385241 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m13:17:44.392233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:44.394247 [debug] [MainThread]: Connection 'model.final_project.fill_transactionValid' was properly closed.
[0m13:17:44.396132 [debug] [MainThread]: Connection 'model.final_project.fraud_transaction' was properly closed.
[0m13:17:44.398039 [info ] [MainThread]: 
[0m13:17:44.400004 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m13:17:44.405398 [debug] [MainThread]: Command end result
[0m13:17:44.455330 [info ] [MainThread]: 
[0m13:17:44.458221 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:17:44.461471 [info ] [MainThread]: 
[0m13:17:44.464723 [error] [MainThread]:   Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Syntax error: Expected ")" but got keyword CASE at [40:12]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m13:17:44.467281 [info ] [MainThread]: 
[0m13:17:44.472545 [error] [MainThread]:   Database Error in model fraud_transaction (models/fraud_transaction.sql)
  Syntax error: Expected ")" but got "," at [17:16]
  compiled Code at target/run/final_project/models/fraud_transaction.sql
[0m13:17:44.475828 [info ] [MainThread]: 
[0m13:17:44.478943 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=8 TOTAL=10
[0m13:17:44.482644 [debug] [MainThread]: Command `dbt run` failed at 13:17:44.482233 after 53.81 seconds
[0m13:17:44.485309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e280f2aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e27b498d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e0da38520>]}
[0m13:17:44.487791 [debug] [MainThread]: Flushing usage events
[0m13:20:36.489678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c13b6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2beccea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2becce9e0>]}


============================== 13:20:36.511638 | 79ba1c74-6a8a-4e21-bf12-0ae817574842 ==============================
[0m13:20:36.511638 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:20:36.513888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:59.559147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2beccea10>]}
[0m13:20:59.589438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c08926b0>]}
[0m13:20:59.605250 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:20:59.713062 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:21:02.713931 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m13:21:02.715504 [debug] [MainThread]: Partial parsing: added file: final_project://models/fraud_transaction_ofAll.sql
[0m13:21:02.717081 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/fraud_traansaction_ofAll.sql
[0m13:21:02.718632 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m13:21:02.719963 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fraud_transaction.sql
[0m13:21:02.806613 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m13:21:02.819402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a75ea2f0>]}
[0m13:21:02.878492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a75bc880>]}
[0m13:21:02.880323 [info ] [MainThread]: Found 10 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m13:21:02.883903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a75bc730>]}
[0m13:21:02.889090 [info ] [MainThread]: 
[0m13:21:02.894446 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:02.898223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m13:21:02.899701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:05.317626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m13:21:05.319364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:06.096149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a758a680>]}
[0m13:21:06.098076 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:21:06.099777 [info ] [MainThread]: 
[0m13:21:06.105944 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m13:21:06.108890 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m13:21:06.110782 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m13:21:06.112856 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m13:21:06.115100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m13:21:06.117143 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m13:21:06.118753 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m13:21:06.120104 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m13:21:06.135051 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m13:21:06.139480 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m13:21:06.148161 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 13:21:06.121240 => 13:21:06.147465
[0m13:21:06.149097 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 13:21:06.136117 => 13:21:06.148707
[0m13:21:06.150282 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m13:21:06.151773 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m13:21:06.210466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:06.263847 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m13:21:06.279573 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:06.281807 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldbalanceOrg, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m13:21:07.215216 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m13:21:07.223670 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m13:21:07.449951 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:01a86e42-e6e8-4524-9a27-e071e858df16&page=queryresults
[0m13:21:07.680335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:aff5aa2a-4de9-4dda-a25a-7c5b4eb66ec4&page=queryresults
[0m13:21:07.683267 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword CASE at [40:12]')
[0m13:21:08.297495 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: oldbalanceOrg; Did you mean oldBalanceOrigin? at [15:83]')
[0m13:21:08.652498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:0a09a665-868d-46d6-a7d1-116a6144ee35&page=queryresults
[0m13:21:08.655135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:0a09a665-868d-46d6-a7d1-116a6144ee35&page=queryresults
[0m13:21:08.657335 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 13:21:06.153024 => 13:21:08.656949
[0m13:21:08.755650 [debug] [Thread-1 (]: Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Syntax error: Expected ")" but got keyword CASE at [40:12]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m13:21:08.756691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a6cbdde0>]}
[0m13:21:08.758217 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model final_project.fill_transactionValid ..... [[31mERROR[0m in 2.64s]
[0m13:21:08.760421 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m13:21:08.762886 [debug] [Thread-3 (]: Began running node model.final_project.amount_categorizing
[0m13:21:08.763509 [debug] [Thread-1 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m13:21:08.764610 [info ] [Thread-3 (]: 3 of 10 SKIP relation final_project.amount_categorizing ........................ [[33mSKIP[0m]
[0m13:21:08.766320 [info ] [Thread-1 (]: 4 of 10 SKIP relation final_project.fraud_transaction_ofAll .................... [[33mSKIP[0m]
[0m13:21:08.767635 [debug] [Thread-3 (]: Finished running node model.final_project.amount_categorizing
[0m13:21:08.769078 [debug] [Thread-1 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m13:21:08.770487 [debug] [Thread-3 (]: Began running node model.final_project.perpet_received_fraud
[0m13:21:08.772086 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m13:21:08.773655 [info ] [Thread-3 (]: 5 of 10 SKIP relation final_project.perpet_received_fraud ...................... [[33mSKIP[0m]
[0m13:21:08.776196 [info ] [Thread-1 (]: 6 of 10 SKIP relation final_project.perpet_received_nonfraud ................... [[33mSKIP[0m]
[0m13:21:08.777889 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_received_fraud
[0m13:21:08.779660 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m13:21:08.781316 [debug] [Thread-3 (]: Began running node model.final_project.perpet_send_nonfraud
[0m13:21:08.783039 [debug] [Thread-1 (]: Began running node model.final_project.suggest_merchant_acc
[0m13:21:08.784616 [info ] [Thread-3 (]: 7 of 10 SKIP relation final_project.perpet_send_nonfraud ....................... [[33mSKIP[0m]
[0m13:21:08.786237 [info ] [Thread-1 (]: 8 of 10 SKIP relation final_project.suggest_merchant_acc ....................... [[33mSKIP[0m]
[0m13:21:08.787571 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m13:21:08.789096 [debug] [Thread-1 (]: Finished running node model.final_project.suggest_merchant_acc
[0m13:21:08.790684 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_after_fraud
[0m13:21:08.793431 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_before_fraud
[0m13:21:08.794955 [info ] [Thread-3 (]: 9 of 10 SKIP relation final_project.trx_victim_after_fraud ..................... [[33mSKIP[0m]
[0m13:21:08.796501 [info ] [Thread-1 (]: 10 of 10 SKIP relation final_project.trx_victim_before_fraud ................... [[33mSKIP[0m]
[0m13:21:08.798277 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m13:21:08.799875 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m13:21:09.458716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:46a92355-6107-428c-8595-1ece7fed0396&page=queryresults
[0m13:21:10.277764 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:46a92355-6107-428c-8595-1ece7fed0396&page=queryresults
[0m13:21:10.281317 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 13:21:06.166827 => 13:21:10.280605
[0m13:21:10.306981 [debug] [Thread-2 (]: Database Error in model fraud_transaction (models/fraud_transaction.sql)
  Unrecognized name: oldbalanceOrg; Did you mean oldBalanceOrigin? at [15:83]
  compiled Code at target/run/final_project/models/fraud_transaction.sql
[0m13:21:10.309533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ba1c74-6a8a-4e21-bf12-0ae817574842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a6cbdd80>]}
[0m13:21:10.311483 [error] [Thread-2 (]: 2 of 10 ERROR creating sql table model final_project.fraud_transaction ......... [[31mERROR[0m in 4.19s]
[0m13:21:10.313386 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m13:21:10.316689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:10.318336 [debug] [MainThread]: Connection 'model.final_project.fill_transactionValid' was properly closed.
[0m13:21:10.319553 [debug] [MainThread]: Connection 'model.final_project.fraud_transaction' was properly closed.
[0m13:21:10.320836 [info ] [MainThread]: 
[0m13:21:10.322999 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m13:21:10.327010 [debug] [MainThread]: Command end result
[0m13:21:10.398568 [info ] [MainThread]: 
[0m13:21:10.401061 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:21:10.403613 [info ] [MainThread]: 
[0m13:21:10.405779 [error] [MainThread]:   Database Error in model fill_transactionValid (models/fill_transactionValid.sql)
  Syntax error: Expected ")" but got keyword CASE at [40:12]
  compiled Code at target/run/final_project/models/fill_transactionValid.sql
[0m13:21:10.413913 [info ] [MainThread]: 
[0m13:21:10.416072 [error] [MainThread]:   Database Error in model fraud_transaction (models/fraud_transaction.sql)
  Unrecognized name: oldbalanceOrg; Did you mean oldBalanceOrigin? at [15:83]
  compiled Code at target/run/final_project/models/fraud_transaction.sql
[0m13:21:10.418655 [info ] [MainThread]: 
[0m13:21:10.430041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=8 TOTAL=10
[0m13:21:10.433403 [debug] [MainThread]: Command `dbt run` failed at 13:21:10.433027 after 33.99 seconds
[0m13:21:10.443662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c13b6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a6cbcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a6cbebf0>]}
[0m13:21:10.445633 [debug] [MainThread]: Flushing usage events
[0m13:26:44.334020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacefeeb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacc8fea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacc8fe9b0>]}


============================== 13:26:44.356497 | 0f68718d-33c4-4eec-9ab0-1e7f1175529d ==============================
[0m13:26:44.356497 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:26:44.358376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:04.710427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacc8fe9e0>]}
[0m13:27:04.740682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcace4a9e70>]}
[0m13:27:04.762897 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:27:04.826923 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:27:08.652362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:27:08.653885 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fill_transactionValid.sql
[0m13:27:08.655250 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fraud_transaction.sql
[0m13:27:08.736272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m13:27:08.747666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4a56230>]}
[0m13:27:08.804524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51e7040>]}
[0m13:27:08.807304 [info ] [MainThread]: Found 10 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m13:27:08.808951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51e6f80>]}
[0m13:27:08.813037 [info ] [MainThread]: 
[0m13:27:08.816942 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:08.819956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m13:27:08.821348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:11.334314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m13:27:11.336671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:12.173704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51e59c0>]}
[0m13:27:12.176534 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:27:12.178571 [info ] [MainThread]: 
[0m13:27:12.184097 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m13:27:12.185907 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m13:27:12.187374 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m13:27:12.189251 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m13:27:12.191078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m13:27:12.193320 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m13:27:12.194661 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m13:27:12.196414 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m13:27:12.208100 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m13:27:12.211702 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m13:27:12.220992 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 13:27:12.199145 => 13:27:12.219880
[0m13:27:12.221851 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 13:27:12.209372 => 13:27:12.221494
[0m13:27:12.223074 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m13:27:12.224666 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m13:27:12.257929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:12.286650 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m13:27:12.298979 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:12.301072 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m13:27:13.205011 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m13:27:13.218855 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m13:27:13.486514 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:60f484f3-f1ad-4211-9d93-ac39bcdcd439&page=queryresults
[0m13:27:13.755904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:859da5f1-7bc5-4f7f-8013-fa271ac85e93&page=queryresults
[0m13:27:16.385003 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 13:27:12.239403 => 13:27:16.384787
[0m13:27:16.387153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51dead0>]}
[0m13:27:16.389035 [info ] [Thread-2 (]: 2 of 10 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.19s]
[0m13:27:16.390677 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m13:27:21.909689 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 13:27:12.225808 => 13:27:21.909436
[0m13:27:21.912142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab5183fd0>]}
[0m13:27:21.914362 [info ] [Thread-1 (]: 1 of 10 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 9.72s]
[0m13:27:21.916808 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m13:27:21.919978 [debug] [Thread-3 (]: Began running node model.final_project.amount_categorizing
[0m13:27:21.920631 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m13:27:21.921117 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_fraud
[0m13:27:21.922536 [info ] [Thread-3 (]: 3 of 10 START sql view model final_project.amount_categorizing ................. [RUN]
[0m13:27:21.924262 [info ] [Thread-2 (]: 4 of 10 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m13:27:21.926117 [info ] [Thread-1 (]: 5 of 10 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m13:27:21.928278 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.amount_categorizing'
[0m13:27:21.930576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.fraud_transaction_ofAll)
[0m13:27:21.933448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_fraud)
[0m13:27:21.935384 [debug] [Thread-3 (]: Began compiling node model.final_project.amount_categorizing
[0m13:27:21.937205 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m13:27:21.938989 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_fraud
[0m13:27:21.943713 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.amount_categorizing"
[0m13:27:21.948771 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m13:27:21.953195 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m13:27:21.960854 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 13:27:21.945412 => 13:27:21.960267
[0m13:27:21.962416 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m13:27:21.970144 [debug] [Thread-3 (]: Timing info for model.final_project.amount_categorizing (compile): 13:27:21.940389 => 13:27:21.969689
[0m13:27:21.971187 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m13:27:21.974483 [debug] [Thread-3 (]: Began executing node model.final_project.amount_categorizing
[0m13:27:21.977480 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (compile): 13:27:21.950448 => 13:27:21.976701
[0m13:27:22.001007 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_fraud
[0m13:27:22.008812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:22.021953 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m13:27:22.032534 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.amount_categorizing"
[0m13:27:22.033285 [debug] [Thread-2 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m13:27:22.050542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:22.054165 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:27:22.055977 [debug] [Thread-1 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m13:27:22.064559 [debug] [Thread-3 (]: On model.final_project.amount_categorizing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.amount_categorizing"} */


  create or replace view `eternal-channel-400514`.`final_project`.`amount_categorizing`
  OPTIONS()
  as SELECT
  type,
  CASE
    WHEN amount <= 200000 THEN '0-200K'
    WHEN amount > 200000 AND amount <= 400000 THEN '200K-400K'
    WHEN amount > 400000 AND amount <= 600000 THEN '400K-600K'
    WHEN amount > 600000 AND amount <= 800000 THEN '600K-800K'
    WHEN amount > 800000 AND amount <= 1000000 THEN '800K-1,000K'
    WHEN amount > 1000000 THEN 'More than 1,000K'
  END AS amount_range,
  COUNT(*) AS transaction_count, 
  SUM(amount) AS total_amount
FROM
  `eternal-channel-400514`.`final_project`.`fill_transactionValid`
GROUP BY
  type,
  amount_range
ORDER BY amount_range;


[0m13:27:23.185070 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:584c6c38-b951-4ad4-96fb-1f3465986345&page=queryresults
[0m13:27:23.272137 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:28e020a2-6f93-4fa3-9005-3c3b6f26c429&page=queryresults
[0m13:27:23.296673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d9152734-56c5-4450-9afb-199b6ddf418b&page=queryresults
[0m13:27:24.011005 [debug] [Thread-3 (]: Timing info for model.final_project.amount_categorizing (execute): 13:27:21.979004 => 13:27:24.010778
[0m13:27:24.013141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab49800a0>]}
[0m13:27:24.015119 [info ] [Thread-3 (]: 3 of 10 OK created sql view model final_project.amount_categorizing ............ [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m13:27:24.017483 [debug] [Thread-3 (]: Finished running node model.final_project.amount_categorizing
[0m13:27:24.019319 [debug] [Thread-3 (]: Began running node model.final_project.perpet_received_nonfraud
[0m13:27:24.020983 [info ] [Thread-3 (]: 6 of 10 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m13:27:24.022892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.amount_categorizing, now model.final_project.perpet_received_nonfraud)
[0m13:27:24.024412 [debug] [Thread-3 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m13:27:24.030086 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m13:27:24.041957 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 13:27:24.025494 => 13:27:24.041410
[0m13:27:24.043627 [debug] [Thread-3 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m13:27:24.048412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:24.889603 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m13:27:24.905522 [debug] [Thread-3 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime;
    );
  
[0m13:27:25.428803 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:3570554c-4d37-4dab-8bdd-59a3180b2356&page=queryresults
[0m13:27:25.433406 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [40:25]')
[0m13:27:25.884213 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d2b2f9f5-907f-4560-ba0b-295f756ff6b1&page=queryresults
[0m13:27:25.887392 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d2b2f9f5-907f-4560-ba0b-295f756ff6b1&page=queryresults
[0m13:27:25.890492 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 13:27:24.044822 => 13:27:25.889732
[0m13:27:26.112039 [debug] [Thread-3 (]: Database Error in model perpet_received_nonfraud (models/additional/perpet_received_nonfraud.sql)
  Syntax error: Expected ")" but got ";" at [40:25]
  compiled Code at target/run/final_project/models/additional/perpet_received_nonfraud.sql
[0m13:27:26.113652 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51ddf00>]}
[0m13:27:26.115520 [error] [Thread-3 (]: 6 of 10 ERROR creating sql table model final_project.perpet_received_nonfraud .. [[31mERROR[0m in 2.09s]
[0m13:27:26.118096 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m13:27:26.119734 [debug] [Thread-3 (]: Began running node model.final_project.perpet_send_nonfraud
[0m13:27:26.121546 [info ] [Thread-3 (]: 7 of 10 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m13:27:26.123762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.perpet_send_nonfraud)
[0m13:27:26.125151 [debug] [Thread-3 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m13:27:26.131288 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m13:27:26.143234 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 13:27:26.126519 => 13:27:26.142422
[0m13:27:26.147819 [debug] [Thread-3 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m13:27:26.160038 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:26.365328 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (execute): 13:27:22.009748 => 13:27:26.365040
[0m13:27:26.367234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4933010>]}
[0m13:27:26.368738 [info ] [Thread-1 (]: 5 of 10 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 4.43s]
[0m13:27:26.370453 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_fraud
[0m13:27:26.371780 [debug] [Thread-1 (]: Began running node model.final_project.suggest_merchant_acc
[0m13:27:26.372884 [info ] [Thread-1 (]: 8 of 10 START sql table model final_project.suggest_merchant_acc ............... [RUN]
[0m13:27:26.374372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.suggest_merchant_acc)
[0m13:27:26.375627 [debug] [Thread-1 (]: Began compiling node model.final_project.suggest_merchant_acc
[0m13:27:26.379690 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.suggest_merchant_acc"
[0m13:27:26.388940 [debug] [Thread-1 (]: Timing info for model.final_project.suggest_merchant_acc (compile): 13:27:26.377035 => 13:27:26.388548
[0m13:27:26.390264 [debug] [Thread-1 (]: Began executing node model.final_project.suggest_merchant_acc
[0m13:27:26.393802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:26.897008 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m13:27:26.911931 [debug] [Thread-3 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m13:27:27.187835 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.suggest_merchant_acc"
[0m13:27:27.204505 [debug] [Thread-1 (]: On model.final_project.suggest_merchant_acc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.suggest_merchant_acc"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`suggest_merchant_acc`
      
    
    

    OPTIONS()
    as (
      

SELECT nameDest, count (*) AS trx
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
WHERE isFraud=0 
GROUP BY nameDest
ORDER BY trx DESC 
LIMIT 100
    );
  
[0m13:27:27.578408 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:039950fa-8a11-4903-aab9-ff8aeda7f4fa&page=queryresults
[0m13:27:27.868831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:dab0ed83-8360-473b-9dd9-b221d33be2e0&page=queryresults
[0m13:27:28.349845 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 13:27:21.964180 => 13:27:28.349493
[0m13:27:28.352606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4affac0>]}
[0m13:27:28.354866 [info ] [Thread-2 (]: 4 of 10 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 267.0 MiB processed)[0m in 6.42s]
[0m13:27:28.357048 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m13:27:28.358908 [debug] [Thread-2 (]: Began running node model.final_project.trx_victim_after_fraud
[0m13:27:28.360649 [info ] [Thread-2 (]: 9 of 10 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m13:27:28.362249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_after_fraud)
[0m13:27:28.364439 [debug] [Thread-2 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m13:27:28.370009 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m13:27:28.385435 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 13:27:28.366410 => 13:27:28.384919
[0m13:27:28.386974 [debug] [Thread-2 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m13:27:28.391763 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:29.238928 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m13:27:29.254270 [debug] [Thread-2 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m13:27:29.929067 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:6ace24a8-d119-472e-9b54-bfaf2b9959ff&page=queryresults
[0m13:27:30.434113 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 13:27:26.150332 => 13:27:30.433700
[0m13:27:30.438506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51e6d40>]}
[0m13:27:30.441453 [info ] [Thread-3 (]: 7 of 10 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 4.32s]
[0m13:27:30.443963 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m13:27:30.446242 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m13:27:30.448062 [info ] [Thread-3 (]: 10 of 10 START sql table model final_project.trx_victim_before_fraud ........... [RUN]
[0m13:27:30.450086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.trx_victim_before_fraud)
[0m13:27:30.451641 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m13:27:30.456391 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m13:27:30.471483 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 13:27:30.452996 => 13:27:30.470945
[0m13:27:30.473157 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m13:27:30.477318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:31.310808 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m13:27:31.323852 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m13:27:31.989534 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:ad66988b-952b-4fc9-92c8-dcdb0d19eaa3&page=queryresults
[0m13:27:32.505531 [debug] [Thread-1 (]: Timing info for model.final_project.suggest_merchant_acc (execute): 13:27:26.391121 => 13:27:32.504998
[0m13:27:32.508552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab51dda80>]}
[0m13:27:32.510921 [info ] [Thread-1 (]: 8 of 10 OK created sql table model final_project.suggest_merchant_acc .......... [[32mCREATE TABLE (100.0 rows, 124.3 MiB processed)[0m in 6.13s]
[0m13:27:32.513612 [debug] [Thread-1 (]: Finished running node model.final_project.suggest_merchant_acc
[0m13:27:32.849047 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 13:27:28.388131 => 13:27:32.848867
[0m13:27:32.851176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab49ac7f0>]}
[0m13:27:32.853072 [info ] [Thread-2 (]: 9 of 10 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.49s]
[0m13:27:32.855378 [debug] [Thread-2 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m13:27:35.157679 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 13:27:30.474355 => 13:27:35.157157
[0m13:27:35.161053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f68718d-33c4-4eec-9ab0-1e7f1175529d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab4ae2860>]}
[0m13:27:35.163367 [info ] [Thread-3 (]: 10 of 10 OK created sql table model final_project.trx_victim_before_fraud ...... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.71s]
[0m13:27:35.165666 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m13:27:35.169258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:35.170887 [debug] [MainThread]: Connection 'model.final_project.suggest_merchant_acc' was properly closed.
[0m13:27:35.172417 [debug] [MainThread]: Connection 'model.final_project.trx_victim_after_fraud' was properly closed.
[0m13:27:35.173877 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m13:27:35.175448 [info ] [MainThread]: 
[0m13:27:35.176830 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 26.36 seconds (26.36s).
[0m13:27:35.180659 [debug] [MainThread]: Command end result
[0m13:27:35.217266 [info ] [MainThread]: 
[0m13:27:35.219098 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:35.220749 [info ] [MainThread]: 
[0m13:27:35.222521 [error] [MainThread]:   Database Error in model perpet_received_nonfraud (models/additional/perpet_received_nonfraud.sql)
  Syntax error: Expected ")" but got ";" at [40:25]
  compiled Code at target/run/final_project/models/additional/perpet_received_nonfraud.sql
[0m13:27:35.224069 [info ] [MainThread]: 
[0m13:27:35.225478 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m13:27:35.227337 [debug] [MainThread]: Command `dbt run` failed at 13:27:35.227157 after 50.94 seconds
[0m13:27:35.228668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcacefeeb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaac757be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaac755e10>]}
[0m13:27:35.230056 [debug] [MainThread]: Flushing usage events
[0m13:28:18.678872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b3be2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b152ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b152e9b0>]}


============================== 13:28:18.693227 | 7c78cb25-9646-4f88-bee6-4da3ef1a3209 ==============================
[0m13:28:18.693227 [info ] [MainThread]: Running with dbt=1.6.6
[0m13:28:18.698019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:29.607612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b152e9e0>]}
[0m13:28:29.641278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b30f5e70>]}
[0m13:28:29.655303 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m13:28:29.710569 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m13:28:32.201661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:32.202989 [debug] [MainThread]: Partial parsing: updated file: final_project://models/additional/perpet_received_nonfraud.sql
[0m13:28:32.249411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m13:28:32.259748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199c940d0>]}
[0m13:28:32.301441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199deb550>]}
[0m13:28:32.303058 [info ] [MainThread]: Found 10 models, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m13:28:32.304615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199c49090>]}
[0m13:28:32.308293 [info ] [MainThread]: 
[0m13:28:32.310655 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:32.313722 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m13:28:32.315303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:34.247427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m13:28:34.249652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:35.027524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199dea3b0>]}
[0m13:28:35.030479 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m13:28:35.032407 [info ] [MainThread]: 
[0m13:28:35.038142 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m13:28:35.038780 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m13:28:35.040372 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m13:28:35.042063 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m13:28:35.043886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m13:28:35.046150 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m13:28:35.047907 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m13:28:35.049495 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m13:28:35.060634 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m13:28:35.064558 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m13:28:35.072663 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 13:28:35.051153 => 13:28:35.072014
[0m13:28:35.073551 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 13:28:35.062108 => 13:28:35.073193
[0m13:28:35.075001 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m13:28:35.076578 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m13:28:35.090395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:35.093226 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:35.991712 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m13:28:36.005019 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m13:28:36.009752 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m13:28:36.019831 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m13:28:36.648791 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2e701fc1-4606-4c0a-ac2f-1d605a635f4f&page=queryresults
[0m13:28:36.710697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f34517da-02d4-4ed2-aef9-3421ca716eab&page=queryresults
[0m13:28:39.222113 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 13:28:35.091340 => 13:28:39.221930
[0m13:28:39.224393 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f719938af20>]}
[0m13:28:39.226241 [info ] [Thread-2 (]: 2 of 10 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.18s]
[0m13:28:39.228219 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m13:28:45.701694 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 13:28:35.077924 => 13:28:45.701396
[0m13:28:45.703982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199de8160>]}
[0m13:28:45.706094 [info ] [Thread-1 (]: 1 of 10 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 10.66s]
[0m13:28:45.708073 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m13:28:45.711074 [debug] [Thread-3 (]: Began running node model.final_project.amount_categorizing
[0m13:28:45.711861 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m13:28:45.712379 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_fraud
[0m13:28:45.713859 [info ] [Thread-3 (]: 3 of 10 START sql view model final_project.amount_categorizing ................. [RUN]
[0m13:28:45.715767 [info ] [Thread-2 (]: 4 of 10 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m13:28:45.718276 [info ] [Thread-1 (]: 5 of 10 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m13:28:45.720562 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.amount_categorizing'
[0m13:28:45.722334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.fraud_transaction_ofAll)
[0m13:28:45.723809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_fraud)
[0m13:28:45.725197 [debug] [Thread-3 (]: Began compiling node model.final_project.amount_categorizing
[0m13:28:45.726903 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m13:28:45.728375 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_fraud
[0m13:28:45.733763 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.amount_categorizing"
[0m13:28:45.739017 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m13:28:45.742972 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m13:28:45.752964 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 13:28:45.735285 => 13:28:45.752254
[0m13:28:45.755132 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (compile): 13:28:45.740417 => 13:28:45.754553
[0m13:28:45.756725 [debug] [Thread-3 (]: Timing info for model.final_project.amount_categorizing (compile): 13:28:45.729586 => 13:28:45.756001
[0m13:28:45.757418 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m13:28:45.758930 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_fraud
[0m13:28:45.760483 [debug] [Thread-3 (]: Began executing node model.final_project.amount_categorizing
[0m13:28:45.765293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:45.770352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:45.800056 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.amount_categorizing"
[0m13:28:45.813139 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:45.814428 [debug] [Thread-3 (]: On model.final_project.amount_categorizing: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.amount_categorizing"} */


  create or replace view `eternal-channel-400514`.`final_project`.`amount_categorizing`
  OPTIONS()
  as SELECT
  type,
  CASE
    WHEN amount <= 200000 THEN '0-200K'
    WHEN amount > 200000 AND amount <= 400000 THEN '200K-400K'
    WHEN amount > 400000 AND amount <= 600000 THEN '400K-600K'
    WHEN amount > 600000 AND amount <= 800000 THEN '600K-800K'
    WHEN amount > 800000 AND amount <= 1000000 THEN '800K-1,000K'
    WHEN amount > 1000000 THEN 'More than 1,000K'
  END AS amount_range,
  COUNT(*) AS transaction_count, 
  SUM(amount) AS total_amount
FROM
  `eternal-channel-400514`.`final_project`.`fill_transactionValid`
GROUP BY
  type,
  amount_range
ORDER BY amount_range;


[0m13:28:46.761185 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m13:28:46.763823 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m13:28:46.769891 [debug] [Thread-2 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m13:28:46.773321 [debug] [Thread-1 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m13:28:46.906733 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1bf6297d-56b5-46d6-b22d-499c1cc12abb&page=queryresults
[0m13:28:47.367915 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:74cdea7c-d70f-467b-b85c-b857369dd3ed&page=queryresults
[0m13:28:47.406477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:3d7d54d5-e569-405b-8649-440bbe223058&page=queryresults
[0m13:28:47.688727 [debug] [Thread-3 (]: Timing info for model.final_project.amount_categorizing (execute): 13:28:45.771745 => 13:28:47.688527
[0m13:28:47.690894 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199404d30>]}
[0m13:28:47.692853 [info ] [Thread-3 (]: 3 of 10 OK created sql view model final_project.amount_categorizing ............ [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m13:28:47.694616 [debug] [Thread-3 (]: Finished running node model.final_project.amount_categorizing
[0m13:28:47.696131 [debug] [Thread-3 (]: Began running node model.final_project.perpet_received_nonfraud
[0m13:28:47.698007 [info ] [Thread-3 (]: 6 of 10 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m13:28:47.702356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.amount_categorizing, now model.final_project.perpet_received_nonfraud)
[0m13:28:47.704458 [debug] [Thread-3 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m13:28:47.709008 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m13:28:47.722247 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 13:28:47.705376 => 13:28:47.721650
[0m13:28:47.723769 [debug] [Thread-3 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m13:28:47.728060 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:48.527610 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m13:28:48.545883 [debug] [Thread-3 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m13:28:49.182264 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:a26f3b14-80c8-422a-88c6-063e03ffeaa9&page=queryresults
[0m13:28:50.310064 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_fraud (execute): 13:28:45.767036 => 13:28:50.309790
[0m13:28:50.312591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199c96320>]}
[0m13:28:50.314504 [info ] [Thread-1 (]: 5 of 10 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 4.59s]
[0m13:28:50.318105 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_fraud
[0m13:28:50.321144 [debug] [Thread-1 (]: Began running node model.final_project.perpet_send_nonfraud
[0m13:28:50.323168 [info ] [Thread-1 (]: 7 of 10 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m13:28:50.324938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.perpet_send_nonfraud)
[0m13:28:50.326591 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m13:28:50.331553 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m13:28:50.345479 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 13:28:50.328049 => 13:28:50.344968
[0m13:28:50.347064 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m13:28:50.351933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:51.192614 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m13:28:51.221511 [debug] [Thread-1 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m13:28:51.835355 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:b932f9cd-8e8d-4cb1-8754-9cc1a2920e58&page=queryresults
[0m13:28:52.313576 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 13:28:45.761735 => 13:28:52.311786
[0m13:28:52.316049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199404790>]}
[0m13:28:52.318652 [info ] [Thread-2 (]: 4 of 10 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 267.0 MiB processed)[0m in 6.59s]
[0m13:28:52.326168 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m13:28:52.328133 [debug] [Thread-2 (]: Began running node model.final_project.suggest_merchant_acc
[0m13:28:52.330703 [info ] [Thread-2 (]: 8 of 10 START sql table model final_project.suggest_merchant_acc ............... [RUN]
[0m13:28:52.334264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.suggest_merchant_acc)
[0m13:28:52.337750 [debug] [Thread-2 (]: Began compiling node model.final_project.suggest_merchant_acc
[0m13:28:52.342202 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.suggest_merchant_acc"
[0m13:28:52.356557 [debug] [Thread-2 (]: Timing info for model.final_project.suggest_merchant_acc (compile): 13:28:52.339052 => 13:28:52.355898
[0m13:28:52.358327 [debug] [Thread-2 (]: Began executing node model.final_project.suggest_merchant_acc
[0m13:28:52.374503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:28:52.592120 [debug] [Thread-3 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 13:28:47.724980 => 13:28:52.591912
[0m13:28:52.594585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199404b20>]}
[0m13:28:52.596799 [info ] [Thread-3 (]: 6 of 10 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 4.89s]
[0m13:28:52.603346 [debug] [Thread-3 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m13:28:52.608429 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_after_fraud
[0m13:28:52.612465 [info ] [Thread-3 (]: 9 of 10 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m13:28:52.618846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_after_fraud)
[0m13:28:52.621248 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m13:28:52.628092 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m13:28:52.642267 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 13:28:52.622857 => 13:28:52.641603
[0m13:28:52.644188 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m13:28:52.651630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:28:53.182616 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.suggest_merchant_acc"
[0m13:28:53.197215 [debug] [Thread-2 (]: On model.final_project.suggest_merchant_acc: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.suggest_merchant_acc"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`suggest_merchant_acc`
      
    
    

    OPTIONS()
    as (
      

SELECT nameDest, count (*) AS trx
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
WHERE isFraud=0 
GROUP BY nameDest
ORDER BY trx DESC 
LIMIT 100
    );
  
[0m13:28:53.359560 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m13:28:53.373729 [debug] [Thread-3 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m13:28:53.889491 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:eae9a609-a60f-43d5-9bcb-e56b1308f3ba&page=queryresults
[0m13:28:54.003638 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:10b8f16f-35b1-4454-a23c-6a0ba948e9b6&page=queryresults
[0m13:28:55.072344 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 13:28:50.348519 => 13:28:55.072083
[0m13:28:55.074401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f719937e260>]}
[0m13:28:55.076666 [info ] [Thread-1 (]: 7 of 10 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 4.75s]
[0m13:28:55.079179 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m13:28:55.080664 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_before_fraud
[0m13:28:55.082117 [info ] [Thread-1 (]: 10 of 10 START sql table model final_project.trx_victim_before_fraud ........... [RUN]
[0m13:28:55.086580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.trx_victim_before_fraud)
[0m13:28:55.088159 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m13:28:55.092243 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m13:28:55.105998 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 13:28:55.089437 => 13:28:55.105613
[0m13:28:55.107457 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m13:28:55.110425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:56.344924 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m13:28:56.367059 [debug] [Thread-1 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m13:28:56.988331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:8c21972b-b615-4b90-a3d4-13f1e1b11127&page=queryresults
[0m13:28:57.167751 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 13:28:52.645869 => 13:28:57.167369
[0m13:28:57.170657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199335900>]}
[0m13:28:57.172327 [info ] [Thread-3 (]: 9 of 10 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.56s]
[0m13:28:57.174280 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m13:28:58.405427 [debug] [Thread-2 (]: Timing info for model.final_project.suggest_merchant_acc (execute): 13:28:52.359460 => 13:28:58.404654
[0m13:28:58.409949 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71993d5450>]}
[0m13:28:58.413802 [info ] [Thread-2 (]: 8 of 10 OK created sql table model final_project.suggest_merchant_acc .......... [[32mCREATE TABLE (100.0 rows, 124.3 MiB processed)[0m in 6.08s]
[0m13:28:58.418811 [debug] [Thread-2 (]: Finished running node model.final_project.suggest_merchant_acc
[0m13:29:00.221033 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 13:28:55.108518 => 13:29:00.220789
[0m13:29:00.223695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c78cb25-9646-4f88-bee6-4da3ef1a3209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71982a06d0>]}
[0m13:29:00.225734 [info ] [Thread-1 (]: 10 of 10 OK created sql table model final_project.trx_victim_before_fraud ...... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 5.14s]
[0m13:29:00.227610 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m13:29:00.231320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:00.232910 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m13:29:00.234491 [debug] [MainThread]: Connection 'model.final_project.suggest_merchant_acc' was properly closed.
[0m13:29:00.235780 [debug] [MainThread]: Connection 'model.final_project.trx_victim_after_fraud' was properly closed.
[0m13:29:00.237167 [info ] [MainThread]: 
[0m13:29:00.238901 [info ] [MainThread]: Finished running 9 table models, 1 view model in 0 hours 0 minutes and 27.93 seconds (27.93s).
[0m13:29:00.242071 [debug] [MainThread]: Command end result
[0m13:29:00.276201 [info ] [MainThread]: 
[0m13:29:00.278316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:00.279942 [info ] [MainThread]: 
[0m13:29:00.281758 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:29:00.284461 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:00.284266 after 41.64 seconds
[0m13:29:00.286073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b3be2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7199355390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71993d5450>]}
[0m13:29:00.287545 [debug] [MainThread]: Flushing usage events
[0m00:23:46.746440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12752eab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1272d2ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1272d2e9b0>]}


============================== 00:23:46.765601 | 3df22f73-73d0-4c97-a809-52523e94d716 ==============================
[0m00:23:46.765601 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:23:46.766845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:04.565203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1272d2e9e0>]}
[0m00:24:04.580850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1274859e70>]}
[0m00:24:04.602898 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m00:24:04.656611 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:24:08.242466 [debug] [MainThread]: Partial parsing enabled: 7 files deleted, 7 files added, 2 files changed.
[0m00:24:08.243772 [debug] [MainThread]: Partial parsing: added file: final_project://models/perpet_received_nonfraud.sql
[0m00:24:08.244893 [debug] [MainThread]: Partial parsing: added file: final_project://models/perpet_received_fraud.sql
[0m00:24:08.245712 [debug] [MainThread]: Partial parsing: added file: final_project://models/perpet_send_nonfraud.sql
[0m00:24:08.246508 [debug] [MainThread]: Partial parsing: added file: final_project://models/trx_victim_after_fraud.sql
[0m00:24:08.247426 [debug] [MainThread]: Partial parsing: added file: final_project://models/customer_status.sql
[0m00:24:08.248418 [debug] [MainThread]: Partial parsing: added file: final_project://models/trx_victim_before_fraud.sql
[0m00:24:08.249296 [debug] [MainThread]: Partial parsing: added file: final_project://models/perpet_trx_status.sql
[0m00:24:08.250473 [debug] [MainThread]: Partial parsing: updated file: final_project://models/schema.yml
[0m00:24:08.251193 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/perpet_received_fraud.sql
[0m00:24:08.251892 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/perpet_received_nonfraud.sql
[0m00:24:08.252579 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/suggest_merchant_acc.sql
[0m00:24:08.253260 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/perpet_send_nonfraud.sql
[0m00:24:08.254069 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/trx_victim_before_fraud.sql
[0m00:24:08.254799 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/trx_victim_after_fraud.sql
[0m00:24:08.255459 [debug] [MainThread]: Partial parsing: deleted file: final_project://models/additional/amount_categorizing.sql
[0m00:24:08.256220 [debug] [MainThread]: Partial parsing: updated file: final_project://models/fraud_transaction_ofAll.sql
[0m00:24:08.466754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m00:24:08.476936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125ab2d8a0>]}
[0m00:24:08.541438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b57b460>]}
[0m00:24:08.543066 [info ] [MainThread]: Found 10 models, 22 tests, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m00:24:08.544807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b57b430>]}
[0m00:24:08.548776 [info ] [MainThread]: 
[0m00:24:08.551360 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:08.554149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m00:24:08.555674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:11.165036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m00:24:11.166599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:12.027286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b57a5c0>]}
[0m00:24:12.029758 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m00:24:12.031351 [info ] [MainThread]: 
[0m00:24:12.037297 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m00:24:12.038196 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m00:24:12.039959 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m00:24:12.041870 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m00:24:12.043648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m00:24:12.045677 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m00:24:12.047241 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m00:24:12.049153 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m00:24:12.069127 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m00:24:12.073486 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m00:24:12.081759 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 00:24:12.050497 => 00:24:12.081098
[0m00:24:12.083555 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m00:24:12.095105 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 00:24:12.070212 => 00:24:12.094584
[0m00:24:12.112704 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m00:24:12.131705 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m00:24:12.135311 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m00:24:12.141909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:12.144439 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m00:24:12.145584 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:24:12.151561 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m00:24:13.475517 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4620622b-4122-40aa-85d1-224803631411&page=queryresults
[0m00:24:13.718749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:3fe67921-5ca4-4c0c-9af7-b4f8056603a1&page=queryresults
[0m00:24:16.113462 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 00:24:12.132116 => 00:24:16.113199
[0m00:24:16.115648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125a9e0670>]}
[0m00:24:16.117454 [info ] [Thread-2 (]: 2 of 10 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.07s]
[0m00:24:16.120097 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m00:24:23.720609 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 00:24:12.085422 => 00:24:23.720374
[0m00:24:23.723078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b579e40>]}
[0m00:24:23.724948 [info ] [Thread-1 (]: 1 of 10 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 11.68s]
[0m00:24:23.726955 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m00:24:23.729614 [debug] [Thread-3 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m00:24:23.730326 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m00:24:23.730832 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m00:24:23.732106 [info ] [Thread-3 (]: 3 of 10 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m00:24:23.734037 [info ] [Thread-2 (]: 4 of 10 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m00:24:23.735730 [info ] [Thread-1 (]: 5 of 10 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m00:24:23.737673 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction_ofAll'
[0m00:24:23.739594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.perpet_received_fraud)
[0m00:24:23.741250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_nonfraud)
[0m00:24:23.742864 [debug] [Thread-3 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m00:24:23.744425 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_fraud
[0m00:24:23.745708 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m00:24:23.750323 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m00:24:23.755723 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m00:24:23.762805 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m00:24:23.772843 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 00:24:23.747006 => 00:24:23.772065
[0m00:24:23.773736 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 00:24:23.757240 => 00:24:23.773399
[0m00:24:23.776658 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m00:24:23.775061 [debug] [Thread-3 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m00:24:23.785105 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (compile): 00:24:23.752311 => 00:24:23.784145
[0m00:24:23.787498 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m00:24:23.792043 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m00:24:23.793840 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_fraud
[0m00:24:23.801031 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m00:24:23.804413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:23.809276 [debug] [Thread-1 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m00:24:23.811122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:24:23.817563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:24:23.822079 [debug] [Thread-3 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime, amount, isFlaggedFraud
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m00:24:23.823818 [debug] [Thread-2 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m00:24:25.069694 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:e2706567-dac8-4377-bd13-3618b6beb866&page=queryresults
[0m00:24:25.072770 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:a451e35a-6bcf-46ad-addb-aaf2821843a4&page=queryresults
[0m00:24:25.074542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:89ff4531-8b22-4fec-b0bc-307eae08c10c&page=queryresults
[0m00:24:28.196135 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (execute): 00:24:23.797074 => 00:24:28.195823
[0m00:24:28.198501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125aa42920>]}
[0m00:24:28.200459 [info ] [Thread-2 (]: 4 of 10 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 4.46s]
[0m00:24:28.202898 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m00:24:28.205206 [debug] [Thread-2 (]: Began running node model.final_project.perpet_send_nonfraud
[0m00:24:28.207407 [info ] [Thread-2 (]: 6 of 10 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m00:24:28.209583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.perpet_send_nonfraud)
[0m00:24:28.211063 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m00:24:28.219097 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m00:24:28.228654 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 00:24:28.212355 => 00:24:28.228000
[0m00:24:28.230379 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m00:24:28.236948 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m00:24:28.247939 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:24:28.249914 [debug] [Thread-2 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m00:24:28.577656 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 00:24:23.778657 => 00:24:28.577342
[0m00:24:28.579709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125aa42530>]}
[0m00:24:28.581906 [info ] [Thread-1 (]: 5 of 10 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 4.84s]
[0m00:24:28.586585 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m00:24:28.589471 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m00:24:28.591739 [info ] [Thread-1 (]: 7 of 10 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m00:24:28.594732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_after_fraud)
[0m00:24:28.596552 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m00:24:28.609046 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m00:24:28.619590 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 00:24:28.597905 => 00:24:28.618887
[0m00:24:28.623514 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m00:24:28.633401 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m00:24:28.645162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:28.647393 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m00:24:29.279076 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:787bbce7-d9b1-401d-ba05-af4301ca0a91&page=queryresults
[0m00:24:29.660105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:a60d163c-cc73-4189-887c-c19445714bad&page=queryresults
[0m00:24:30.763764 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 00:24:23.788842 => 00:24:30.763433
[0m00:24:30.766447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125aa423b0>]}
[0m00:24:30.770893 [info ] [Thread-3 (]: 3 of 10 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 364.1 MiB processed)[0m in 7.03s]
[0m00:24:30.773301 [debug] [Thread-3 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m00:24:30.775175 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m00:24:30.776947 [info ] [Thread-3 (]: 8 of 10 START sql table model final_project.trx_victim_before_fraud ............ [RUN]
[0m00:24:30.779039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_before_fraud)
[0m00:24:30.780359 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m00:24:30.786077 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m00:24:30.795026 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 00:24:30.781301 => 00:24:30.794420
[0m00:24:30.796679 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m00:24:30.802124 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m00:24:30.810993 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:24:30.812438 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m00:24:31.878531 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:608c9a6c-77c9-410f-9a92-1d8c796db0cf&page=queryresults
[0m00:24:32.481226 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 00:24:28.231732 => 00:24:32.480882
[0m00:24:32.484313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125aa69ff0>]}
[0m00:24:32.486849 [info ] [Thread-2 (]: 6 of 10 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 4.27s]
[0m00:24:32.490178 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m00:24:32.492194 [debug] [Thread-2 (]: Began running node model.final_project.perpet_trx_status
[0m00:24:32.494384 [info ] [Thread-2 (]: 9 of 10 START sql table model final_project.perpet_trx_status .................. [RUN]
[0m00:24:32.496672 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.perpet_trx_status)
[0m00:24:32.498197 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_trx_status
[0m00:24:32.504378 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_trx_status"
[0m00:24:32.513029 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_trx_status (compile): 00:24:32.499385 => 00:24:32.512423
[0m00:24:32.514733 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_trx_status
[0m00:24:32.520963 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_trx_status"
[0m00:24:32.529735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:24:32.531589 [debug] [Thread-2 (]: On model.final_project.perpet_trx_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_trx_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_trx_status`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fraud_transaction`
),

MultipleTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
)

SELECT 
    f.nameDest,
    CASE 
        WHEN f.nameDest IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveMultipleTrx'
        WHEN f.nameDest NOT IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveOneTrx'
    END AS TransactionCategory
FROM 
    FraudulentTransactions f
    );
  
[0m00:24:32.552479 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 00:24:28.626936 => 00:24:32.552293
[0m00:24:32.554058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125a9e23e0>]}
[0m00:24:32.555284 [info ] [Thread-1 (]: 7 of 10 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 3.96s]
[0m00:24:32.556719 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m00:24:32.558126 [debug] [Thread-1 (]: Began running node model.final_project.customer_status
[0m00:24:32.559518 [info ] [Thread-1 (]: 10 of 10 START sql table model final_project.customer_status ................... [RUN]
[0m00:24:32.561210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_after_fraud, now model.final_project.customer_status)
[0m00:24:32.562546 [debug] [Thread-1 (]: Began compiling node model.final_project.customer_status
[0m00:24:32.567063 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.customer_status"
[0m00:24:32.574002 [debug] [Thread-1 (]: Timing info for model.final_project.customer_status (compile): 00:24:32.563395 => 00:24:32.573532
[0m00:24:32.575306 [debug] [Thread-1 (]: Began executing node model.final_project.customer_status
[0m00:24:32.581366 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.customer_status"
[0m00:24:32.590568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:32.592384 [debug] [Thread-1 (]: On model.final_project.customer_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.customer_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`customer_status`
      
    
    

    OPTIONS()
    as (
      

WITH UniqueCustomers AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),
FraudulentActivity AS (
    SELECT DISTINCT nameDest AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
SuspectActivity AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
),
CustomerFraudStatus AS (
    SELECT 
        uc.CustomerID,
        CASE WHEN fa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isFraudAccount,
        CASE WHEN sa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isSuspectAccount
    FROM 
        UniqueCustomers uc
    LEFT JOIN 
        FraudulentActivity fa ON uc.CustomerID = fa.CustomerID
    LEFT JOIN 
        SuspectActivity sa ON uc.CustomerID = sa.CustomerID
)

SELECT *,
  CASE 
    WHEN isFraudAccount = 1 AND isSuspectAccount=0 THEN 'Fraudsters'
    WHEN isFraudAccount = 0 AND isSuspectAccount=1 THEN 'FraudSuspects'
    WHEN isFraudAccount = 0 AND isSuspectAccount = 0 THEN 'NotAffiliated'
    WHEN isFraudAccount = 1 AND isSuspectAccount=1 THEN 'Fraudsters'
  END AS CustomerStatus 
FROM CustomerFraudStatus
    );
  
[0m00:24:33.560507 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c8cd800c-1b0f-4085-9b4e-dbab2893def4&page=queryresults
[0m00:24:33.724413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:67e93ab0-0487-4152-8bfa-833dff693a64&page=queryresults
[0m00:24:34.345035 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: nameDest at [16:21]')
[0m00:24:34.782430 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 00:24:30.798006 => 00:24:34.781862
[0m00:24:34.785420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12580e5150>]}
[0m00:24:34.787705 [info ] [Thread-3 (]: 8 of 10 OK created sql table model final_project.trx_victim_before_fraud ....... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.01s]
[0m00:24:34.789664 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m00:24:35.164826 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:81b19c1e-afcf-40a7-9fae-31611ed2fb05&page=queryresults
[0m00:24:35.980419 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:81b19c1e-afcf-40a7-9fae-31611ed2fb05&page=queryresults
[0m00:24:35.982510 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_trx_status (execute): 00:24:32.516003 => 00:24:35.982132
[0m00:24:36.186376 [debug] [Thread-2 (]: Database Error in model perpet_trx_status (models/perpet_trx_status.sql)
  Unrecognized name: nameDest at [16:21]
  compiled Code at target/run/final_project/models/perpet_trx_status.sql
[0m00:24:36.188227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125aa7e530>]}
[0m00:24:36.189975 [error] [Thread-2 (]: 9 of 10 ERROR creating sql table model final_project.perpet_trx_status ......... [[31mERROR[0m in 3.69s]
[0m00:24:36.191964 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_trx_status
[0m00:24:45.664553 [debug] [Thread-1 (]: Timing info for model.final_project.customer_status (execute): 00:24:32.576251 => 00:24:45.664124
[0m00:24:45.667964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df22f73-73d0-4c97-a809-52523e94d716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12580e67a0>]}
[0m00:24:45.669923 [info ] [Thread-1 (]: 10 of 10 OK created sql table model final_project.customer_status .............. [[32mCREATE TABLE (9.1m rows, 200.7 MiB processed)[0m in 13.11s]
[0m00:24:45.671757 [debug] [Thread-1 (]: Finished running node model.final_project.customer_status
[0m00:24:45.675571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:45.676922 [debug] [MainThread]: Connection 'model.final_project.customer_status' was properly closed.
[0m00:24:45.677987 [debug] [MainThread]: Connection 'model.final_project.perpet_trx_status' was properly closed.
[0m00:24:45.679118 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m00:24:45.680362 [info ] [MainThread]: 
[0m00:24:45.681463 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 37.13 seconds (37.13s).
[0m00:24:45.685347 [debug] [MainThread]: Command end result
[0m00:24:45.714787 [info ] [MainThread]: 
[0m00:24:45.716672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:24:45.718571 [info ] [MainThread]: 
[0m00:24:45.720353 [error] [MainThread]:   Database Error in model perpet_trx_status (models/perpet_trx_status.sql)
  Unrecognized name: nameDest at [16:21]
  compiled Code at target/run/final_project/models/perpet_trx_status.sql
[0m00:24:45.721855 [info ] [MainThread]: 
[0m00:24:45.723264 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m00:24:45.725025 [debug] [MainThread]: Command `dbt run` failed at 00:24:45.724818 after 59.02 seconds
[0m00:24:45.726224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12752eab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b5b0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125b55bfa0>]}
[0m00:24:45.727704 [debug] [MainThread]: Flushing usage events
[0m00:33:01.708565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fdbeeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fb5369b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fb536950>]}


============================== 00:33:01.724205 | e2db6bbd-bae9-4f86-8160-5251c3d4771d ==============================
[0m00:33:01.724205 [info ] [MainThread]: Running with dbt=1.6.6
[0m00:33:01.732819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:33:17.106487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fb536980>]}
[0m00:33:17.123533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fd13a890>]}
[0m00:33:17.134632 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m00:33:17.162469 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m00:33:21.381179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:21.383101 [debug] [MainThread]: Partial parsing: updated file: final_project://models/perpet_trx_status.sql
[0m00:33:21.506629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m00:33:21.535956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3d440d0>]}
[0m00:33:21.634665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3c7fac0>]}
[0m00:33:21.636453 [info ] [MainThread]: Found 10 models, 22 tests, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m00:33:21.642375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3c7fa90>]}
[0m00:33:21.650913 [info ] [MainThread]: 
[0m00:33:21.653236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:33:21.665173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m00:33:21.667064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:25.386653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m00:33:25.389117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:26.456826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3c7c370>]}
[0m00:33:26.459720 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m00:33:26.468647 [info ] [MainThread]: 
[0m00:33:26.545208 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m00:33:26.546297 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m00:33:26.547847 [info ] [Thread-1 (]: 1 of 10 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m00:33:26.555354 [info ] [Thread-2 (]: 2 of 10 START sql table model final_project.fraud_transaction .................. [RUN]
[0m00:33:26.562370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m00:33:26.565586 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m00:33:26.567443 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m00:33:26.569219 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m00:33:26.586872 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m00:33:26.607677 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m00:33:26.617510 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 00:33:26.570412 => 00:33:26.616792
[0m00:33:26.620205 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m00:33:26.640730 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 00:33:26.581821 => 00:33:26.639987
[0m00:33:26.669276 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m00:33:26.679863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:26.695588 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:33:27.755016 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m00:33:27.758455 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m00:33:27.773087 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m00:33:27.788465 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m00:33:28.500706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c942e801-408f-40f9-8f65-1ca3679eba28&page=queryresults
[0m00:33:28.505416 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:c29cee07-848e-4fe7-99d0-7d540c5d7ab9&page=queryresults
[0m00:33:31.140123 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 00:33:26.672501 => 00:33:31.139821
[0m00:33:31.142464 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3c7dd80>]}
[0m00:33:31.145253 [info ] [Thread-2 (]: 2 of 10 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.58s]
[0m00:33:31.149076 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m00:33:37.165428 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 00:33:26.621446 => 00:33:37.165048
[0m00:33:37.168266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e33c89d0>]}
[0m00:33:37.170221 [info ] [Thread-1 (]: 1 of 10 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 10.61s]
[0m00:33:37.173355 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m00:33:37.176224 [debug] [Thread-3 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m00:33:37.177042 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m00:33:37.177652 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m00:33:37.179155 [info ] [Thread-3 (]: 3 of 10 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m00:33:37.180626 [info ] [Thread-2 (]: 4 of 10 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m00:33:37.182520 [info ] [Thread-1 (]: 5 of 10 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m00:33:37.184324 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction_ofAll'
[0m00:33:37.186116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.perpet_received_fraud)
[0m00:33:37.188238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_nonfraud)
[0m00:33:37.189704 [debug] [Thread-3 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m00:33:37.191228 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_fraud
[0m00:33:37.192628 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m00:33:37.197276 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m00:33:37.201316 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m00:33:37.205607 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m00:33:37.214330 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 00:33:37.193886 => 00:33:37.213512
[0m00:33:37.215574 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (compile): 00:33:37.198747 => 00:33:37.214989
[0m00:33:37.216984 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 00:33:37.202745 => 00:33:37.216636
[0m00:33:37.217893 [debug] [Thread-3 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m00:33:37.219411 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_fraud
[0m00:33:37.221670 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m00:33:37.229677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:33:37.235023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:33:37.238551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:38.241166 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m00:33:38.248944 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m00:33:38.254682 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m00:33:38.257955 [debug] [Thread-1 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m00:33:38.262581 [debug] [Thread-3 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime, amount, isFlaggedFraud
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m00:33:38.264161 [debug] [Thread-2 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m00:33:38.927937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2ca29101-04e1-43f9-9d70-47f878048b85&page=queryresults
[0m00:33:38.933862 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f203c2aa-81b5-4f82-b4c7-4e14252f3b56&page=queryresults
[0m00:33:38.947898 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d8d059cf-d608-40bd-bcfc-8661f31ad50f&page=queryresults
[0m00:33:42.196114 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (execute): 00:33:37.231749 => 00:33:42.195886
[0m00:33:42.198526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e808e0>]}
[0m00:33:42.200579 [info ] [Thread-2 (]: 4 of 10 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 5.01s]
[0m00:33:42.202368 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m00:33:42.204175 [debug] [Thread-2 (]: Began running node model.final_project.perpet_send_nonfraud
[0m00:33:42.206235 [info ] [Thread-2 (]: 6 of 10 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m00:33:42.208204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.perpet_send_nonfraud)
[0m00:33:42.210002 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m00:33:42.214916 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m00:33:42.224211 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 00:33:42.211774 => 00:33:42.223738
[0m00:33:42.225454 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m00:33:42.230311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:33:42.713207 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 00:33:37.236413 => 00:33:42.712986
[0m00:33:42.715179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e809a0>]}
[0m00:33:42.716928 [info ] [Thread-1 (]: 5 of 10 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 5.53s]
[0m00:33:42.718830 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m00:33:42.720465 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m00:33:42.722403 [info ] [Thread-1 (]: 7 of 10 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m00:33:42.724261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_after_fraud)
[0m00:33:42.725687 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m00:33:42.730700 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m00:33:42.739566 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 00:33:42.726982 => 00:33:42.739124
[0m00:33:42.741502 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m00:33:42.745534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:42.986641 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m00:33:43.000801 [debug] [Thread-2 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m00:33:43.615635 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m00:33:43.617810 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:fcd5d7ec-7a99-47a7-8f8b-091412bc9223&page=queryresults
[0m00:33:43.633912 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m00:33:43.922210 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 00:33:37.223513 => 00:33:43.922006
[0m00:33:43.924711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e805b0>]}
[0m00:33:43.926864 [info ] [Thread-3 (]: 3 of 10 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 364.1 MiB processed)[0m in 6.74s]
[0m00:33:43.933504 [debug] [Thread-3 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m00:33:43.935539 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m00:33:43.939262 [info ] [Thread-3 (]: 8 of 10 START sql table model final_project.trx_victim_before_fraud ............ [RUN]
[0m00:33:43.942030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_before_fraud)
[0m00:33:43.943860 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m00:33:43.955471 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m00:33:43.973440 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 00:33:43.948198 => 00:33:43.972770
[0m00:33:43.975157 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m00:33:43.984736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:33:44.250392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:f545eb94-9336-4bb4-9f79-9e72f769c198&page=queryresults
[0m00:33:44.765937 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m00:33:44.776636 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m00:33:45.569867 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:7a8f9133-08bd-4756-b7e6-e6a8fd3c052d&page=queryresults
[0m00:33:47.164702 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 00:33:42.742775 => 00:33:47.164387
[0m00:33:47.167378 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 00:33:42.226429 => 00:33:47.167046
[0m00:33:47.169056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e82ec0>]}
[0m00:33:47.170910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e82b90>]}
[0m00:33:47.172625 [info ] [Thread-1 (]: 7 of 10 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.45s]
[0m00:33:47.174377 [info ] [Thread-2 (]: 6 of 10 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 4.96s]
[0m00:33:47.176214 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m00:33:47.178509 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m00:33:47.180424 [debug] [Thread-1 (]: Began running node model.final_project.perpet_trx_status
[0m00:33:47.182245 [debug] [Thread-2 (]: Began running node model.final_project.customer_status
[0m00:33:47.183301 [info ] [Thread-1 (]: 9 of 10 START sql table model final_project.perpet_trx_status .................. [RUN]
[0m00:33:47.184824 [info ] [Thread-2 (]: 10 of 10 START sql table model final_project.customer_status ................... [RUN]
[0m00:33:47.186713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_after_fraud, now model.final_project.perpet_trx_status)
[0m00:33:47.188855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.customer_status)
[0m00:33:47.190438 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_trx_status
[0m00:33:47.191838 [debug] [Thread-2 (]: Began compiling node model.final_project.customer_status
[0m00:33:47.202099 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_trx_status"
[0m00:33:47.207393 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.customer_status"
[0m00:33:47.215464 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (compile): 00:33:47.193253 => 00:33:47.214641
[0m00:33:47.216492 [debug] [Thread-2 (]: Timing info for model.final_project.customer_status (compile): 00:33:47.203265 => 00:33:47.216059
[0m00:33:47.217979 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_trx_status
[0m00:33:47.219544 [debug] [Thread-2 (]: Began executing node model.final_project.customer_status
[0m00:33:47.224144 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_trx_status"
[0m00:33:47.228096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:33:47.238233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:47.239994 [debug] [Thread-1 (]: On model.final_project.perpet_trx_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_trx_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_trx_status`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),

MultipleTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
)

SELECT 
    f.nameDest,
    CASE 
        WHEN f.nameDest IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveMultipleTrx'
        WHEN f.nameDest NOT IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveOneTrx'
    END AS TransactionCategory
FROM 
    FraudulentTransactions f
    );
  
[0m00:33:48.263341 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.customer_status"
[0m00:33:48.277267 [debug] [Thread-2 (]: On model.final_project.customer_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.customer_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`customer_status`
      
    
    

    OPTIONS()
    as (
      

WITH UniqueCustomers AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),
FraudulentActivity AS (
    SELECT DISTINCT nameDest AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
SuspectActivity AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
),
CustomerFraudStatus AS (
    SELECT 
        uc.CustomerID,
        CASE WHEN fa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isFraudAccount,
        CASE WHEN sa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isSuspectAccount
    FROM 
        UniqueCustomers uc
    LEFT JOIN 
        FraudulentActivity fa ON uc.CustomerID = fa.CustomerID
    LEFT JOIN 
        SuspectActivity sa ON uc.CustomerID = sa.CustomerID
)

SELECT *,
  CASE 
    WHEN isFraudAccount = 1 AND isSuspectAccount=0 THEN 'Fraudsters'
    WHEN isFraudAccount = 0 AND isSuspectAccount=1 THEN 'FraudSuspects'
    WHEN isFraudAccount = 0 AND isSuspectAccount = 0 THEN 'NotAffiliated'
    WHEN isFraudAccount = 1 AND isSuspectAccount=1 THEN 'Fraudsters'
  END AS CustomerStatus 
FROM CustomerFraudStatus
    );
  
[0m00:33:48.533053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:5726e5ce-5294-42ee-8279-b3c2f1caceb1&page=queryresults
[0m00:33:48.752632 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 00:33:43.979404 => 00:33:48.752346
[0m00:33:48.754955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e3e80dc0>]}
[0m00:33:48.757134 [info ] [Thread-3 (]: 8 of 10 OK created sql table model final_project.trx_victim_before_fraud ....... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.81s]
[0m00:33:48.759803 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m00:33:48.896974 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:44eca739-5629-4273-9dc6-031bab82d351&page=queryresults
[0m00:33:58.839559 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (execute): 00:33:47.220841 => 00:33:58.839342
[0m00:33:58.841675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e341eda0>]}
[0m00:33:58.843364 [info ] [Thread-1 (]: 9 of 10 OK created sql table model final_project.perpet_trx_status ............. [[32mCREATE TABLE (2.7m rows, 75.7 MiB processed)[0m in 11.66s]
[0m00:33:58.846131 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_trx_status
[0m00:34:00.552152 [debug] [Thread-2 (]: Timing info for model.final_project.customer_status (execute): 00:33:47.225653 => 00:34:00.551508
[0m00:34:00.556732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2db6bbd-bae9-4f86-8160-5251c3d4771d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e341d360>]}
[0m00:34:00.559552 [info ] [Thread-2 (]: 10 of 10 OK created sql table model final_project.customer_status .............. [[32mCREATE TABLE (9.1m rows, 200.7 MiB processed)[0m in 13.37s]
[0m00:34:00.564882 [debug] [Thread-2 (]: Finished running node model.final_project.customer_status
[0m00:34:00.572038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:00.573315 [debug] [MainThread]: Connection 'model.final_project.perpet_trx_status' was properly closed.
[0m00:34:00.574449 [debug] [MainThread]: Connection 'model.final_project.customer_status' was properly closed.
[0m00:34:00.575538 [debug] [MainThread]: Connection 'model.final_project.trx_victim_before_fraud' was properly closed.
[0m00:34:00.576669 [info ] [MainThread]: 
[0m00:34:00.580052 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 38.92 seconds (38.92s).
[0m00:34:00.584162 [debug] [MainThread]: Command end result
[0m00:34:00.640258 [info ] [MainThread]: 
[0m00:34:00.645972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:00.650145 [info ] [MainThread]: 
[0m00:34:00.652052 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m00:34:00.655374 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:00.655009 after 58.98 seconds
[0m00:34:00.657249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fdbeeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fd13a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66e0299d50>]}
[0m00:34:00.659093 [debug] [MainThread]: Flushing usage events
[0m01:35:18.099580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc245f6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2203eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2203eaa0>]}


============================== 01:35:18.112360 | 2f394014-54a4-4d1a-bd30-9d72a39aeeca ==============================
[0m01:35:18.112360 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:35:18.113629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:35:29.473245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2203ead0>]}
[0m01:35:29.497411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc23a233d0>]}
[0m01:35:29.511789 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m01:35:29.564908 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:35:32.196506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:35:32.197735 [debug] [MainThread]: Partial parsing: added file: final_project://models/victim_status_after_fraud.sql
[0m01:35:32.198918 [debug] [MainThread]: Partial parsing: updated file: final_project://models/schema.yml
[0m01:35:32.321067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m01:35:32.331143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a6d9de0>]}
[0m01:35:32.383121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a8b7d00>]}
[0m01:35:32.384753 [info ] [MainThread]: Found 11 models, 24 tests, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m01:35:32.386627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a8b7cd0>]}
[0m01:35:32.392350 [info ] [MainThread]: 
[0m01:35:32.395174 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:32.398589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m01:35:32.400100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:35.840362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m01:35:35.842172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:37.013140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a8b45b0>]}
[0m01:35:37.015398 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m01:35:37.016814 [info ] [MainThread]: 
[0m01:35:37.024472 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m01:35:37.025143 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m01:35:37.026470 [info ] [Thread-1 (]: 1 of 11 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m01:35:37.028542 [info ] [Thread-2 (]: 2 of 11 START sql table model final_project.fraud_transaction .................. [RUN]
[0m01:35:37.030723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m01:35:37.033287 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m01:35:37.034973 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m01:35:37.036614 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m01:35:37.047821 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m01:35:37.052479 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m01:35:37.059875 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 01:35:37.037760 => 01:35:37.059343
[0m01:35:37.061519 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m01:35:37.062644 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 01:35:37.049075 => 01:35:37.062218
[0m01:35:37.078900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:37.079998 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m01:35:37.086094 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:35:38.351989 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m01:35:38.354500 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m01:35:38.361744 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m01:35:38.363153 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m01:35:38.968232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4889d69a-bdd7-4c14-a039-6c91446deed4&page=queryresults
[0m01:35:39.042228 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:405662a0-20d5-4e27-a590-abba5a6d89d0&page=queryresults
[0m01:35:41.420302 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 01:35:37.083432 => 01:35:41.419946
[0m01:35:41.427182 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a75ab60>]}
[0m01:35:41.433742 [info ] [Thread-2 (]: 2 of 11 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.39s]
[0m01:35:41.439509 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m01:35:49.604049 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 01:35:37.063609 => 01:35:49.603749
[0m01:35:49.606234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a0592a0>]}
[0m01:35:49.608844 [info ] [Thread-1 (]: 1 of 11 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 12.58s]
[0m01:35:49.611147 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m01:35:49.614010 [debug] [Thread-3 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m01:35:49.614723 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m01:35:49.615331 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m01:35:49.616531 [info ] [Thread-3 (]: 3 of 11 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m01:35:49.618201 [info ] [Thread-2 (]: 4 of 11 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m01:35:49.619916 [info ] [Thread-1 (]: 5 of 11 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m01:35:49.621933 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction_ofAll'
[0m01:35:49.624162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.perpet_received_fraud)
[0m01:35:49.626602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_nonfraud)
[0m01:35:49.627966 [debug] [Thread-3 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m01:35:49.629422 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_fraud
[0m01:35:49.631191 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m01:35:49.636203 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m01:35:49.642566 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m01:35:49.649104 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m01:35:49.657113 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 01:35:49.632410 => 01:35:49.656264
[0m01:35:49.659494 [debug] [Thread-3 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m01:35:49.660904 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 01:35:49.644006 => 01:35:49.660467
[0m01:35:49.661737 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (compile): 01:35:49.637661 => 01:35:49.661411
[0m01:35:49.666262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:35:49.667651 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m01:35:49.668795 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_fraud
[0m01:35:49.675660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:49.679829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:50.802015 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m01:35:50.814766 [debug] [Thread-3 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime, amount, isFlaggedFraud
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m01:35:50.816833 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m01:35:50.824368 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m01:35:50.829869 [debug] [Thread-1 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m01:35:50.833072 [debug] [Thread-2 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m01:35:51.514126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:e9ec59eb-5071-4c02-94d4-ca1c6707c975&page=queryresults
[0m01:35:51.562836 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:6a816c82-a74f-462f-88f1-cecf680d6f46&page=queryresults
[0m01:35:52.277148 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:cef6946a-1bb7-4ca3-a046-5955bbda240b&page=queryresults
[0m01:35:54.752233 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (execute): 01:35:49.677137 => 01:35:54.751288
[0m01:35:54.756581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09f39e10>]}
[0m01:35:54.760487 [info ] [Thread-2 (]: 4 of 11 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 5.13s]
[0m01:35:54.765724 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m01:35:54.768132 [debug] [Thread-2 (]: Began running node model.final_project.perpet_send_nonfraud
[0m01:35:54.770725 [info ] [Thread-2 (]: 6 of 11 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m01:35:54.773721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.perpet_send_nonfraud)
[0m01:35:54.776509 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m01:35:54.782628 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m01:35:54.795983 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 01:35:54.778117 => 01:35:54.795314
[0m01:35:54.798889 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m01:35:54.804129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:55.318612 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 01:35:49.672304 => 01:35:55.318336
[0m01:35:55.321161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09f280a0>]}
[0m01:35:55.323199 [info ] [Thread-1 (]: 5 of 11 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 5.70s]
[0m01:35:55.326816 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m01:35:55.330638 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m01:35:55.332599 [info ] [Thread-1 (]: 7 of 11 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m01:35:55.334580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_after_fraud)
[0m01:35:55.336215 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m01:35:55.341607 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m01:35:55.355483 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 01:35:55.337568 => 01:35:55.354993
[0m01:35:55.357160 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m01:35:55.364651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:55.594180 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m01:35:55.602268 [debug] [Thread-2 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m01:35:56.141045 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m01:35:56.151474 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:35:56.302844 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:be0ebdea-152d-43bd-a744-4dadca7b0a17&page=queryresults
[0m01:35:56.874037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:b97ddfd0-beca-4513-a802-f9e45a32b174&page=queryresults
[0m01:35:57.338524 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 01:35:49.662702 => 01:35:57.338180
[0m01:35:57.341058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a0b0280>]}
[0m01:35:57.343181 [info ] [Thread-3 (]: 3 of 11 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 364.1 MiB processed)[0m in 7.72s]
[0m01:35:57.345042 [debug] [Thread-3 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m01:35:57.346858 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m01:35:57.348810 [info ] [Thread-3 (]: 8 of 11 START sql table model final_project.trx_victim_before_fraud ............ [RUN]
[0m01:35:57.350466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_before_fraud)
[0m01:35:57.352136 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m01:35:57.357870 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m01:35:57.370760 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 01:35:57.353493 => 01:35:57.370340
[0m01:35:57.372381 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m01:35:57.376568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:35:58.117891 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m01:35:58.129366 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:35:58.821190 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:22d98409-2d6d-4718-803e-7a59a5b5f00f&page=queryresults
[0m01:35:59.538284 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 01:35:54.801641 => 01:35:59.538098
[0m01:35:59.540513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a086230>]}
[0m01:35:59.543320 [info ] [Thread-2 (]: 6 of 11 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 4.77s]
[0m01:35:59.545690 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m01:35:59.547509 [debug] [Thread-2 (]: Began running node model.final_project.perpet_trx_status
[0m01:35:59.549866 [info ] [Thread-2 (]: 9 of 11 START sql table model final_project.perpet_trx_status .................. [RUN]
[0m01:35:59.552299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.perpet_trx_status)
[0m01:35:59.554063 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_trx_status
[0m01:35:59.563629 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_trx_status"
[0m01:35:59.573388 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_trx_status (compile): 01:35:59.555578 => 01:35:59.572935
[0m01:35:59.575266 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_trx_status
[0m01:35:59.578896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:35:59.802345 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 01:35:55.358895 => 01:35:59.801769
[0m01:35:59.804877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09f8fac0>]}
[0m01:35:59.807054 [info ] [Thread-1 (]: 7 of 11 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.47s]
[0m01:35:59.811714 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m01:35:59.815407 [debug] [Thread-1 (]: Began running node model.final_project.customer_status
[0m01:35:59.817338 [info ] [Thread-1 (]: 10 of 11 START sql table model final_project.customer_status ................... [RUN]
[0m01:35:59.819447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_after_fraud, now model.final_project.customer_status)
[0m01:35:59.821198 [debug] [Thread-1 (]: Began compiling node model.final_project.customer_status
[0m01:35:59.830575 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.customer_status"
[0m01:35:59.840623 [debug] [Thread-1 (]: Timing info for model.final_project.customer_status (compile): 01:35:59.822757 => 01:35:59.839890
[0m01:35:59.844078 [debug] [Thread-1 (]: Began executing node model.final_project.customer_status
[0m01:35:59.850734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:00.577061 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_trx_status"
[0m01:36:00.587847 [debug] [Thread-2 (]: On model.final_project.perpet_trx_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_trx_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_trx_status`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),

MultipleTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
)

SELECT 
    f.nameDest,
    CASE 
        WHEN f.nameDest IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveMultipleTrx'
        WHEN f.nameDest NOT IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveOneTrx'
    END AS TransactionCategory
FROM 
    FraudulentTransactions f
    );
  
[0m01:36:00.687485 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.customer_status"
[0m01:36:00.700527 [debug] [Thread-1 (]: On model.final_project.customer_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.customer_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`customer_status`
      
    
    

    OPTIONS()
    as (
      

WITH UniqueCustomers AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),
FraudulentActivity AS (
    SELECT DISTINCT nameDest AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
SuspectActivity AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
),
CustomerFraudStatus AS (
    SELECT 
        uc.CustomerID,
        CASE WHEN fa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isFraudAccount,
        CASE WHEN sa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isSuspectAccount
    FROM 
        UniqueCustomers uc
    LEFT JOIN 
        FraudulentActivity fa ON uc.CustomerID = fa.CustomerID
    LEFT JOIN 
        SuspectActivity sa ON uc.CustomerID = sa.CustomerID
)

SELECT *,
  CASE 
    WHEN isFraudAccount = 1 AND isSuspectAccount=0 THEN 'Fraudsters'
    WHEN isFraudAccount = 0 AND isSuspectAccount=1 THEN 'FraudSuspects'
    WHEN isFraudAccount = 0 AND isSuspectAccount = 0 THEN 'NotAffiliated'
    WHEN isFraudAccount = 1 AND isSuspectAccount=1 THEN 'Fraudsters'
  END AS CustomerStatus 
FROM CustomerFraudStatus
    );
  
[0m01:36:01.388007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:b2141e12-3b72-44cd-953a-6aa696960730&page=queryresults
[0m01:36:01.395018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:79c9644f-bf9a-4048-ad10-dffd27a46a21&page=queryresults
[0m01:36:01.997802 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 01:35:57.373853 => 01:36:01.997468
[0m01:36:02.000145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a758b50>]}
[0m01:36:02.002121 [info ] [Thread-3 (]: 8 of 11 OK created sql table model final_project.trx_victim_before_fraud ....... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.65s]
[0m01:36:02.004239 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m01:36:02.005965 [debug] [Thread-3 (]: Began running node model.final_project.victim_status_after_fraud
[0m01:36:02.010924 [info ] [Thread-3 (]: 11 of 11 START sql table model final_project.victim_status_after_fraud ......... [RUN]
[0m01:36:02.013625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_before_fraud, now model.final_project.victim_status_after_fraud)
[0m01:36:02.015205 [debug] [Thread-3 (]: Began compiling node model.final_project.victim_status_after_fraud
[0m01:36:02.020704 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.victim_status_after_fraud"
[0m01:36:02.034531 [debug] [Thread-3 (]: Timing info for model.final_project.victim_status_after_fraud (compile): 01:36:02.016628 => 01:36:02.033933
[0m01:36:02.036117 [debug] [Thread-3 (]: Began executing node model.final_project.victim_status_after_fraud
[0m01:36:02.040956 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.victim_status_after_fraud"
[0m01:36:02.052884 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:36:02.054857 [debug] [Thread-3 (]: On model.final_project.victim_status_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.victim_status_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`victim_status_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentAccounts AS (
    SELECT DISTINCT nameOrigin
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),

RepeatVictimFraud AS (
    SELECT DISTINCT nameOrig
    FROM `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
)

SELECT 
    fa.nameOrigin,
    CASE 
        WHEN rc.nameOrig IS NOT NULL THEN 'Repeat Transaction'
        ELSE 'Inactive Post-Fraud'
    END AS AccountActivityStatus
FROM FraudulentAccounts fa
LEFT JOIN RepeatVictimFraud rc ON fa.nameOrigin = rc.nameOrig
    );
  
[0m01:36:03.062184 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1e10d1e8-7e8a-4a9b-bb67-3938e924942c&page=queryresults
[0m01:36:03.843116 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: nameOrigin; Did you mean nameOrig? at [16:21]')
[0m01:36:05.045151 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1f7cae15-dcdb-44b1-9d15-b63b12c3c452&page=queryresults
[0m01:36:05.873759 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1f7cae15-dcdb-44b1-9d15-b63b12c3c452&page=queryresults
[0m01:36:05.878291 [debug] [Thread-3 (]: Timing info for model.final_project.victim_status_after_fraud (execute): 01:36:02.037346 => 01:36:05.877737
[0m01:36:05.989599 [debug] [Thread-3 (]: Database Error in model victim_status_after_fraud (models/victim_status_after_fraud.sql)
  Unrecognized name: nameOrigin; Did you mean nameOrig? at [16:21]
  compiled Code at target/run/final_project/models/victim_status_after_fraud.sql
[0m01:36:05.992218 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a75b9d0>]}
[0m01:36:05.994462 [error] [Thread-3 (]: 11 of 11 ERROR creating sql table model final_project.victim_status_after_fraud  [[31mERROR[0m in 3.98s]
[0m01:36:05.996415 [debug] [Thread-3 (]: Finished running node model.final_project.victim_status_after_fraud
[0m01:36:11.267698 [debug] [Thread-1 (]: Timing info for model.final_project.customer_status (execute): 01:35:59.845919 => 01:36:11.267440
[0m01:36:11.270176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a6d87f0>]}
[0m01:36:11.271950 [info ] [Thread-1 (]: 10 of 11 OK created sql table model final_project.customer_status .............. [[32mCREATE TABLE (9.1m rows, 200.7 MiB processed)[0m in 11.45s]
[0m01:36:11.273806 [debug] [Thread-1 (]: Finished running node model.final_project.customer_status
[0m01:36:11.636960 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_trx_status (execute): 01:35:59.576820 => 01:36:11.636747
[0m01:36:11.638945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f394014-54a4-4d1a-bd30-9d72a39aeeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a087c70>]}
[0m01:36:11.640743 [info ] [Thread-2 (]: 9 of 11 OK created sql table model final_project.perpet_trx_status ............. [[32mCREATE TABLE (2.7m rows, 75.7 MiB processed)[0m in 12.09s]
[0m01:36:11.643248 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_trx_status
[0m01:36:11.647097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:11.648722 [debug] [MainThread]: Connection 'model.final_project.customer_status' was properly closed.
[0m01:36:11.650127 [debug] [MainThread]: Connection 'model.final_project.perpet_trx_status' was properly closed.
[0m01:36:11.651473 [debug] [MainThread]: Connection 'model.final_project.victim_status_after_fraud' was properly closed.
[0m01:36:11.652930 [info ] [MainThread]: 
[0m01:36:11.654299 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 39.26 seconds (39.26s).
[0m01:36:11.657639 [debug] [MainThread]: Command end result
[0m01:36:11.692262 [info ] [MainThread]: 
[0m01:36:11.694546 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:36:11.696347 [info ] [MainThread]: 
[0m01:36:11.698277 [error] [MainThread]:   Database Error in model victim_status_after_fraud (models/victim_status_after_fraud.sql)
  Unrecognized name: nameOrigin; Did you mean nameOrig? at [16:21]
  compiled Code at target/run/final_project/models/victim_status_after_fraud.sql
[0m01:36:11.699774 [info ] [MainThread]: 
[0m01:36:11.701567 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m01:36:11.703761 [debug] [MainThread]: Command `dbt run` failed at 01:36:11.703548 after 53.63 seconds
[0m01:36:11.705273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc245f6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc23a233d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09f23970>]}
[0m01:36:11.711667 [debug] [MainThread]: Flushing usage events
[0m01:44:58.404424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e32dec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e0c2ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e0c2ea70>]}


============================== 01:44:58.415562 | a1603c06-ba11-401b-9349-4b087dee12db ==============================
[0m01:44:58.415562 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:44:58.417579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:45:07.573529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e0c2eaa0>]}
[0m01:45:07.589045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c9723550>]}
[0m01:45:07.602221 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m01:45:07.635576 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:45:09.830192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:45:09.832122 [debug] [MainThread]: Partial parsing: updated file: final_project://models/schema.yml
[0m01:45:09.833469 [debug] [MainThread]: Partial parsing: updated file: final_project://models/victim_status_after_fraud.sql
[0m01:45:09.834554 [debug] [MainThread]: Partial parsing: updated file: final_project://models/perpet_trx_status.sql
[0m01:45:09.941239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m01:45:09.950747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c93e61a0>]}
[0m01:45:09.995308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c954c5b0>]}
[0m01:45:09.996901 [info ] [MainThread]: Found 11 models, 24 tests, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m01:45:09.998774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c954c610>]}
[0m01:45:10.003675 [info ] [MainThread]: 
[0m01:45:10.006412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:45:10.008980 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m01:45:10.010424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:11.891063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m01:45:11.892940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:12.690997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c9533370>]}
[0m01:45:12.692983 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m01:45:12.694399 [info ] [MainThread]: 
[0m01:45:12.699962 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m01:45:12.700950 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m01:45:12.702603 [info ] [Thread-1 (]: 1 of 11 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m01:45:12.704139 [info ] [Thread-2 (]: 2 of 11 START sql table model final_project.fraud_transaction .................. [RUN]
[0m01:45:12.705918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m01:45:12.707747 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m01:45:12.709305 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m01:45:12.710560 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m01:45:12.725170 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m01:45:12.728326 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m01:45:12.735977 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 01:45:12.711944 => 01:45:12.735343
[0m01:45:12.736954 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 01:45:12.725927 => 01:45:12.736512
[0m01:45:12.738317 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m01:45:12.739808 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m01:45:12.755607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:12.758613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:45:13.758786 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m01:45:13.759569 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m01:45:13.766909 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m01:45:13.767772 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m01:45:14.471043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4baf509c-2af7-4345-b1d1-4a419bb20511&page=queryresults
[0m01:45:14.538448 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:918e3c88-0bf3-4cf3-831f-7826eb5b8a21&page=queryresults
[0m01:45:17.170848 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 01:45:12.756397 => 01:45:17.170644
[0m01:45:17.173361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c93baef0>]}
[0m01:45:17.175158 [info ] [Thread-2 (]: 2 of 11 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.47s]
[0m01:45:17.177376 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m01:45:22.708933 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 01:45:12.740961 => 01:45:22.708670
[0m01:45:22.710791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8b12ef0>]}
[0m01:45:22.712498 [info ] [Thread-1 (]: 1 of 11 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 10.01s]
[0m01:45:22.714161 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m01:45:22.717463 [debug] [Thread-3 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m01:45:22.718495 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m01:45:22.719249 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m01:45:22.720883 [info ] [Thread-3 (]: 3 of 11 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m01:45:22.724087 [info ] [Thread-2 (]: 4 of 11 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m01:45:22.726441 [info ] [Thread-1 (]: 5 of 11 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m01:45:22.729052 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction_ofAll'
[0m01:45:22.731700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.perpet_received_fraud)
[0m01:45:22.734288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_nonfraud)
[0m01:45:22.736464 [debug] [Thread-3 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m01:45:22.737881 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_fraud
[0m01:45:22.739645 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m01:45:22.744107 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m01:45:22.748767 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m01:45:22.753778 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m01:45:22.761678 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 01:45:22.740779 => 01:45:22.760938
[0m01:45:22.762655 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (compile): 01:45:22.745615 => 01:45:22.762214
[0m01:45:22.764512 [debug] [Thread-3 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m01:45:22.765384 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 01:45:22.750274 => 01:45:22.765046
[0m01:45:22.766651 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_fraud
[0m01:45:22.769817 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:45:22.771476 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m01:45:22.774735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:22.782928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:23.777957 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m01:45:23.781352 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m01:45:23.787052 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m01:45:23.789219 [debug] [Thread-3 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime, amount, isFlaggedFraud
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m01:45:23.790423 [debug] [Thread-2 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m01:45:23.799063 [debug] [Thread-1 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m01:45:24.436303 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1ae87c50-2b48-4696-a4cc-c33164009c7d&page=queryresults
[0m01:45:24.459146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2be3e59c-4f8c-4c30-8172-bf0533ca12c7&page=queryresults
[0m01:45:24.517745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:ff787fc3-5772-4498-be59-517a93c144b2&page=queryresults
[0m01:45:27.460528 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (execute): 01:45:22.772696 => 01:45:27.460324
[0m01:45:27.462726 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8998610>]}
[0m01:45:27.464379 [info ] [Thread-2 (]: 4 of 11 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 4.73s]
[0m01:45:27.466346 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m01:45:27.468418 [debug] [Thread-2 (]: Began running node model.final_project.perpet_send_nonfraud
[0m01:45:27.470505 [info ] [Thread-2 (]: 6 of 11 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m01:45:27.472780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.perpet_send_nonfraud)
[0m01:45:27.474320 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m01:45:27.479129 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m01:45:27.490083 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 01:45:27.475377 => 01:45:27.489462
[0m01:45:27.491793 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m01:45:27.496567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:27.901013 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 01:45:22.778128 => 01:45:27.900587
[0m01:45:27.903475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c93fbee0>]}
[0m01:45:27.905207 [info ] [Thread-1 (]: 5 of 11 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 5.17s]
[0m01:45:27.907375 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m01:45:27.909043 [debug] [Thread-1 (]: Began running node model.final_project.trx_victim_after_fraud
[0m01:45:27.911066 [info ] [Thread-1 (]: 7 of 11 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m01:45:27.913432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.trx_victim_after_fraud)
[0m01:45:27.914883 [debug] [Thread-1 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m01:45:27.922435 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m01:45:27.931856 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 01:45:27.916149 => 01:45:27.931254
[0m01:45:27.933740 [debug] [Thread-1 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m01:45:27.937996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:28.258538 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m01:45:28.268438 [debug] [Thread-2 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m01:45:28.716157 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m01:45:28.727302 [debug] [Thread-1 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:45:28.883740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:ee06b3b5-ebfa-44a1-8d60-930a218f7c1b&page=queryresults
[0m01:45:29.396626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:1c5917d0-9e17-4383-918f-2ada0b6775cd&page=queryresults
[0m01:45:29.738549 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 01:45:22.767856 => 01:45:29.738331
[0m01:45:29.740782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c93f81c0>]}
[0m01:45:29.742852 [info ] [Thread-3 (]: 3 of 11 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 364.1 MiB processed)[0m in 7.01s]
[0m01:45:29.744882 [debug] [Thread-3 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m01:45:29.746875 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m01:45:29.749008 [info ] [Thread-3 (]: 8 of 11 START sql table model final_project.trx_victim_before_fraud ............ [RUN]
[0m01:45:29.751077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_before_fraud)
[0m01:45:29.752684 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m01:45:29.757782 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m01:45:29.768353 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 01:45:29.754054 => 01:45:29.767790
[0m01:45:29.770089 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m01:45:29.777745 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:30.571131 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m01:45:30.582407 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:45:31.246686 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:957f1752-2cd1-4865-9871-757901f93b9f&page=queryresults
[0m01:45:32.269726 [debug] [Thread-1 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 01:45:27.935805 => 01:45:32.269442
[0m01:45:32.272149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c89fb9d0>]}
[0m01:45:32.274084 [info ] [Thread-1 (]: 7 of 11 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.36s]
[0m01:45:32.275690 [debug] [Thread-1 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m01:45:32.277044 [debug] [Thread-1 (]: Began running node model.final_project.perpet_trx_status
[0m01:45:32.279188 [info ] [Thread-1 (]: 9 of 11 START sql table model final_project.perpet_trx_status .................. [RUN]
[0m01:45:32.280985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_after_fraud, now model.final_project.perpet_trx_status)
[0m01:45:32.282471 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_trx_status
[0m01:45:32.287812 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_trx_status"
[0m01:45:32.298677 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (compile): 01:45:32.283863 => 01:45:32.298108
[0m01:45:32.300415 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_trx_status
[0m01:45:32.304922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:33.041948 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 01:45:27.492929 => 01:45:33.041689
[0m01:45:33.044295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8b44130>]}
[0m01:45:33.046947 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_trx_status"
[0m01:45:33.047761 [info ] [Thread-2 (]: 6 of 11 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 5.57s]
[0m01:45:33.051216 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m01:45:33.053825 [debug] [Thread-2 (]: Began running node model.final_project.victim_status_after_fraud
[0m01:45:33.055993 [info ] [Thread-2 (]: 10 of 11 START sql table model final_project.victim_status_after_fraud ......... [RUN]
[0m01:45:33.058415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.victim_status_after_fraud)
[0m01:45:33.059428 [debug] [Thread-1 (]: On model.final_project.perpet_trx_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_trx_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_trx_status`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fraud`
),

MultipleTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
)

SELECT 
    f.nameDest,
    CASE 
        WHEN f.nameDest IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveMultipleTrx'
        WHEN f.nameDest NOT IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveOneTrx'
    END AS TransactionCategory
FROM 
    FraudulentTransactions f
    );
  
[0m01:45:33.060780 [debug] [Thread-2 (]: Began compiling node model.final_project.victim_status_after_fraud
[0m01:45:33.068421 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.victim_status_after_fraud"
[0m01:45:33.079387 [debug] [Thread-2 (]: Timing info for model.final_project.victim_status_after_fraud (compile): 01:45:33.064054 => 01:45:33.078811
[0m01:45:33.081039 [debug] [Thread-2 (]: Began executing node model.final_project.victim_status_after_fraud
[0m01:45:33.086935 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.victim_status_after_fraud"
[0m01:45:33.096944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:45:33.098586 [debug] [Thread-2 (]: On model.final_project.victim_status_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.victim_status_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`victim_status_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentAccounts AS (
    SELECT DISTINCT nameOrig
    FROM `eternal-channel-400514`.`final_project`.`fraud`
),

RepeatVictimFraud AS (
    SELECT DISTINCT nameOrig
    FROM `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
)

SELECT 
    fa.nameOrig,
    CASE 
        WHEN rc.nameOrig IS NOT NULL THEN 'Repeat Transaction'
        ELSE 'Inactive Post-Fraud'
    END AS AccountActivityStatus
FROM FraudulentAccounts fa
LEFT JOIN RepeatVictimFraud rc ON fa.nameOrig = rc.nameOrig
    );
  
[0m01:45:33.712761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:d1d252c2-3fdf-4d0d-a654-67f339b9a93c&page=queryresults
[0m01:45:33.848395 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 01:45:29.771178 => 01:45:33.848077
[0m01:45:33.850777 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8a01d80>]}
[0m01:45:33.854291 [info ] [Thread-3 (]: 8 of 11 OK created sql table model final_project.trx_victim_before_fraud ....... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.10s]
[0m01:45:33.856799 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m01:45:33.858622 [debug] [Thread-3 (]: Began running node model.final_project.customer_status
[0m01:45:33.860686 [info ] [Thread-3 (]: 11 of 11 START sql table model final_project.customer_status ................... [RUN]
[0m01:45:33.863257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_before_fraud, now model.final_project.customer_status)
[0m01:45:33.864989 [debug] [Thread-3 (]: Began compiling node model.final_project.customer_status
[0m01:45:33.871570 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.customer_status"
[0m01:45:33.880975 [debug] [Thread-3 (]: Timing info for model.final_project.customer_status (compile): 01:45:33.866297 => 01:45:33.880322
[0m01:45:33.883021 [debug] [Thread-3 (]: Began executing node model.final_project.customer_status
[0m01:45:33.890053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:45:34.107883 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:51a54946-6ab2-4b28-8a1a-e89bd0f5b11c&page=queryresults
[0m01:45:34.627042 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.customer_status"
[0m01:45:34.638079 [debug] [Thread-3 (]: On model.final_project.customer_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.customer_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`customer_status`
      
    
    

    OPTIONS()
    as (
      

WITH UniqueCustomers AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),
FraudulentActivity AS (
    SELECT DISTINCT nameDest AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
SuspectActivity AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
),
CustomerFraudStatus AS (
    SELECT 
        uc.CustomerID,
        CASE WHEN fa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isFraudAccount,
        CASE WHEN sa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isSuspectAccount
    FROM 
        UniqueCustomers uc
    LEFT JOIN 
        FraudulentActivity fa ON uc.CustomerID = fa.CustomerID
    LEFT JOIN 
        SuspectActivity sa ON uc.CustomerID = sa.CustomerID
)

SELECT *,
  CASE 
    WHEN isFraudAccount = 1 AND isSuspectAccount=0 THEN 'Fraudsters'
    WHEN isFraudAccount = 0 AND isSuspectAccount=1 THEN 'FraudSuspects'
    WHEN isFraudAccount = 0 AND isSuspectAccount = 0 THEN 'NotAffiliated'
    WHEN isFraudAccount = 1 AND isSuspectAccount=1 THEN 'Fraudsters'
  END AS CustomerStatus 
FROM CustomerFraudStatus
    );
  
[0m01:45:34.881406 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: nameOrig; Did you mean nameOrigin? at [16:21]')
[0m01:45:35.271039 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:b544f5b0-1011-482a-8bca-e19f183ecf69&page=queryresults
[0m01:45:36.083660 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:caf0799f-d2d3-4721-8c47-94c097716b20&page=queryresults
[0m01:45:36.585118 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (execute): 01:45:32.301986 => 01:45:36.584654
[0m01:45:36.589054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8b44580>]}
[0m01:45:36.592013 [info ] [Thread-1 (]: 9 of 11 OK created sql table model final_project.perpet_trx_status ............. [[32mCREATE TABLE (8.2k rows, 101.1 KiB processed)[0m in 4.31s]
[0m01:45:36.594756 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_trx_status
[0m01:45:36.901186 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:caf0799f-d2d3-4721-8c47-94c097716b20&page=queryresults
[0m01:45:36.905698 [debug] [Thread-2 (]: Timing info for model.final_project.victim_status_after_fraud (execute): 01:45:33.082231 => 01:45:36.905002
[0m01:45:36.962044 [debug] [Thread-2 (]: Database Error in model victim_status_after_fraud (models/victim_status_after_fraud.sql)
  Unrecognized name: nameOrig; Did you mean nameOrigin? at [16:21]
  compiled Code at target/run/final_project/models/victim_status_after_fraud.sql
[0m01:45:36.963342 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8a3ff40>]}
[0m01:45:36.964621 [error] [Thread-2 (]: 10 of 11 ERROR creating sql table model final_project.victim_status_after_fraud  [[31mERROR[0m in 3.91s]
[0m01:45:36.966587 [debug] [Thread-2 (]: Finished running node model.final_project.victim_status_after_fraud
[0m01:45:45.930124 [debug] [Thread-3 (]: Timing info for model.final_project.customer_status (execute): 01:45:33.885172 => 01:45:45.929768
[0m01:45:45.932630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1603c06-ba11-401b-9349-4b087dee12db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8b46a70>]}
[0m01:45:45.934588 [info ] [Thread-3 (]: 11 of 11 OK created sql table model final_project.customer_status .............. [[32mCREATE TABLE (9.1m rows, 200.7 MiB processed)[0m in 12.07s]
[0m01:45:45.937902 [debug] [Thread-3 (]: Finished running node model.final_project.customer_status
[0m01:45:45.942028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:45.943578 [debug] [MainThread]: Connection 'model.final_project.perpet_trx_status' was properly closed.
[0m01:45:45.945223 [debug] [MainThread]: Connection 'model.final_project.victim_status_after_fraud' was properly closed.
[0m01:45:45.946677 [debug] [MainThread]: Connection 'model.final_project.customer_status' was properly closed.
[0m01:45:45.948189 [info ] [MainThread]: 
[0m01:45:45.949741 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 35.94 seconds (35.94s).
[0m01:45:45.957200 [debug] [MainThread]: Command end result
[0m01:45:45.991152 [info ] [MainThread]: 
[0m01:45:45.993306 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:45:45.995112 [info ] [MainThread]: 
[0m01:45:45.997036 [error] [MainThread]:   Database Error in model victim_status_after_fraud (models/victim_status_after_fraud.sql)
  Unrecognized name: nameOrig; Did you mean nameOrigin? at [16:21]
  compiled Code at target/run/final_project/models/victim_status_after_fraud.sql
[0m01:45:45.998863 [info ] [MainThread]: 
[0m01:45:46.000245 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m01:45:46.003648 [debug] [MainThread]: Command `dbt run` failed at 01:45:46.003310 after 47.62 seconds
[0m01:45:46.005462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e32dec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c9723550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6c8a3fca0>]}
[0m01:45:46.007445 [debug] [MainThread]: Flushing usage events
[0m01:47:45.041453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91baef2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b893eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b893ea40>]}


============================== 01:47:45.051622 | 63e9e96e-0cc7-4737-a6e9-36722fc452db ==============================
[0m01:47:45.051622 [info ] [MainThread]: Running with dbt=1.6.6
[0m01:47:45.055337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/e/Dataflow_example-main/final_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/e/Dataflow_example-main/final_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:47:58.074185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b893ea70>]}
[0m01:47:58.116718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a13a3520>]}
[0m01:47:58.139376 [info ] [MainThread]: Registered adapter: bigquery=1.6.7
[0m01:47:58.231290 [debug] [MainThread]: checksum: 546b81fb56652c304d87abd676e84d4737d8a0c6b62160f4a6e79dcddbc842bb, vars: {}, profile: , target: , version: 1.6.6
[0m01:48:02.152131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:02.155117 [debug] [MainThread]: Partial parsing: updated file: final_project://models/victim_status_after_fraud.sql
[0m01:48:02.271224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.final_project.example
[0m01:48:02.280171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a107a4a0>]}
[0m01:48:02.319520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0fbfdc0>]}
[0m01:48:02.321388 [info ] [MainThread]: Found 11 models, 24 tests, 2 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m01:48:02.324574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0fbfe20>]}
[0m01:48:02.328914 [info ] [MainThread]: 
[0m01:48:02.330982 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:48:02.334345 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_eternal-channel-400514'
[0m01:48:02.335493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:06.296541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_eternal-channel-400514, now list_eternal-channel-400514_final_project)
[0m01:48:06.298071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:48:07.028384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0fbeda0>]}
[0m01:48:07.030990 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m01:48:07.032949 [info ] [MainThread]: 
[0m01:48:07.039260 [debug] [Thread-1 (]: Began running node model.final_project.fill_transactionValid
[0m01:48:07.040190 [debug] [Thread-2 (]: Began running node model.final_project.fraud_transaction
[0m01:48:07.041812 [info ] [Thread-1 (]: 1 of 11 START sql table model final_project.fill_transactionValid .............. [RUN]
[0m01:48:07.043616 [info ] [Thread-2 (]: 2 of 11 START sql table model final_project.fraud_transaction .................. [RUN]
[0m01:48:07.045725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_eternal-channel-400514_final_project, now model.final_project.fill_transactionValid)
[0m01:48:07.048021 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction'
[0m01:48:07.049583 [debug] [Thread-1 (]: Began compiling node model.final_project.fill_transactionValid
[0m01:48:07.051435 [debug] [Thread-2 (]: Began compiling node model.final_project.fraud_transaction
[0m01:48:07.074780 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.fill_transactionValid"
[0m01:48:07.082108 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.fraud_transaction"
[0m01:48:07.096918 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (compile): 01:48:07.076136 => 01:48:07.096204
[0m01:48:07.099450 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (compile): 01:48:07.053416 => 01:48:07.098155
[0m01:48:07.102638 [debug] [Thread-2 (]: Began executing node model.final_project.fraud_transaction
[0m01:48:07.118944 [debug] [Thread-1 (]: Began executing node model.final_project.fill_transactionValid
[0m01:48:07.163897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:07.165082 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:48:08.289364 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.fill_transactionValid"
[0m01:48:08.304628 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.fraud_transaction"
[0m01:48:08.346112 [debug] [Thread-1 (]: On model.final_project.fill_transactionValid: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fill_transactionValid"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fill_transactionValid`
      
    
    

    OPTIONS()
    as (
      

WITH base_data AS (
    SELECT *,
           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND
               

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               WHEN type = 'CASH_IN' AND
               

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))

 THEN 'True'
               ELSE 'False'

           END AS isValid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg - amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceOrg + amount, 1)
               ELSE newbalanceOrig

           END AS newbalanceOrig_valid,

           CASE
               WHEN type IN ('PAYMENT', 'TRANSFER', 'CASH_OUT', 'DEBIT') AND 

(ABS(oldbalanceOrg - amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg - amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest + amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest + amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest + amount, 1)
               WHEN type = 'CASH_IN' AND 

(ABS(oldbalanceOrg + amount - newbalanceOrig) <= 0.01 OR
ROUND(oldbalanceOrg + amount, 1) = ROUND(newbalanceOrig, 1)) AND
(ABS(oldbalanceDest - amount - newbalanceDest) <= 0.01 OR
ROUND(oldbalanceDest - amount, 1) = ROUND(newbalanceDest, 1))


               THEN ROUND(oldbalanceDest - amount, 1)            
               ELSE newbalanceDest

           END AS newbalanceDest_valid

    FROM `eternal-channel-400514`.`final_project`.`all_data`
)

SELECT *
FROM base_data
    );
  
[0m01:48:08.376401 [debug] [Thread-2 (]: On model.final_project.fraud_transaction: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction`
      
    
    

    OPTIONS()
    as (
      

SELECT idTransaction, isFraud, isTrueFraud, refund, confirm, newBalanceOriginSet, oldBalanceOrigin, timestamp, amount
FROM `eternal-channel-400514`.`final_project`.`fraud`
WHERE isFraud=1 AND isTrueFraud=1
    );
  
[0m01:48:09.057842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:dbc3d3de-4dd4-4bb4-a935-628e2e84d031&page=queryresults
[0m01:48:09.096060 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:2ef28e4a-ff19-4ea3-a123-3c7949d6505c&page=queryresults
[0m01:48:11.432087 [debug] [Thread-2 (]: Timing info for model.final_project.fraud_transaction (execute): 01:48:07.121939 => 01:48:11.431883
[0m01:48:11.434299 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a07a6bc0>]}
[0m01:48:11.436045 [info ] [Thread-2 (]: 2 of 11 OK created sql table model final_project.fraud_transaction ............. [[32mCREATE TABLE (8.2k rows, 737.9 KiB processed)[0m in 4.39s]
[0m01:48:11.440024 [debug] [Thread-2 (]: Finished running node model.final_project.fraud_transaction
[0m01:48:17.283091 [debug] [Thread-1 (]: Timing info for model.final_project.fill_transactionValid (execute): 01:48:07.160585 => 01:48:17.282632
[0m01:48:17.285598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a07a7af0>]}
[0m01:48:17.290117 [info ] [Thread-1 (]: 1 of 11 OK created sql table model final_project.fill_transactionValid ......... [[32mCREATE TABLE (6.4m rows, 815.4 MiB processed)[0m in 10.24s]
[0m01:48:17.293717 [debug] [Thread-1 (]: Finished running node model.final_project.fill_transactionValid
[0m01:48:17.297371 [debug] [Thread-3 (]: Began running node model.final_project.fraud_transaction_ofAll
[0m01:48:17.298217 [debug] [Thread-2 (]: Began running node model.final_project.perpet_received_fraud
[0m01:48:17.298738 [debug] [Thread-1 (]: Began running node model.final_project.perpet_received_nonfraud
[0m01:48:17.299976 [info ] [Thread-3 (]: 3 of 11 START sql table model final_project.fraud_transaction_ofAll ............ [RUN]
[0m01:48:17.301706 [info ] [Thread-2 (]: 4 of 11 START sql table model final_project.perpet_received_fraud .............. [RUN]
[0m01:48:17.309083 [info ] [Thread-1 (]: 5 of 11 START sql table model final_project.perpet_received_nonfraud ........... [RUN]
[0m01:48:17.312172 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.final_project.fraud_transaction_ofAll'
[0m01:48:17.314818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction, now model.final_project.perpet_received_fraud)
[0m01:48:17.316270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.fill_transactionValid, now model.final_project.perpet_received_nonfraud)
[0m01:48:17.317315 [debug] [Thread-3 (]: Began compiling node model.final_project.fraud_transaction_ofAll
[0m01:48:17.318257 [debug] [Thread-2 (]: Began compiling node model.final_project.perpet_received_fraud
[0m01:48:17.321183 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_received_nonfraud
[0m01:48:17.328529 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.fraud_transaction_ofAll"
[0m01:48:17.332469 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.perpet_received_fraud"
[0m01:48:17.338015 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_received_nonfraud"
[0m01:48:17.350422 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (compile): 01:48:17.329676 => 01:48:17.349940
[0m01:48:17.351781 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (compile): 01:48:17.325307 => 01:48:17.351286
[0m01:48:17.353412 [debug] [Thread-2 (]: Began executing node model.final_project.perpet_received_fraud
[0m01:48:17.357096 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (compile): 01:48:17.333608 => 01:48:17.356226
[0m01:48:17.358235 [debug] [Thread-3 (]: Began executing node model.final_project.fraud_transaction_ofAll
[0m01:48:17.361708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:48:17.363016 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_received_nonfraud
[0m01:48:17.368018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:48:17.376648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:18.455941 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_received_nonfraud"
[0m01:48:18.466281 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.perpet_received_fraud"
[0m01:48:18.468424 [debug] [Thread-1 (]: On model.final_project.perpet_received_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id,
    COUNT(*) AS NonFraudulentTransactionCount
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` nft
INNER JOIN 
    FraudulentTransactions ft ON nft.nameDest = ft.nameDest
WHERE 
    nft.isFraud = 0 
GROUP BY 
    nft.nameOrig,
    nft.nameDest,
    nft.payment_datetime,
    nft.payment_id
ORDER BY
    nft.nameOrig,
    nft.payment_datetime
    );
  
[0m01:48:18.479297 [debug] [Thread-2 (]: On model.final_project.perpet_received_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_received_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
      
    
    

    OPTIONS()
    as (
      

SELECT DISTINCT payment_id, nameDest, payment_datetime, isFraud
FROM 
  ( SELECT *, 
           count(1) OVER (PARTITION BY nameDest) AS occurs
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud=1
  ) AS t 
WHERE occurs > 1
ORDER BY nameDest, payment_datetime
    );
  
[0m01:48:18.483846 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.fraud_transaction_ofAll"
[0m01:48:18.498246 [debug] [Thread-3 (]: On model.final_project.fraud_transaction_ofAll: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.fraud_transaction_ofAll"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`fraud_transaction_ofAll`
      
    
    

    OPTIONS()
    as (
      

SELECT payment_id, isFraud, payment_datetime, amount, isFlaggedFraud
FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    );
  
[0m01:48:19.083113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:5cb6536d-5fc5-4fac-9a4c-0c5dd221ff04&page=queryresults
[0m01:48:19.092605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:89309433-9771-4da5-a954-0cedf00a64ad&page=queryresults
[0m01:48:19.164720 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:51797623-7575-4ccf-b138-f1389be2fc56&page=queryresults
[0m01:48:22.346772 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_received_nonfraud (execute): 01:48:17.371722 => 01:48:22.346557
[0m01:48:22.349282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a064a6e0>]}
[0m01:48:22.351121 [info ] [Thread-1 (]: 5 of 11 OK created sql table model final_project.perpet_received_nonfraud ...... [[32mCREATE TABLE (57.4k rows, 418.5 MiB processed)[0m in 5.03s]
[0m01:48:22.353235 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_received_nonfraud
[0m01:48:22.358594 [debug] [Thread-1 (]: Began running node model.final_project.perpet_send_nonfraud
[0m01:48:22.360183 [info ] [Thread-1 (]: 6 of 11 START sql table model final_project.perpet_send_nonfraud ............... [RUN]
[0m01:48:22.362367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_nonfraud, now model.final_project.perpet_send_nonfraud)
[0m01:48:22.364048 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_send_nonfraud
[0m01:48:22.370533 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_send_nonfraud"
[0m01:48:22.383721 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_send_nonfraud (compile): 01:48:22.365340 => 01:48:22.382965
[0m01:48:22.385732 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_send_nonfraud
[0m01:48:22.395822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:23.424077 [debug] [Thread-2 (]: Timing info for model.final_project.perpet_received_fraud (execute): 01:48:17.359507 => 01:48:23.423661
[0m01:48:23.426136 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a061d420>]}
[0m01:48:23.427970 [info ] [Thread-2 (]: 4 of 11 OK created sql table model final_project.perpet_received_fraud ......... [[32mCREATE TABLE (88.0 rows, 342.7 MiB processed)[0m in 6.11s]
[0m01:48:23.430247 [debug] [Thread-2 (]: Finished running node model.final_project.perpet_received_fraud
[0m01:48:23.431919 [debug] [Thread-2 (]: Began running node model.final_project.trx_victim_after_fraud
[0m01:48:23.434905 [info ] [Thread-2 (]: 7 of 11 START sql table model final_project.trx_victim_after_fraud ............. [RUN]
[0m01:48:23.440584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_received_fraud, now model.final_project.trx_victim_after_fraud)
[0m01:48:23.442119 [debug] [Thread-2 (]: Began compiling node model.final_project.trx_victim_after_fraud
[0m01:48:23.448240 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.trx_victim_after_fraud"
[0m01:48:23.461762 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_after_fraud (compile): 01:48:23.443229 => 01:48:23.461112
[0m01:48:23.463135 [debug] [Thread-2 (]: Began executing node model.final_project.trx_victim_after_fraud
[0m01:48:23.468110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:48:23.615309 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_send_nonfraud"
[0m01:48:23.630352 [debug] [Thread-1 (]: On model.final_project.perpet_send_nonfraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_send_nonfraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentSenders AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
)

SELECT 
    a.payment_id, 
    a.payment_datetime, 
    a.nameOrig, 
    a.nameDest
FROM 
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` a
JOIN 
    FraudulentSenders fs ON a.nameOrig = fs.nameDest
WHERE 
    a.isFraud = 0
    );
  
[0m01:48:24.114651 [debug] [Thread-3 (]: Timing info for model.final_project.fraud_transaction_ofAll (execute): 01:48:17.365888 => 01:48:24.114305
[0m01:48:24.116517 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0ff6650>]}
[0m01:48:24.118004 [info ] [Thread-3 (]: 3 of 11 OK created sql table model final_project.fraud_transaction_ofAll ....... [[32mCREATE TABLE (6.4m rows, 364.1 MiB processed)[0m in 6.81s]
[0m01:48:24.119815 [debug] [Thread-3 (]: Finished running node model.final_project.fraud_transaction_ofAll
[0m01:48:24.124473 [debug] [Thread-3 (]: Began running node model.final_project.trx_victim_before_fraud
[0m01:48:24.126181 [info ] [Thread-3 (]: 8 of 11 START sql table model final_project.trx_victim_before_fraud ............ [RUN]
[0m01:48:24.128334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.fraud_transaction_ofAll, now model.final_project.trx_victim_before_fraud)
[0m01:48:24.129757 [debug] [Thread-3 (]: Began compiling node model.final_project.trx_victim_before_fraud
[0m01:48:24.135523 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.trx_victim_before_fraud"
[0m01:48:24.147936 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (compile): 01:48:24.130801 => 01:48:24.147368
[0m01:48:24.149372 [debug] [Thread-3 (]: Began executing node model.final_project.trx_victim_before_fraud
[0m01:48:24.152957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:48:24.271142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:ef35e8dd-d7e8-4c59-b2d2-fe87ee4200ff&page=queryresults
[0m01:48:24.331827 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.trx_victim_after_fraud"
[0m01:48:24.342753 [debug] [Thread-2 (]: On model.final_project.trx_victim_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime > f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:48:24.946766 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.trx_victim_before_fraud"
[0m01:48:24.958980 [debug] [Thread-3 (]: On model.final_project.trx_victim_before_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.trx_victim_before_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`trx_victim_before_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FirstFraudInstance AS (
    SELECT
        nameOrig,
        MIN(payment_datetime) AS FirstFraudDate
    FROM
        `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE
        isFraud = 1
    GROUP BY
        nameOrig
)

SELECT
    t.nameOrig,
    t.payment_datetime,
    t.isFraud
FROM
    `eternal-channel-400514`.`final_project`.`fill_transactionValid` t
INNER JOIN
    FirstFraudInstance f ON t.nameOrig = f.nameOrig
WHERE
    t.payment_datetime < f.FirstFraudDate
ORDER BY
    t.nameOrig,
    t.payment_datetime
    );
  
[0m01:48:25.006430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4765344c-5cb9-4010-9b3c-fd8cc55b6efb&page=queryresults
[0m01:48:25.624639 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:49e2b7bf-d545-4937-a193-15c5b1d51967&page=queryresults
[0m01:48:27.526958 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_send_nonfraud (execute): 01:48:22.389158 => 01:48:27.526756
[0m01:48:27.529279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a04c6560>]}
[0m01:48:27.531040 [info ] [Thread-1 (]: 6 of 11 OK created sql table model final_project.perpet_send_nonfraud .......... [[32mCREATE TABLE (18.0 rows, 418.5 MiB processed)[0m in 5.17s]
[0m01:48:27.532867 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_send_nonfraud
[0m01:48:27.534613 [debug] [Thread-1 (]: Began running node model.final_project.perpet_trx_status
[0m01:48:27.537074 [info ] [Thread-1 (]: 9 of 11 START sql table model final_project.perpet_trx_status .................. [RUN]
[0m01:48:27.538939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.final_project.perpet_send_nonfraud, now model.final_project.perpet_trx_status)
[0m01:48:27.540202 [debug] [Thread-1 (]: Began compiling node model.final_project.perpet_trx_status
[0m01:48:27.546024 [debug] [Thread-1 (]: Writing injected SQL for node "model.final_project.perpet_trx_status"
[0m01:48:27.555118 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (compile): 01:48:27.541186 => 01:48:27.554388
[0m01:48:27.556727 [debug] [Thread-1 (]: Began executing node model.final_project.perpet_trx_status
[0m01:48:27.559969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:27.938877 [debug] [Thread-2 (]: Timing info for model.final_project.trx_victim_after_fraud (execute): 01:48:23.464727 => 01:48:27.938400
[0m01:48:27.942531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a068be80>]}
[0m01:48:27.946205 [info ] [Thread-2 (]: 7 of 11 OK created sql table model final_project.trx_victim_after_fraud ........ [[32mCREATE TABLE (10.0 rows, 172.8 MiB processed)[0m in 4.50s]
[0m01:48:27.949757 [debug] [Thread-2 (]: Finished running node model.final_project.trx_victim_after_fraud
[0m01:48:27.953120 [debug] [Thread-2 (]: Began running node model.final_project.customer_status
[0m01:48:27.955973 [info ] [Thread-2 (]: 10 of 11 START sql table model final_project.customer_status ................... [RUN]
[0m01:48:27.958401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_after_fraud, now model.final_project.customer_status)
[0m01:48:27.960295 [debug] [Thread-2 (]: Began compiling node model.final_project.customer_status
[0m01:48:27.965948 [debug] [Thread-2 (]: Writing injected SQL for node "model.final_project.customer_status"
[0m01:48:27.976167 [debug] [Thread-2 (]: Timing info for model.final_project.customer_status (compile): 01:48:27.961850 => 01:48:27.975511
[0m01:48:27.977675 [debug] [Thread-2 (]: Began executing node model.final_project.customer_status
[0m01:48:27.982248 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:48:28.369193 [debug] [Thread-1 (]: Writing runtime sql for node "model.final_project.perpet_trx_status"
[0m01:48:28.381611 [debug] [Thread-1 (]: On model.final_project.perpet_trx_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.perpet_trx_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`perpet_trx_status`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fraud`
),

MultipleTransactions AS (
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_fraud`
)

SELECT 
    f.nameDest,
    CASE 
        WHEN f.nameDest IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveMultipleTrx'
        WHEN f.nameDest NOT IN (SELECT nameDest FROM MultipleTransactions) THEN 'ReceiveOneTrx'
    END AS TransactionCategory
FROM 
    FraudulentTransactions f
    );
  
[0m01:48:28.529382 [debug] [Thread-3 (]: Timing info for model.final_project.trx_victim_before_fraud (execute): 01:48:24.150399 => 01:48:28.529063
[0m01:48:28.532088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a06028c0>]}
[0m01:48:28.534097 [info ] [Thread-3 (]: 8 of 11 OK created sql table model final_project.trx_victim_before_fraud ....... [[32mCREATE TABLE (18.0 rows, 172.8 MiB processed)[0m in 4.40s]
[0m01:48:28.536215 [debug] [Thread-3 (]: Finished running node model.final_project.trx_victim_before_fraud
[0m01:48:28.538234 [debug] [Thread-3 (]: Began running node model.final_project.victim_status_after_fraud
[0m01:48:28.540133 [info ] [Thread-3 (]: 11 of 11 START sql table model final_project.victim_status_after_fraud ......... [RUN]
[0m01:48:28.542146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.final_project.trx_victim_before_fraud, now model.final_project.victim_status_after_fraud)
[0m01:48:28.543691 [debug] [Thread-3 (]: Began compiling node model.final_project.victim_status_after_fraud
[0m01:48:28.547873 [debug] [Thread-3 (]: Writing injected SQL for node "model.final_project.victim_status_after_fraud"
[0m01:48:28.557934 [debug] [Thread-3 (]: Timing info for model.final_project.victim_status_after_fraud (compile): 01:48:28.544960 => 01:48:28.557306
[0m01:48:28.559468 [debug] [Thread-3 (]: Began executing node model.final_project.victim_status_after_fraud
[0m01:48:28.565405 [debug] [Thread-3 (]: Writing runtime sql for node "model.final_project.victim_status_after_fraud"
[0m01:48:28.575500 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:48:28.577311 [debug] [Thread-3 (]: On model.final_project.victim_status_after_fraud: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.victim_status_after_fraud"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`victim_status_after_fraud`
      
    
    

    OPTIONS()
    as (
      

WITH FraudulentAccounts AS (
    SELECT DISTINCT nameOrigin
    FROM `eternal-channel-400514`.`final_project`.`fraud`
),

RepeatVictimFraud AS (
    SELECT DISTINCT nameOrig
    FROM `eternal-channel-400514`.`final_project`.`trx_victim_after_fraud`
)

SELECT 
    fa.nameOrigin,
    CASE 
        WHEN rc.nameOrig IS NOT NULL THEN 'Repeat Transaction'
        ELSE 'Inactive Post-Fraud'
    END AS AccountActivityStatus
FROM FraudulentAccounts fa
LEFT JOIN RepeatVictimFraud rc ON fa.nameOrigin = rc.nameOrig
    );
  
[0m01:48:28.770260 [debug] [Thread-2 (]: Writing runtime sql for node "model.final_project.customer_status"
[0m01:48:28.791616 [debug] [Thread-2 (]: On model.final_project.customer_status: /* {"app": "dbt", "dbt_version": "1.6.6", "profile_name": "final_project", "target_name": "dev", "node_id": "model.final_project.customer_status"} */

  
    

    create or replace table `eternal-channel-400514`.`final_project`.`customer_status`
      
    
    

    OPTIONS()
    as (
      

WITH UniqueCustomers AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
),
FraudulentActivity AS (
    SELECT DISTINCT nameDest AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`fill_transactionValid`
    WHERE isFraud = 1
),
SuspectActivity AS (
    SELECT DISTINCT nameOrig AS CustomerID
    FROM `eternal-channel-400514`.`final_project`.`perpet_received_nonfraud`
    UNION DISTINCT
    SELECT DISTINCT nameDest
    FROM `eternal-channel-400514`.`final_project`.`perpet_send_nonfraud`
),
CustomerFraudStatus AS (
    SELECT 
        uc.CustomerID,
        CASE WHEN fa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isFraudAccount,
        CASE WHEN sa.CustomerID IS NOT NULL THEN 1 ELSE 0 END AS isSuspectAccount
    FROM 
        UniqueCustomers uc
    LEFT JOIN 
        FraudulentActivity fa ON uc.CustomerID = fa.CustomerID
    LEFT JOIN 
        SuspectActivity sa ON uc.CustomerID = sa.CustomerID
)

SELECT *,
  CASE 
    WHEN isFraudAccount = 1 AND isSuspectAccount=0 THEN 'Fraudsters'
    WHEN isFraudAccount = 0 AND isSuspectAccount=1 THEN 'FraudSuspects'
    WHEN isFraudAccount = 0 AND isSuspectAccount = 0 THEN 'NotAffiliated'
    WHEN isFraudAccount = 1 AND isSuspectAccount=1 THEN 'Fraudsters'
  END AS CustomerStatus 
FROM CustomerFraudStatus
    );
  
[0m01:48:29.070018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:4cc6ed71-6976-453e-b15d-8ccdca65f50b&page=queryresults
[0m01:48:29.454282 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:969b697b-67ab-4fa7-933e-f82ab3ce0993&page=queryresults
[0m01:48:29.609531 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=eternal-channel-400514&j=bq:US:96ce97f2-5b04-455f-ae00-a8087e5575ba&page=queryresults
[0m01:48:31.934031 [debug] [Thread-1 (]: Timing info for model.final_project.perpet_trx_status (execute): 01:48:27.557847 => 01:48:31.933478
[0m01:48:31.937273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0fbd990>]}
[0m01:48:31.939536 [info ] [Thread-1 (]: 9 of 11 OK created sql table model final_project.perpet_trx_status ............. [[32mCREATE TABLE (8.2k rows, 101.1 KiB processed)[0m in 4.40s]
[0m01:48:31.941635 [debug] [Thread-1 (]: Finished running node model.final_project.perpet_trx_status
[0m01:48:32.436760 [debug] [Thread-3 (]: Timing info for model.final_project.victim_status_after_fraud (execute): 01:48:28.560680 => 01:48:32.436472
[0m01:48:32.439033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0ff4a90>]}
[0m01:48:32.440796 [info ] [Thread-3 (]: 11 of 11 OK created sql table model final_project.victim_status_after_fraud .... [[32mCREATE TABLE (8.2k rows, 100.3 KiB processed)[0m in 3.90s]
[0m01:48:32.442385 [debug] [Thread-3 (]: Finished running node model.final_project.victim_status_after_fraud
[0m01:48:41.135667 [debug] [Thread-2 (]: Timing info for model.final_project.customer_status (execute): 01:48:27.978674 => 01:48:41.135457
[0m01:48:41.140238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63e9e96e-0cc7-4737-a6e9-36722fc452db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a0690700>]}
[0m01:48:41.142100 [info ] [Thread-2 (]: 10 of 11 OK created sql table model final_project.customer_status .............. [[32mCREATE TABLE (9.1m rows, 200.7 MiB processed)[0m in 13.18s]
[0m01:48:41.144079 [debug] [Thread-2 (]: Finished running node model.final_project.customer_status
[0m01:48:41.148159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:41.149826 [debug] [MainThread]: Connection 'model.final_project.perpet_trx_status' was properly closed.
[0m01:48:41.151054 [debug] [MainThread]: Connection 'model.final_project.customer_status' was properly closed.
[0m01:48:41.152413 [debug] [MainThread]: Connection 'model.final_project.victim_status_after_fraud' was properly closed.
[0m01:48:41.157407 [info ] [MainThread]: 
[0m01:48:41.159064 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 38.83 seconds (38.83s).
[0m01:48:41.162382 [debug] [MainThread]: Command end result
[0m01:48:41.206801 [info ] [MainThread]: 
[0m01:48:41.208958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:48:41.210979 [info ] [MainThread]: 
[0m01:48:41.213043 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m01:48:41.215727 [debug] [MainThread]: Command `dbt run` succeeded at 01:48:41.215445 after 56.20 seconds
[0m01:48:41.217227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91baef2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a1005db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a13a3520>]}
[0m01:48:41.218528 [debug] [MainThread]: Flushing usage events
